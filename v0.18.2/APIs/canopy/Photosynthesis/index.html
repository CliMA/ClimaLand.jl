<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Canopy Photosynthesis · ClimaLand.jl</title><meta name="title" content="Canopy Photosynthesis · ClimaLand.jl"/><meta property="og:title" content="Canopy Photosynthesis · ClimaLand.jl"/><meta property="twitter:title" content="Canopy Photosynthesis · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Running your first simulation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-2" type="checkbox"/><label class="tocitem" for="menuitem-4-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-3" type="checkbox"/><label class="tocitem" for="menuitem-4-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/plant_hydraulics/van_genuchten_model/">Van Genuchten model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_structure/">Model structure</a></li><li><a class="tocitem" href="../../../repo_structure/">Repository structure</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Analyzing model output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-3-1" type="checkbox"/><label class="tocitem" for="menuitem-5-3-1"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><a class="tocitem" href="../../../leaderboard/leaderboard/">Leaderboard</a></li></ul></li><li><a class="tocitem" href="../../../architectures/">Running on GPU or with MPI</a></li><li><a class="tocitem" href="../../../calibration/">Calibration</a></li><li><a class="tocitem" href="../../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../itime/">ITime type</a></li><li><a class="tocitem" href="../../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../../physical_units/">Physical units</a></li><li><a class="tocitem" href="../../../julia/">Julia background</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../../SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../PlantHydraulics/">Plant Hydraulics</a></li><li class="is-active"><a class="tocitem" href>Canopy Photosynthesis</a><ul class="internal"><li><a class="tocitem" href="#Models-and-Parameters"><span>Models and Parameters</span></a></li><li><a class="tocitem" href="#FarquharModel-Methods"><span>FarquharModel Methods</span></a></li><li><a class="tocitem" href="#PModel-Methods"><span>PModel Methods</span></a></li></ul></li><li><a class="tocitem" href="../RadiativeTransfer/">Canopy Radiative Transfer</a></li><li><a class="tocitem" href="../CanopyEnergy/">Canopy Energy</a></li><li><a class="tocitem" href="../StomatalConductance/">Canopy Stomatal Conductance</a></li><li><a class="tocitem" href="../AutotrophicRespiration/">Canopy Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../Snow/">Snow Model</a></li><li><a class="tocitem" href="../../ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Simulations/">Simulations</a></li><li><a class="tocitem" href="../../shared_utilities/">Shared Utilities</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributor guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">APIs</a></li><li><a class="is-disabled">Canopy</a></li><li class="is-active"><a href>Canopy Photosynthesis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Canopy Photosynthesis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/APIs/canopy/Photosynthesis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Photosynthesis"><a class="docs-heading-anchor" href="#Photosynthesis">Photosynthesis</a><a id="Photosynthesis-1"></a><a class="docs-heading-anchor-permalink" href="#Photosynthesis" title="Permalink"></a></h1><h2 id="Models-and-Parameters"><a class="docs-heading-anchor" href="#Models-and-Parameters">Models and Parameters</a><a id="Models-and-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Models-and-Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModel" href="#ClimaLand.Canopy.PModel"><code>ClimaLand.Canopy.PModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModel{FT,
            OPFT &lt;: PModelParameters{FT},
            OPCT &lt;: PModelConstants{FT}
            } &lt;: AbstractPhotosynthesisModel{FT}

An implementation of the optimality photosynthesis model &quot;P-model v1.0&quot; of Stocker et al. (2020).

Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T.,
    and Prentice, I. C.: P-model v1.0: an optimality-based light use efficiency model for simulating
    ecosystem gross primary production, Geosci. Model Dev., 13, 1545–1581,
    https://doi.org/10.5194/gmd-13-1545-2020, 2020.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L171-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModelParameters" href="#ClimaLand.Canopy.PModelParameters"><code>ClimaLand.Canopy.PModelParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModelParameters{FT&lt;:AbstractFloat}</code></pre><p>The required parameters for P-model (Stocker et al. 2020). Parameters are typically tunable with considerable uncertainty.</p><ul><li><p><code>cstar</code>: Constant describing cost of maintaining electron transport (unitless)     Typical value = 0.41</p></li><li><p><code>β</code>: Ratio of unit costs of transpiration and carboxylation (unitless)     Typical value = 146</p></li><li><p><code>ϕc</code>: Scaling parameter for temp-dependent intrinsic quantum yield (unitless)     Typical value = 0.087</p></li><li><p><code>ϕ0</code>: Temp-independent intrinsic quantum yield. If provided, overrides ϕc. (unitless)     Typical value = 0.05</p></li><li><p><code>ϕa0</code>: Constant term in temp-dependent intrinsic quantum yield (unitless).</p></li><li><p><code>ϕa1</code>: First order term in temp-dependent intrinsic quantum yield (K^-1).</p></li><li><p><code>ϕa2</code>: Second order term in temp-dependent intrinsic quantum yield (K^-2).</p></li><li><p><code>α</code>: Timescale parameter used in EMA for acclimation of optimal photosynthetic capacities (unitless). Setting this to 0 represents no incorporation of past values. Since we update the EMA equation once per day, α = 1 - 1 day/τ where τ is the acclimation timescale in days.</p></li><li><p><code>sc</code>: Sensitivity to low water pressure, in the moisture stress factor, (Pa^{-1}) [Tuzet et al. (2003)]</p></li><li><p><code>pc</code>: Reference water pressure for the moisture stress factor (Pa) [Tuzet et al. (2003)]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModelConstants" href="#ClimaLand.Canopy.PModelConstants"><code>ClimaLand.Canopy.PModelConstants</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModelConstants{FT&lt;:AbstractFloat}</code></pre><p>The required constants for P-model (Stocker et al. 2020). These are physical or biochemical constants that are not expected to change with time or space.</p><ul><li><p><code>R</code>: Gas constant (J mol^-1 K^-1)</p></li><li><p><code>Kc25</code>: Michaelis-Menten parameter for carboxylation at 25°C (μmol mol^-1)</p></li><li><p><code>Ko25</code>: Michaelis-Menten parameter for oxygenation at 25°C (μmol mol^-1)</p></li><li><p><code>To</code>: Reference temperature equal to 25˚C (K)</p></li><li><p><code>ΔHkc</code>: Energy of activation for Kc (J mol^-1)</p></li><li><p><code>ΔHko</code>: Energy of activation for Ko (J mol^-1)</p></li><li><p><code>Drel</code>: Relative diffusivity of CO2 in the stomatal pores, equal to 1.6.</p></li><li><p><code>ΔHΓstar</code>: Effective energy of activation for Γstar (J mol^-1)</p></li><li><p><code>Γstar25</code>: Γstar at 25 °C (Pa)</p></li><li><p><code>Ha_Vcmax</code>: Effective energy of activation for Vcmax (J mol^-1)</p></li><li><p><code>Hd_Vcmax</code>: Effective energy of deactivation for Vcmax (J mol^-1)</p></li><li><p><code>aS_Vcmax</code>: Intercept term for dS in Vcmax deactivation factor (J K^-1 mol^-1)</p></li><li><p><code>bS_Vcmax</code>: Slope term for dS in Vcmax deactivation factor (J K^-2 mol^-1)</p></li><li><p><code>Ha_Jmax</code>: Effective energy of activation for Jmax (J mol^-1)</p></li><li><p><code>Hd_Jmax</code>: Effective energy of deactivation for Jmax (J mol^-1)</p></li><li><p><code>aS_Jmax</code>: Intercept term for dS in Jmax deactivation factor (J K^-1 mol^-1)</p></li><li><p><code>bS_Jmax</code>: Slope term for dS in Jmax deactivation factor (J K^-2 mol^-1)</p></li><li><p><code>Mc</code>: Molar mass of carbon (kg mol^-1)</p></li><li><p><code>oi</code>: Intercellular O2 mixing ratio (unitless)</p></li><li><p><code>aRd</code>: First order coefficient for temp-dependent Rd (K^-1)</p></li><li><p><code>bRd</code>: Second order coefficient for temp-dependent Rd (K^-2)</p></li><li><p><code>fC3</code>: Constant factor appearing the dark respiration term for C3 plants (unitless)</p></li><li><p><code>planck_h</code>: Planck constant (J s)</p></li><li><p><code>lightspeed</code>: Speed of light (m s^-1)</p></li><li><p><code>N_a</code>: Avogadro constant (mol^-1)</p></li><li><p><code>ρ_water</code>: Density of water (kg m^-3)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L45-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharModel" href="#ClimaLand.Canopy.FarquharModel"><code>ClimaLand.Canopy.FarquharModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FarquharModel{FT}(
    domain;
    photosynthesis_parameters = clm_photosynthesis_parameters(
        domain.space.surface,
    ),
    sc::FT = LP.get_default_parameter(FT, :low_water_pressure_sensitivity),
    pc::FT = LP.get_default_parameter(FT, :moisture_stress_ref_water_pressure),
) where {
    FT &lt;: AbstractFloat,
    MECH &lt;: Union{FT, ClimaCore.Fields.Field},
    VC &lt;: Union{FT, ClimaCore.Fields.Field},
}</code></pre><p>Creates a FarquharModel using default parameters of type FT.</p><p>The <code>photosynthesis_parameters</code> argument is a NamedTuple that contains</p><ul><li><code>is_c3</code>: a Float or Field indicating if plants are C3 (1) or C4 (0) (unitless)</li><li><code>Vcmax25</code>: a Float or Field representing the maximum carboxylation rate at 25C (mol m^-2 s^-1)</li></ul><p>By default, these parameters are set by the <code>clm_photosynthesis_parameters</code> function, which reads in CLM data onto the surface space as ClimaUtilities SpaceVaryingInputs.</p><p>The following additional default parameters are used:</p><ul><li>sc = 5e-6 (Pa^{-1}) - sensitivity to low water pressure in the moisture stress factor [Tuzet et al. (2003)]</li><li>pc = -2e6 (Pa) - reference water pressure for the moisture stress factor [Tuzet et al. (2003)]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/Canopy.jl#L89-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharParameters" href="#ClimaLand.Canopy.FarquharParameters"><code>ClimaLand.Canopy.FarquharParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FarquharParameters{
    FT&lt;:AbstractFloat,
    MECH &lt;: Union{FT, ClimaCore.Fields.Field},
    VC &lt;: Union{FT, ClimaCore.Fields.Field},
}</code></pre><p>The required parameters for the Farquhar photosynthesis model.</p><ul><li><p><code>Vcmax25</code>: Vcmax at 25 °C (mol CO2/m^2/s)</p></li><li><p><code>Γstar25</code>: Γstar at 25 °C (mol/mol)</p></li><li><p><code>Kc25</code>: Michaelis-Menten parameter for CO2 at 25 °C (mol/mol)</p></li><li><p><code>Ko25</code>: Michaelis-Menten parameter for O2 at 25 °C (mol/mol)</p></li><li><p><code>ΔHkc</code>: Energy of activation for CO2 (J/mol)</p></li><li><p><code>ΔHko</code>: Energy of activation for oxygen (J/mol)</p></li><li><p><code>ΔHVcmax</code>: Energy of activation for Vcmax (J/mol)</p></li><li><p><code>ΔHΓstar</code>: Energy of activation for Γstar (J/mol)</p></li><li><p><code>ΔHJmax</code>: Energy of activation for Jmax (J/mol)</p></li><li><p><code>ΔHRd</code>: Energy of activation for Rd (J/mol)</p></li><li><p><code>To</code>: Reference temperature equal to 25 degrees Celsius (K)</p></li><li><p><code>oi</code>: Intercelluar O2 concentration (mol/mol); taken to be constant</p></li><li><p><code>ϕ</code>: Quantum yield of photosystem II (Bernacchi, 2003; unitless)</p></li><li><p><code>θj</code>: Curvature parameter, a fitting constant to compute J, unitless</p></li><li><p><code>fC3</code>: Constant factor appearing the dark respiration term for C3, equal to 0.015.</p></li><li><p><code>fC4</code>: Constant factor appearing the dark respiration term for C4, equal to 0.025.</p></li><li><p><code>sc</code>: Sensitivity to low water pressure, in the moisture stress factor, (Pa^{-1}) [Tuzet et al. (2003)]</p></li><li><p><code>pc</code>: Reference water pressure for the moisture stress factor (Pa) [Tuzet et al. (2003)]</p></li><li><p><code>Q10</code>: Q10 temperature parameter for Vcmax and Rd for C4 photosynthesis; unitless</p></li><li><p><code>s1</code>: Parameter appearing in temperature dependence of C4 Vcmax; K^{-1}</p></li><li><p><code>s2</code>: Parameter appearing in temperature dependence of C4 Vcmax; K</p></li><li><p><code>s3</code>: Parameter appearing in temperature dependence of C4 Vcmax; K^{-1}</p></li><li><p><code>s4</code>: Parameter appearing in temperature dependence of C4 Vcmax; K</p></li><li><p><code>s5</code>: Parameter appearing in temperature dependence of C4 Rd; K^{-1}</p></li><li><p><code>s6</code>: Parameter appearing in temperature dependence of C4 Rd; K</p></li><li><p><code>E</code>: Quantum yield for C4 photosynthesis; mol/mol</p></li><li><p><code>is_c3</code>: Photosynthesis mechanism: 1.0 indicates C3, 0.0 indicates C4</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/photosynthesis.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.OptimalityFarquharModel" href="#ClimaLand.Canopy.OptimalityFarquharModel"><code>ClimaLand.Canopy.OptimalityFarquharModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OptimalityFarquharModel{FT,
                        OPFT &lt;: OptimalityFarquharParameters{FT}
                        } &lt;: AbstractPhotosynthesisModel{FT}</code></pre><p>Optimality model of Smith et al. (2019) for estimating Vcmax, based on the assumption that Aj = Ac. Smith et al. (2019). Global photosynthetic capacity is optimized to the environment. Ecology Letters, 22(3), 506–517. https://doi.org/10.1111/ele.13210</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/optimality_farquhar.jl#L55-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.OptimalityFarquharParameters" href="#ClimaLand.Canopy.OptimalityFarquharParameters"><code>ClimaLand.Canopy.OptimalityFarquharParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OptimalityFarquharParameters{FT&lt;:AbstractFloat}</code></pre><p>The required parameters for the optimality Farquhar photosynthesis model. Currently, only C3 photosynthesis is supported.</p><ul><li><p><code>is_c3</code>: Photosynthesis mechanism: C3 only</p></li><li><p><code>Γstar25</code>: Γstar at 25 °C (mol/mol)</p></li><li><p><code>Kc25</code>: Michaelis-Menten parameter for CO2 at 25 °C (mol/mol)</p></li><li><p><code>Ko25</code>: Michaelis-Menten parameter for O2 at 25 °C (mol/mol)</p></li><li><p><code>ΔHkc</code>: Energy of activation for CO2 (J/mol)</p></li><li><p><code>ΔHko</code>: Energy of activation for oxygen (J/mol)</p></li><li><p><code>ΔHVcmax</code>: Energy of activation for Vcmax (J/mol)</p></li><li><p><code>ΔHΓstar</code>: Energy of activation for Γstar (J/mol)</p></li><li><p><code>ΔHJmax</code>: Energy of activation for Jmax (J/mol)</p></li><li><p><code>ΔHRd</code>: Energy of activation for Rd (J/mol)</p></li><li><p><code>To</code>: Reference temperature equal to 25 degrees Celsius (K)</p></li><li><p><code>oi</code>: Intercellular O2 concentration (mol/mol); taken to be constant</p></li><li><p><code>ϕ</code>: Quantum yield of photosystem II (Bernacchi, 2003; unitless)</p></li><li><p><code>θj</code>: Curvature parameter, a fitting constant to compute J, unitless</p></li><li><p><code>fC3</code>: Constant factor appearing the dark respiration term for C3 plants, equal to 0.015.</p></li><li><p><code>sc</code>: Fitting constant to compute the moisture stress factor (Pa^{-1})</p></li><li><p><code>pc</code>: Fitting constant to compute the moisture stress factor (Pa)</p></li><li><p><code>c</code>: Constant describing cost of maintaining electron transport (unitless)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/optimality_farquhar.jl#L4-L10">source</a></section></article><h2 id="FarquharModel-Methods"><a class="docs-heading-anchor" href="#FarquharModel-Methods">FarquharModel Methods</a><a id="FarquharModel-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#FarquharModel-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.arrhenius_function" href="#ClimaLand.Canopy.arrhenius_function"><code>ClimaLand.Canopy.arrhenius_function</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">arrhenius_function(T::FT, To::FT, R::FT, ΔH::FT)</code></pre><p>Computes the Arrhenius function at temperature <code>T</code> given the reference temperature <code>To=298.15K</code>, the universal gas constant <code>R</code>, and the energy activation <code>ΔH</code>.</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L859-L868">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intercellular_co2" href="#ClimaLand.Canopy.intercellular_co2"><code>ClimaLand.Canopy.intercellular_co2</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intercellular_co2(ca::FT, Γstar::FT, medlyn_factor::FT) where{FT}</code></pre><p>Computes the intercellular CO2 concentration (mol/mol) given the atmospheric concentration (<code>ca</code>, mol/mol), the CO2 compensation (<code>Γstar</code>,  mol/mol), and the Medlyn factor (unitless).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L432-L438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.co2_compensation" href="#ClimaLand.Canopy.co2_compensation"><code>ClimaLand.Canopy.co2_compensation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">co2_compensation(Γstar25::FT,
                 ΔHΓstar::FT,
                 T::FT,
                 To::FT,
                 R::FT) where {FT}</code></pre><p>Computes the CO2 compensation point (<code>Γstar</code>), in units of mol/mol, as a function of its value at 25 °C (<code>Γstar25</code>), a constant energy of activation (<code>ΔHΓstar</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L444-L458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.rubisco_assimilation" href="#ClimaLand.Canopy.rubisco_assimilation"><code>ClimaLand.Canopy.rubisco_assimilation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rubisco_assimilation(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct rubisco assimilation function based on the <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_rubisco_assimilation</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_rubisco_assimilation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L470-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.light_assimilation" href="#ClimaLand.Canopy.light_assimilation"><code>ClimaLand.Canopy.light_assimilation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">light_assimilation(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct light assimilation function based on the <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_light_assimilation</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_light_assimilation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L549-L557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.max_electron_transport" href="#ClimaLand.Canopy.max_electron_transport"><code>ClimaLand.Canopy.max_electron_transport</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_electron_transport(Vcmax::FT) where {FT}</code></pre><p>Computes the maximum potential rate of electron transport (<code>Jmax</code>), in units of mol/m^2/s, as a function of Vcmax at 25 °C (<code>Vcmax25</code>), a constant (<code>ΔHJmax</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L597-L608">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.electron_transport" href="#ClimaLand.Canopy.electron_transport"><code>ClimaLand.Canopy.electron_transport</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_transport(APAR::FT,
                   Jmax::FT,
                   θj::FT,
                   ϕ::FT) where {FT}</code></pre><p>Computes the rate of electron transport (<code>J</code>), in units of mol/m^2/s, as a function of the maximum potential rate of electron transport (<code>Jmax</code>), absorbed photosynthetically active radiation (<code>APAR</code>), an empirical &quot;curvature parameter&quot; (<code>θj</code>; Bonan Eqn 11.21) and the quantum yield of photosystem II (<code>ϕ</code>).</p><p>See Ch 11, G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L621-L635">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.net_photosynthesis" href="#ClimaLand.Canopy.net_photosynthesis"><code>ClimaLand.Canopy.net_photosynthesis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">net_photosynthesis(Ac::FT,
                   Aj::FT,
                   Rd::FT,
                   β::FT) where {FT}</code></pre><p>Computes the total net carbon assimilation (<code>An</code>), in units of mol CO2/m^2/s, as a function of the Rubisco limiting factor (<code>Ac</code>), the electron transport limiting rate (<code>Aj</code>), dark respiration (<code>Rd</code>), and the moisture stress factor (<code>β</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L702-L714">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.optimality_max_photosynthetic_rates" href="#ClimaLand.Canopy.optimality_max_photosynthetic_rates"><code>ClimaLand.Canopy.optimality_max_photosynthetic_rates</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>optimality<em>max</em>photosynthetic_rates(APAR::FT,  θj::FT, ϕ::FT, oi::FT, ci::FT, Γstar::FT, Kc::FT, Ko::FT)</p><p>Computes the photosynthesis rates Vcmax and Jmax in mol/m^2/s given absorbed photosynthetically active radiation (<code>APAR</code>), an empirical &quot;curvature parameter&quot; (<code>θj</code>; Bonan Eqn 11.21)  the quantum yield of photosystem II (<code>ϕ</code>), the intercellular o2 content (<code>oi</code>), the intercellular CO2 concentration (ci), Γstar, and Kc and Ko.</p><p>See Smith et al. 2019.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L647-L658">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.moisture_stress" href="#ClimaLand.Canopy.moisture_stress"><code>ClimaLand.Canopy.moisture_stress</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">moisture_stress(pl::FT,
                sc::FT,
                pc::FT) where {FT}</code></pre><p>Computes the moisture stress factor (<code>β</code>), which is unitless,  as a function of a constant (<code>sc</code>, 1/Pa), a reference pressure (<code>pc</code>, Pa), and the leaf water pressure (<code>pl</code>, Pa) .</p><p>See Eqn 12.57 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L720-L732">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.dark_respiration" href="#ClimaLand.Canopy.dark_respiration"><code>ClimaLand.Canopy.dark_respiration</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dark_respiration(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct dark respiration function based on <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_dark_respiration</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_dark_respiration</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L738-L746">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_GPP" href="#ClimaLand.Canopy.compute_GPP"><code>ClimaLand.Canopy.compute_GPP</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_GPP(An::FT,
         K::FT,
         LAI::FT,
         Ω::FT) where {FT}</code></pre><p>Computes the total canopy photosynthesis (<code>GPP</code>) as a function of the total net carbon assimilation (<code>An</code>), the extinction coefficient (<code>K</code>), leaf area index (<code>LAI</code>) and the clumping index (<code>Ω</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L822-L831">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.MM_Kc" href="#ClimaLand.Canopy.MM_Kc"><code>ClimaLand.Canopy.MM_Kc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MM_Kc(Kc25::FT,
      ΔHkc::FT,
      T::FT,
      To::FT,
      R::FT) where {FT}</code></pre><p>Computes the Michaelis-Menten coefficient for CO2 (<code>Kc</code>), in units of mol/mol or Pa (depending on the units of <code>Kc25</code>), as a function of its value at 25 °C (<code>Kc25</code>), a constant (<code>ΔHkc</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L873-L888">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.MM_Ko" href="#ClimaLand.Canopy.MM_Ko"><code>ClimaLand.Canopy.MM_Ko</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MM_Ko(Ko25::FT,
      ΔHko::FT,
      T::FT,
      To::FT,
      R::FT) where {FT}</code></pre><p>Computes the Michaelis-Menten coefficient for O2 (<code>Ko</code>), in units of mol/mol or Pa (depending on the units of <code>Ko25</code>), as a function of its value at 25 °C (<code>Ko25</code>), a constant (<code>ΔHko</code>), a standard temperature (<code>To</code>), the universal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L894-L909">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_Vcmax" href="#ClimaLand.Canopy.compute_Vcmax"><code>ClimaLand.Canopy.compute_Vcmax</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Vcmax(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct Vcmax function based on <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_compute_Vcmax</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_compute_Vcmax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L915-L923">source</a></section></article><h2 id="PModel-Methods"><a class="docs-heading-anchor" href="#PModel-Methods">PModel Methods</a><a id="PModel-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#PModel-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_full_pmodel_outputs" href="#ClimaLand.Canopy.compute_full_pmodel_outputs"><code>ClimaLand.Canopy.compute_full_pmodel_outputs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_full_pmodel_outputs(
    parameters::PModelParameters{FT},
    constants::PModelConstants{FT},
    T_canopy::FT,
    P_air::FT,
    VPD::FT,
    ca::FT,
    βm::FT,
    APAR::FT,
) where {FT}</code></pre><p>Performs the P-model computations as defined in Stocker et al. (2020) and returns a dictionary of full outputs. See https://github.com/geco-bern/rpmodel for a code reference. This should replicate the behavior of the <code>rpmodel</code> package.</p><p>Args:</p><ul><li><code>parameters</code>:     PModelParameters object containing the model parameters.</li><li><code>constants</code>:      PModelConstants object containing the model constants.</li><li><code>T_canopy</code>:       Canopy temperature (K).</li><li><code>P_air</code>:          Ambient air pressure (Pa).</li><li><code>VPD</code>:            Vapor pressure deficit (Pa).</li><li><code>ca</code>:             Ambient CO2 concentration (mol/mol).</li><li><code>βm</code>:             Soil moisture stress factor (unitless).</li><li><code>APAR</code>:          Absorbed photosynthetically active radiation (mol photons m^-2 s^-1).</li></ul><p>Returns: named tuple with the following keys and descriptions: Output name         Description (units)     &quot;gpp&quot;           Gross primary productivity (kg m^-2 s^-1)     &quot;gammastar&quot;     CO2 compensation point (Pa)     &quot;kmm&quot;           Effective MM coefficient for Rubisco-limited photosynthesis (Pa)     &quot;ns_star&quot;       Viscosity of water normalized to 25 deg C (unitless)     &quot;chi&quot;           Optimal ratio of intercellular to ambient CO2 (unitless)     &quot;xi&quot;            Sensitivity of χ to VPD (Pa^1/2)     &quot;mj&quot;            CO2 limitation factor for light-limited photosynthesis (unitless)     &quot;mc&quot;            CO2 limitation factor for Rubisco-limited photosynthesis (unitless)     &quot;ci&quot;            Intercellular CO2 concentration (Pa)     &quot;iwue&quot;          Intrinsic water use efficiency (Pa)     &quot;gs&quot;            Stomatal conductance (mol m^-2 s^-1 Pa^-1)     &quot;vcmax&quot;         Maximum rate of carboxlation (mol m^-2 s^-1)     &quot;vcmax25&quot;       Vcmax normalized to 25°C via modified-Arrhenius type function (mol m^-2 s^-1)     &quot;jmax&quot;          Maximum rate of electron transport (mol m^-2 s^-1)     &quot;jmax25&quot;        Jmax normalized to 25°C via modified-Arrhenius type function (mol m^-2 s^-1)     &quot;Rd&quot;            Dark respiration rate (mol m^-2 s^-1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L235-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.set_historical_cache!" href="#ClimaLand.Canopy.set_historical_cache!"><code>ClimaLand.Canopy.set_historical_cache!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function set_historical_cache!(p, Y0, model::PModel, canopy)</code></pre><p>The P-model requires a cache of optimal Vcmax25, Jmax25, and ξ that represent past acclimated values. Before the simulation, we need to have some physically meaningful initial values for these variables, which live in p.canopy.photosynthesis.OptVars.</p><p>This method assumes that the acclimation is to the initial conditions of the simulation. Note that if the initial condition is e.g., nighttime, then initially the optimal Vcmax and Jmax are zero, so it will take ~1 month (two e-folding timescales for α corresponding to 2 week acclimation timescale) for the model to reach a physically meaningful state.</p><p>An alternative to this approach is to initialize the initial optimal values to some reasonable values based on a spun-up simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L564-L578">source</a></section><section><div><pre><code class="language-julia hljs">set_historical_cache!(p, Y0, m::AbstractPhotosynthesisModel, canopy)</code></pre><p>For some canopy components (namely the P-model), we need values at t-1 to compute new values, so this function sets the historical cache values for the photosynthesis model. However, for other photosynthesis models this is not needed, so do nothing by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/Canopy.jl#L1210-L1216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.update_optimal_EMA" href="#ClimaLand.Canopy.update_optimal_EMA"><code>ClimaLand.Canopy.update_optimal_EMA</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_optimal_EMA(
    parameters::PModelParameters{FT},
    constants::PModelConstants{FT},
    OptVars::NamedTuple{(:ξ_opt, :Vcmax25_opt, :Jmax25_opt), Tuple{FT, FT, FT}},
    T_canopy::FT,
    P_air::FT,
    VPD::FT,
    ca::FT,
    βm::FT,
    APAR::FT,
    local_noon_mask::FT,
) where {FT}</code></pre><p>This function updates the optimal photosynthetic capacities Vcmax25, Jmax25 and sensitivity of stomatal conductance to dryness (ξ) using an exponential moving average (EMA) that computes new optimal values at local noon, following Mengoli et al. (2022).</p><p>Args:</p><ul><li><code>parameters</code>: PModelParameters object containing the model parameters.</li><li><code>constants</code>: PModelConstants object containing the model constants.</li><li><code>OptVars</code>: NamedTuple containing the current optimal values of ξ, Vcmax25, and Jmax25.</li><li><code>T_canopy</code>: Canopy temperature (K).</li><li><code>P_air</code>: Ambient air pressure (Pa).</li><li><code>VPD</code>: Vapor pressure deficit (Pa).</li><li><code>ca</code>: Ambient CO2 concentration (mol/mol).</li><li><code>βm</code>: Soil moisture stress factor (unitless).</li><li><code>APAR</code>: Absorbed photosynthetically active radiation (mol photons m^-2 s^-1).</li><li><code>local_noon_mask</code>: A mask (0 or 1) indicating whether the current time is within the local noon window.</li></ul><p>Returns:</p><ul><li>NamedTuple with updated optimal values of ξ, Vcmax25, and Jmax25</li></ul><p>Reference: Mengoli, G., Agustí-Panareda, A., Boussetta, S., Harrison, S. P., Trotta, C., &amp; Prentice, I. C. (2022). Ecosystem photosynthesis in land-surface models: A first-principles approach incorporating acclimation. Journal of Advances in Modeling Earth Systems, 14, e2021MS002767. https://doi.org/10.1029/2021MS002767</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L406-L443">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.make_PModel_callback" href="#ClimaLand.Canopy.make_PModel_callback"><code>ClimaLand.Canopy.make_PModel_callback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function make_PModel_callback(
    ::Type{FT},
    start_date::Dates.DateTime,
    dt::Union{AbstractFloat, Dates.Period},
    canopy,
    longitude = nothing
) where {FT &lt;: AbstractFloat}</code></pre><p>This constructs a FrequencyBasedCallback for the P-model that updates the optimal photosynthetic capacities using an exponential moving average at local noon.</p><p>We check for local noon using the provided <code>longitude</code> (once passing in lat/lon for point/column domains, this can be automatically extracted from the domain axes) every dt. The time of local noon is expressed in seconds UTC and neglects the effects of obliquity and eccentricity, so it is constant throughout the year. This presents an error of up to ~20 minutes, but it is sufficient for our application here (since meteorological drivers are often updated at coarser time intervals anyway).</p><p>Args</p><ul><li><code>FT</code>: The floating-point type used in the model (e.g., <code>Float32</code>, <code>Float64</code>).</li><li><code>start_date</code>: datetime object for the start of the simulation (UTC).</li><li><code>dt</code>: timestep</li><li><code>canopy</code>: the canopy object containing the P-model parameters and constants.</li><li><code>longitude</code>: optional longitude in degrees for local noon calculation (default is <code>nothing</code>). If we are on   a ClimaLand.Domains.Point, this will need to be supplied explicitly. Otherwise, if we are on a field, then   the longitude at each point can be automatically extracted from the field axes (THIS STILL NEEDS TO BE TESTED)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/pmodel.jl#L721-L747">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intrinsic_quantum_yield" href="#ClimaLand.Canopy.intrinsic_quantum_yield"><code>ClimaLand.Canopy.intrinsic_quantum_yield</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intrinsic_quantum_yield(
    T::FT,
    c::FT,
    ϕa0::FT,
    ϕa1::FT,
    ϕa2::FT
) where {FT}</code></pre><p>Computes the intrinsic quantum yield of photosynthesis ϕ (mol/mol) as a function of temperature T (K) and a calibratable parameter c (unitless). The functional form given in Bernacchi et al (2003) and used in Stocker et al. (2020) is a second order polynomial in T (deg C) with coefficients ϕa0, ϕa1, and ϕa2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1151-L1165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_viscosity_ratio" href="#ClimaLand.Canopy.compute_viscosity_ratio"><code>ClimaLand.Canopy.compute_viscosity_ratio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_viscosity_ratio(
    T::FT,
    To::FT,
    ρ_water::FT
) where {FT}</code></pre><p>Computes η*, the ratio of the viscosity of water at temperature T to that at To = 25˚C.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1269-L1277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_Kmm" href="#ClimaLand.Canopy.compute_Kmm"><code>ClimaLand.Canopy.compute_Kmm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Kmm(
    T::FT,
    p::FT,
    Kc25::FT,
    Ko25::FT,
    ΔHkc::FT,
    ΔHko::FT,
    To::FT,
    R::FT,
    oi::FT
) where {FT}</code></pre><p>Computes the effective Michaelis-Menten coefficient for Rubisco-limited photosynthesis (<code>Kmm</code>), in units Pa, as a function of temperature T (K), atmospheric pressure p (Pa), and constants: Kc25 (Michaelis-Menten coefficient for CO2 at 25 °C), Ko25 (Michaelis-Menten coefficient for O2 at 25 °C), ΔHkc (effective enthalpy of activation for Kc), ΔHko (effective enthalpy of activation for Ko), To (reference temperature, typically 298.15 K), R (universal gas constant), and oi (O2 mixing ratio, typically 0.209).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1323-L1342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.optimal_co2_ratio_c3" href="#ClimaLand.Canopy.optimal_co2_ratio_c3"><code>ClimaLand.Canopy.optimal_co2_ratio_c3</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimal_co2_ratio_c3(
    Kmm::FT,
    Γstar::FT,
    ηstar::FT,
    ca::FT,
    VPD::FT,
    β::FT,
    Drel::FT
) where {FT}</code></pre><p>The p-model assumptions, that 1) plants optimize the relative costs of transpiration per unit carbon assimlated and costs of maintaining carboxylation capacity per unit carbon assimilated;</p><ol><li>coordination hypothesis (assimilation is limited simultaneously by both light and Rubisco)</li></ol><p>are applied to compute the optimal ratio of intercellular to ambient CO2 concentration (<code>χ</code>) and auxiliary variables ξ, mj, and mc. mj and mc represent capacities for light and Rubisco- limited photosynthesis, respectively.</p><p>Parameters: Kmm (effective Michaelis-Menten coefficient for Rubisco-limited photosynthesis, Pa), Γstar (CO2 compensation point, Pa), ηstar (viscosity ratio), ca_pp (ambient CO2 partial pressure, Pa), VPD (vapor pressure deficit, Pa), β (moisture stress factor, unitless), Drel = 1.6 (relative diffusivity of water vapor with respect to CO2, unitless).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1360-L1382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intercellular_co2_pmodel" href="#ClimaLand.Canopy.intercellular_co2_pmodel"><code>ClimaLand.Canopy.intercellular_co2_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intercellular_co2_pmodel(ξ::FT, ca_pp::FT, Γstar::FT, VPD::FT) where {FT}</code></pre><p>Computes the intercellular co2 concentration (<code>ci</code>) as a function of the optimal <code>ξ</code> (sensitivity to dryness), <code>ca_pp</code> (ambient CO2 partial pressure), <code>Γstar</code> (CO2 compensation point), and <code>VPD</code> (vapor pressure deficit).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1405-L1411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.gs_co2_pmodel" href="#ClimaLand.Canopy.gs_co2_pmodel"><code>ClimaLand.Canopy.gs_co2_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gs_co2_pmodel(
    χ::FT,
    ca::FT,
    A::FT
) where {FT}</code></pre><p>Computes the stomatal conductance of CO2 (<code>gs_co2</code>), in units of mol CO2/m^2/s via Fick&#39;s law. Parameters are the ratio of intercellular to ambient CO2 concentration (<code>χ</code>), the ambient CO2 concentration (<code>ca</code>, in mol/mol), and the assimilation rate (<code>A</code>, mol m^-2 s^-1). This is related to the conductance of water by a factor Drel (default value = 1.6).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1421-L1433">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.gs_h2o_pmodel" href="#ClimaLand.Canopy.gs_h2o_pmodel"><code>ClimaLand.Canopy.gs_h2o_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gs_h2o_pmodel(
    χ::FT,
    ca::FT,
    A::FT,
    Drel::FT
) where {FT}</code></pre><p>Computes the stomatal conductance of H2O (<code>gs_h2o</code>), in units of mol H2O/m^2/s via Fick&#39;s law. Parameters are the ratio of intercellular to ambient CO2 concentration (<code>χ</code>), the ambient CO2 concentration (<code>ca</code>, in mol/mol), the assimilation rate (<code>A</code>, mol m^-2 s^-1), and the relative conductivity ratio <code>Drel</code> (unitless).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1438-L1450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.vcmax_pmodel" href="#ClimaLand.Canopy.vcmax_pmodel"><code>ClimaLand.Canopy.vcmax_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vcmax_pmodel(
    ϕ0::FT,
    APAR::FT,
    mprime::FT,
    mc::FT
    βm::FT
) where {FT}</code></pre><p>Computes the maximum rate of carboxylation assuming optimality and Aj = Ac using the intrinsic quantum yield (<code>ϕ0</code>), absorbed photosynthetically active radiation (<code>APAR</code>), Jmax-adjusted capacity (<code>mprime</code>), a Rubisco-limited capacity (<code>mc</code>), and empirical soil moisture stress factor (<code>βm</code>). See Eqns 16 and 6 in Stocker et al. (2020).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1491-L1504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_LUE" href="#ClimaLand.Canopy.compute_LUE"><code>ClimaLand.Canopy.compute_LUE</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_LUE(
    ϕ0::FT,
    β::FT,
    mprime::FT,
    Mc::FT
) where {FT}</code></pre><p>Computes light use efficiency (LUE) in kg C/mol from intrinsic quantum yield (<code>ϕ0</code>), moisture stress factor (<code>β</code>), and a Jmax modified capacity (<code>mprime</code>); see Eqn 17 and 19 in Stocker et al. (2020). Mc is the molar mass of carbon (kg/mol) = 0.0120107 kg/mol.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1474-L1485">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_mj_with_jmax_limitation" href="#ClimaLand.Canopy.compute_mj_with_jmax_limitation"><code>ClimaLand.Canopy.compute_mj_with_jmax_limitation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mj_with_jmax_limitation(
    mj::FT,
    cstar::FT
) where {FT}</code></pre><p>Computes m&#39; such that Aj = ϕ0 APAR * m&#39; (a LUE model) by assuming that dA/dJmax = c is constant. cstar is defined as 4c, a free parameter. Wang etal (2017) derive cstar = 0.412 at STP and using Vcmax/Jmax = 1.88.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1455-L1464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.electron_transport_pmodel" href="#ClimaLand.Canopy.electron_transport_pmodel"><code>ClimaLand.Canopy.electron_transport_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_transport_pmodel(
    ϕ0::FT,
    APAR::FT,
    Jmax::FT
) where {FT}</code></pre><p>Computes the rate of electron transport (<code>J</code>) in mol electrons/m^2/s for the pmodel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1546-L1554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.co2_compensation_p" href="#ClimaLand.Canopy.co2_compensation_p"><code>ClimaLand.Canopy.co2_compensation_p</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">co2_compensation_p(
    T::FT,
    To::FT,
    p::FT,
    R::FT,
    ΔHΓstar::FT
    Γstar25::FT
) where {FT}</code></pre><p>Computes the CO2 compensation point (<code>Γstar</code>), in units Pa, as a function of temperature T (K) and pressure p (Pa). See Equation B5 of Stocker et al. (2020).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1298-L1310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.quadratic_soil_moisture_stress" href="#ClimaLand.Canopy.quadratic_soil_moisture_stress"><code>ClimaLand.Canopy.quadratic_soil_moisture_stress</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">quadratic_soil_moisture_stress(
    θ::FT,
    meanalpha::FT = FT(1.0),
    a_hat::FT = FT(0.0),
    b_hat::FT = FT(0.685),
    θ0::FT = FT(0.0),
    θ1::FT = FT(0.6)
) where {FT}</code></pre><p>Computes an empirical soil moisture stress factor (<code>β</code>) according to the quadratic functional form of Stocker et al. (2020), Eq 21, using the soil moisture (<code>θ</code>), AET/PET (<code>meanalpha</code>), and parameters <code>a_hat</code>, <code>b_hat</code>, <code>θ0</code>, and <code>θ1</code>. Default values are from the original paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1510-L1524">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_APAR" href="#ClimaLand.Canopy.compute_APAR"><code>ClimaLand.Canopy.compute_APAR</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_APAR(
    f_abs::FT,
    par_d::FT,
    λ_γ_PAR::FT,
    lightspeed::FT,
    planck_h::FT,
    N_a::FT
) where {FT}</code></pre><p>Computes the absorbed photosynthetically active radiation over leaf area (mol photons m^-2 s^-1) given the fraction of absorbed PAR (<code>f_abs</code>), the PAR downwelling flux (<code>par_d</code>, in W m^-2), and the wavelength of PAR (<code>λ_γ_PAR</code>, in m), and the physical constants necessary to compute the energy per mol PAR photons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/49d23154f1858edac65a3b77226ab7a547196bfc/src/standalone/Vegetation/canopy_parameterizations.jl#L1629-L1643">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PlantHydraulics/">« Plant Hydraulics</a><a class="docs-footer-nextpage" href="../RadiativeTransfer/">Canopy Radiative Transfer »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 19 August 2025 08:05">Tuesday 19 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
