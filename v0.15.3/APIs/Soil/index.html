<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Soil Energy and Hydrology · ClimaLand.jl</title><meta name="title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta property="og:title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta property="twitter:title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Running land simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Bucket LSM</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Bucket/bucket_tutorial/">Introduction to the Land Bucket Model</a></li><li><a class="tocitem" href="../../generated/standalone/Bucket/coupled_bucket/">Setting up a Coupled Simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Integrated soil+canopy modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/integrated/soil_canopy_tutorial/">Coupled Canopy and Soil</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Handling interactions between model components</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Soil modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/freezing_front/">Phase Changes</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/sublimation/">Bare soil site</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2-2"><span class="docs-label">Canopy modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Canopy/canopy_tutorial/">Standalone Canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-3" type="checkbox"/><label class="tocitem" for="menuitem-3-2-3"><span class="docs-label">Snow Modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Snow/base_tutorial/">Seasonal Snow Timeseries Generation with a Neural Network</a></li><li><a class="tocitem" href="../../generated/standalone/Snow/data_tutorial/">Scraping SNOTEL Data</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Calibrating your ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/calibration/minimal_working_example/">Single site perfect model</a></li><li><a class="tocitem" href="../../generated/calibration/minimal_working_example_obs/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><a class="tocitem" href="../../generated/standalone/Usage/LSM_single_column_tutorial/">Intro to multi-component models</a></li><li><a class="tocitem" href="../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Standalone models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-2" type="checkbox"/><label class="tocitem" for="menuitem-4-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-3" type="checkbox"/><label class="tocitem" for="menuitem-4-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/plant_hydraulics/van_genuchten_model/">Van Genuchten model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Hydrology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/hydrology/richards_model/">Richards model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-3" type="checkbox"/><label class="tocitem" for="menuitem-4-2-3"><span class="docs-label">Energy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/energy/energy_model/">Energy model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">SurfaceWater</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/surface_water/surface_water_model/">Surface water model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><a class="tocitem" href="../../Contributing/">Contribution guide</a></li><li><a class="tocitem" href="../../folderstructure/">Repository structure</a></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox" checked/><label class="tocitem" for="menuitem-8"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox" checked/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">ClimaLand</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ClimaLand/">ClimaLand</a></li><li><a class="tocitem" href="../Regridder/">Parameter Dataset Tools</a></li><li><a class="tocitem" href="../shared_utilities/">Shared Utilities</a></li><li><input class="collapse-toggle" id="menuitem-8-1-4" type="checkbox" checked/><label class="tocitem" for="menuitem-8-1-4"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Soil Energy and Hydrology</a><ul class="internal"><li><a class="tocitem" href="#Soil-Models-2"><span>Soil Models</span></a></li><li><a class="tocitem" href="#Soil-Parameter-Structs"><span>Soil Parameter Structs</span></a></li><li><a class="tocitem" href="#Soil-Hydrology-Parameterizations"><span>Soil Hydrology Parameterizations</span></a></li><li><a class="tocitem" href="#Soil-Heat-Parameterizations"><span>Soil Heat Parameterizations</span></a></li><li><a class="tocitem" href="#Soil-Runoff-Types-and-Methods"><span>Soil Runoff Types and Methods</span></a></li><li><a class="tocitem" href="#Soil-BC-Methods-and-Types"><span>Soil BC Methods and Types</span></a></li><li><a class="tocitem" href="#Soil-Source-Types"><span>Soil Source Types</span></a></li><li><a class="tocitem" href="#Soil-Jacobian-Structures"><span>Soil Jacobian Structures</span></a></li></ul></li><li><a class="tocitem" href="../SoilBiogeochemistry/">Soil Biogeochemistry</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-5" type="checkbox"/><label class="tocitem" for="menuitem-8-1-5"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../canopy/Photosynthesis/">Canopy Photosynthesis</a></li><li><a class="tocitem" href="../canopy/RadiativeTransfer/">Canopy RT</a></li><li><a class="tocitem" href="../canopy/CanopyEnergy/">Canopy Energy</a></li><li><a class="tocitem" href="../canopy/StomatalConductance/">Canopy Stomatal Conductance</a></li><li><a class="tocitem" href="../canopy/AutotrophicRespiration/">Canopy Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../Snow/">Snow Model</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">APIs</a></li><li><a class="is-disabled">ClimaLand</a></li><li><a class="is-disabled">Soil</a></li><li class="is-active"><a href>Soil Energy and Hydrology</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Soil Energy and Hydrology</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/APIs/Soil.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Soil-Models"><a class="docs-heading-anchor" href="#Soil-Models">Soil Models</a><a id="Soil-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Models" title="Permalink"></a></h1><h2 id="Soil-Models-2"><a class="docs-heading-anchor" href="#Soil-Models-2">Soil Models</a><a class="docs-heading-anchor-permalink" href="#Soil-Models-2" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.AbstractSoilModel" href="#ClimaLand.Soil.AbstractSoilModel"><code>ClimaLand.Soil.AbstractSoilModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSoilModel{FT} &lt;: ClimaLand.AbstractImExModel{FT}</code></pre><p>The abstract type for all soil models.</p><p>Currently, we only have plans to support a RichardsModel, simulating the flow of liquid water through soil via the Richardson-Richards equation, and a fully integrated soil heat and water model, with phase change.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Soil.jl#L118-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.RichardsModel" href="#ClimaLand.Soil.RichardsModel"><code>ClimaLand.Soil.RichardsModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RichardsModel</code></pre><p>A model for simulating the flow of water in a porous medium by solving the Richardson-Richards Equation.</p><p>A variety of boundary condition types are supported, including FluxBC, RichardsAtmosDrivenFluxBC, MoistureStateBC, and FreeDrainage (only for the bottom of the domain).</p><p>If you wish to simulate soil hydrology under the context of a prescribed precipitation volume flux (m/s) as a function of time, the RichardsAtmosDrivenFluxBC type should be chosen. Please see the documentation for more details.</p><ul><li><p><code>parameters</code>: the parameter set</p></li><li><p><code>domain</code>: the soil domain, using ClimaCore.Domains</p></li><li><p><code>boundary_conditions</code>: the boundary conditions, of type AbstractSoilBoundaryConditions</p></li><li><p><code>sources</code>: A tuple of sources, each of type AbstractSoilSource</p></li><li><p><code>lateral_flow</code>: A boolean flag which, when false, turns off the horizontal flow of water</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/rre.jl#L39-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.EnergyHydrology" href="#ClimaLand.Soil.EnergyHydrology"><code>ClimaLand.Soil.EnergyHydrology</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EnergyHydrology &lt;: AbstractSoilModel</code></pre><p>A model for simulating the flow of water and heat in a porous medium by solving the Richardson-Richards equation and the heat equation, including terms for phase change.</p><p>A variety of boundary condition types are supported, including FluxBC, MoistureStateBC/TemperatureStateBC, FreeDrainage (only for the bottom of the domain), and an AtmosDrivenFluxBC (under which radiative fluxes and turbulent surface fluxes are computed and used as boundary conditions). Please see the documentation for this boundary condition type for more details.</p><ul><li><p><code>parameters</code>: The parameter sets</p></li><li><p><code>domain</code>: the soil domain, using ClimaCore.Domains</p></li><li><p><code>boundary_conditions</code>: the boundary conditions for RRE and heat, of type AbstractSoilBoundaryConditions</p></li><li><p><code>sources</code>: A tuple of sources, each of type AbstractSoilSource</p></li><li><p><code>lateral_flow</code>: A boolean flag which, when false, turns off the horizontal flow of water and heat</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/energy_hydrology.jl#L83-L99">source</a></section></article><h2 id="Soil-Parameter-Structs"><a class="docs-heading-anchor" href="#Soil-Parameter-Structs">Soil Parameter Structs</a><a id="Soil-Parameter-Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Parameter-Structs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.RichardsParameters" href="#ClimaLand.Soil.RichardsParameters"><code>ClimaLand.Soil.RichardsParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RichardsParameters{F &lt;: Union{&lt;: AbstractFloat, ClimaCore.Fields.Field}, C &lt;: AbstractSoilHydrologyClosure}</code></pre><p>A struct for storing parameters of the <code>RichardsModel</code>.</p><ul><li><p><code>ν</code>: The porosity of the soil (m^3/m^3)</p></li><li><p><code>hydrology_cm</code>: The hydrology closure model: vanGenuchten or BrooksCorey</p></li><li><p><code>K_sat</code>: The saturated hydraulic conductivity (m/s)</p></li><li><p><code>S_s</code>: The specific storativity (1/m)</p></li><li><p><code>θ_r</code>: The residual water fraction (m^3/m^3</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/rre.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.EnergyHydrologyParameters" href="#ClimaLand.Soil.EnergyHydrologyParameters"><code>ClimaLand.Soil.EnergyHydrologyParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EnergyHydrologyParameters{
        FT &lt;: AbstractFloat,
        F &lt;: Union{&lt;:AbstractFloat, ClimaCore.Fields.Field},
        SF &lt;: Union{&lt;:AbstractFloat, ClimaCore.Fields.Field},
        C,
        PSE,
    }</code></pre><p>A parameter structure for the integrated soil water and energy  equation system.</p><p>Note that we require two different parameter types F and SF; these are for parameters that are defined on the surface only and those defined in the interior of the soil domain:</p><ul><li>Surface parameters: albedo in each wavelength band (SF)</li><li>Scalar parameters: emissivity, α, β, γ, γT_ref, Ω,</li></ul><p>roughness lengths z<em>0, d</em>ds ) (FT)</p><ul><li>Parameters defined in the interior: all else (F)</li></ul><ul><li><p><code>κ_dry</code>: The dry soil thermal conductivity, W/m/K</p></li><li><p><code>κ_sat_frozen</code>: The saturated thermal conductivity of frozen soil, W/m/K</p></li><li><p><code>κ_sat_unfrozen</code>: The saturated thermal conductivity of unfrozen soil, W/m/K</p></li><li><p><code>ρc_ds</code>: The volumetric heat capacity of dry soil, J/m^3/K (per volume dry soil, not per volume soil solids)</p></li><li><p><code>ν</code>: The porosity of the soil (m^3/m^3)</p></li><li><p><code>ν_ss_om</code>: The volumetric fraction of the soil solids in organic matter (m^3/m^3)</p></li><li><p><code>ν_ss_quartz</code>: The volumetric fraction of the soil solids in quartz (m^3/m^3)</p></li><li><p><code>ν_ss_gravel</code>: The volumetric fraction of the soil solids in gravel (m^3/m^3)</p></li><li><p><code>α</code>: The parameter α used in computing Kersten number, unitless</p></li><li><p><code>β</code>: The parameter β used in computing Kersten number, unitless</p></li><li><p><code>hydrology_cm</code>: The soil hydrology closure model: van Genuchten or Brooks and Corey</p></li><li><p><code>K_sat</code>: The saturated hydraulic conductivity (m/s)</p></li><li><p><code>S_s</code>: The specific storativity (1/m)</p></li><li><p><code>θ_r</code>: The residual water fraction (m^3/m^3</p></li><li><p><code>Ω</code>: Ice impedance factor for the hydraulic conductivity</p></li><li><p><code>γ</code>: Coefficient of viscosity factor for the hydraulic conductivity</p></li><li><p><code>γT_ref</code>: Reference temperature for the viscosity factor</p></li><li><p><code>PAR_albedo</code>: Soil PAR Albedo</p></li><li><p><code>NIR_albedo</code>: Soil NIR Albedo</p></li><li><p><code>emissivity</code>: Soil Emissivity</p></li><li><p><code>z_0m</code>: Roughness length for momentum</p></li><li><p><code>z_0b</code>: Roughness length for scalars</p></li><li><p><code>d_ds</code>: Maximum dry soil layer thickness under evaporation (m)</p></li><li><p><code>earth_param_set</code>: Physical constants and clima-wide parameters</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/energy_hydrology.jl#L1-L23">source</a></section></article><h2 id="Soil-Hydrology-Parameterizations"><a class="docs-heading-anchor" href="#Soil-Hydrology-Parameterizations">Soil Hydrology Parameterizations</a><a id="Soil-Hydrology-Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Hydrology-Parameterizations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.volumetric_liquid_fraction" href="#ClimaLand.Soil.volumetric_liquid_fraction"><code>ClimaLand.Soil.volumetric_liquid_fraction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volumetric_liquid_fraction(ϑ_l::FT, ν_eff::FT, θ_r::FT) where {FT}</code></pre><p>A pointwise function returning the volumetric liquid fraction given the augmented liquid fraction and the effective porosity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.pressure_head" href="#ClimaLand.Soil.pressure_head"><code>ClimaLand.Soil.pressure_head</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pressure_head(
    cm::vanGenuchten{FT},
    θ_r::FT,
    ϑ_l::FT,
    ν_eff::FT,
    S_s::FT,
) where {FT}</code></pre><p>A point-wise function returning the pressure head in variably saturated soil, using the van Genuchten matric potential  if the soil is not saturated, and an approximation of the positive pressure in the soil if the soil is saturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L80-L94">source</a></section><section><div><pre><code class="language-julia hljs">pressure_head(
    cm::BrooksCorey{FT},
    θ_r::FT,
    ϑ_l::FT,
    ν_eff::FT,
    S_s::FT,
) where {FT}</code></pre><p>A point-wise function returning the pressure head in variably saturated soil, using the Brooks and Corey matric potential  if the soil is not saturated, and an approximation of the positive pressure in the soil if the soil is saturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L230-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.hydraulic_conductivity" href="#ClimaLand.Soil.hydraulic_conductivity"><code>ClimaLand.Soil.hydraulic_conductivity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> hydraulic_conductivity(cm::vanGenuchten{FT}, K_sat::FT, S::FT) where {FT}</code></pre><p>A point-wise function returning the hydraulic conductivity, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L133-L138">source</a></section><section><div><pre><code class="language-julia hljs"> hydraulic_conductivity(cm::BrooksCorey{FT}, K_sat::FT, S::FT) where {FT}</code></pre><p>A point-wise function returning the hydraulic conductivity, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L208-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.impedance_factor" href="#ClimaLand.Soil.impedance_factor"><code>ClimaLand.Soil.impedance_factor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">impedance_factor(
    f_i::FT,
    Ω::FT
) where {FT}</code></pre><p>Returns the multiplicative factor reducing conductivity when  a fraction of ice <code>f_i</code> is present.</p><p>Only for use with the <code>EnergyHydrology</code> model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L263-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.viscosity_factor" href="#ClimaLand.Soil.viscosity_factor"><code>ClimaLand.Soil.viscosity_factor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viscosity_factor(
    T::FT,
    γ::FT,
    γT_ref::FT,
) where {FT}</code></pre><p>Returns the multiplicative factor which accounts for the temperature dependence of the conductivity.</p><p>Only for use with the <code>EnergyHydrology</code> model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L279-L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.effective_saturation" href="#ClimaLand.Soil.effective_saturation"><code>ClimaLand.Soil.effective_saturation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">effective_saturation(porosity::FT, ϑ_l::FT, θr::FT) where {FT}</code></pre><p>A point-wise function computing the effective saturation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.matric_potential" href="#ClimaLand.Soil.matric_potential"><code>ClimaLand.Soil.matric_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> matric_potential(cm::vanGenuchten{FT}, S::FT) where {FT}</code></pre><p>A point-wise function returning the matric potential, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L39-L44">source</a></section><section><div><pre><code class="language-julia hljs"> matric_potential(cm::BrooksCorey{FT}, S::FT) where {FT}</code></pre><p>A point-wise function returning the matric potential, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L154-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.dψdϑ" href="#ClimaLand.Soil.dψdϑ"><code>ClimaLand.Soil.dψdϑ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dψdϑ(cm::vanGenuchten{FT}, ϑ, ν, θ<em>r, S</em>s)</p><p>Computes and returns the derivative of the pressure head  with respect to ϑ for the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L112-L117">source</a></section><section><div><p>dψdϑ(cm::BrooksCorey{FT}, ϑ, ν, θ<em>r, S</em>s)</p><p>Computes and returns the derivative of the pressure head  with respect to ϑ for the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L192-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.inverse_matric_potential" href="#ClimaLand.Soil.inverse_matric_potential"><code>ClimaLand.Soil.inverse_matric_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> inverse_matric_potential(cm::vanGenuchten{FT}, ψ::FT) where {FT}</code></pre><p>A point-wise function returning the effective saturation, given the matric potential, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L51-L57">source</a></section><section><div><pre><code class="language-julia hljs"> inverse_matric_potential(cm::BrooksCorey{FT}, ψ::FT) where {FT}</code></pre><p>A point-wise function returning the effective saturation, given the matric potential, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_hydrology_parameterizations.jl#L166-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.AbstractSoilHydrologyClosure" href="#ClimaLand.Soil.AbstractSoilHydrologyClosure"><code>ClimaLand.Soil.AbstractSoilHydrologyClosure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSoilHydrologyClosure{FT &lt;: AbstractFloat}</code></pre><p>The abstract type of soil hydrology closure, of which vanGenuchten{FT} and BrooksCorey{FT} are the two supported  concrete types.</p><p>To add a new parameterization, methods are required for:</p><ul><li>matric_potential,</li><li>inverse<em>matric</em>potential,</li><li>pressure_head,</li><li>dψdϑ,</li><li>hydraulic_conductivity.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/retention_models.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.vanGenuchten" href="#ClimaLand.Soil.vanGenuchten"><code>ClimaLand.Soil.vanGenuchten</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vanGenuchten{FT} &lt;: AbstractSoilHydrologyClosure{FT}</code></pre><p>The van Genuchten soil hydrology closure, chosen when the  hydraulic conductivity and matric potential are modeled using the van Genuchten parameterization (van Genuchten 1980; see also Table 8.2 of G. Bonan 2019).</p><ul><li><p><code>α</code>: The inverse of the air entry potential (1/m)</p></li><li><p><code>n</code>: The van Genuchten pore-size distribution index (unitless)</p></li><li><p><code>m</code>: The van Genuchten parameter m = 1 - 1/n (unitless)</p></li><li><p><code>S_c</code>: A derived parameter: the critical saturation at which capillary flow no longer replenishes the surface</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/retention_models.jl#L20-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.BrooksCorey" href="#ClimaLand.Soil.BrooksCorey"><code>ClimaLand.Soil.BrooksCorey</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>BrooksCorey{FT} &lt;: AbstractSoilHydrologyClosure{FT}</p><p>The Brooks and Corey soil hydrology closure, chosen when the  hydraulic conductivity and matric potential are modeled using the Brooks and Corey parameterization (Brooks and Corey, 1964, 1966; see also Table 8.2 of G. Bonan 2019).</p><ul><li><p><code>c</code>: The pore-size distribution index (unitless)</p></li><li><p><code>ψb</code>: The air entry matric potential, when S=1 (m)</p></li><li><p><code>S_c</code>: A derived parameter: the critical saturation at which capillary flow no longer replenishes the surface</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/retention_models.jl#L47-L56">source</a></section></article><h2 id="Soil-Heat-Parameterizations"><a class="docs-heading-anchor" href="#Soil-Heat-Parameterizations">Soil Heat Parameterizations</a><a id="Soil-Heat-Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Heat-Parameterizations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.volumetric_heat_capacity" href="#ClimaLand.Soil.volumetric_heat_capacity"><code>ClimaLand.Soil.volumetric_heat_capacity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volumetric_heat_capacity(
    θ_l::FT,
    θ_i::FT,
    ρc_ds::FT,
    earth_param_set::EP,
) where {FT,EP}</code></pre><p>Compute the expression for volumetric heat capacity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L75-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.κ_solid" href="#ClimaLand.Soil.κ_solid"><code>ClimaLand.Soil.κ_solid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">κ_solid(ν_ss_om::FT,
        ν_ss_quartz::FT,
        κ_om::FT,
        κ_quartz::FT,
        κ_minerals::FT) where {FT}</code></pre><p>Computes the thermal conductivity of the solid material in soil. The <code>_ss_</code> subscript denotes that the volumetric fractions of the soil components are referred to the soil solid components, not including the pore space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L255-L266">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.κ_sat_frozen" href="#ClimaLand.Soil.κ_sat_frozen"><code>ClimaLand.Soil.κ_sat_frozen</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function κ_sat_frozen(
    κ_solid::FT,
    ν::FT,
    κ_ice::FT
) where {FT}</code></pre><p>Computes the thermal conductivity for saturated frozen soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L280-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.κ_sat_unfrozen" href="#ClimaLand.Soil.κ_sat_unfrozen"><code>ClimaLand.Soil.κ_sat_unfrozen</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function κ_sat_unfrozen(
    κ_solid::FT,
    ν::FT,
    κ_l::FT
) where {FT}</code></pre><p>Computes the thermal conductivity for saturated unfrozen soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L292-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.κ_sat" href="#ClimaLand.Soil.κ_sat"><code>ClimaLand.Soil.κ_sat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">κ_sat(
    θ_l::FT,
    θ_i::FT,
    κ_sat_unfrozen::FT,
    κ_sat_frozen::FT
) where {FT}</code></pre><p>Compute the expression for saturated thermal conductivity of soil matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L161-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.κ_dry" href="#ClimaLand.Soil.κ_dry"><code>ClimaLand.Soil.κ_dry</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function κ_dry(ρp::FT,
               ν::FT,
               κ_solid::FT,
               κ_air::FT;
               a = FT(0.053)) where {FT}</code></pre><p>Computes the thermal conductivity of dry soil according to the model of Balland and Arp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L305-L314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.kersten_number" href="#ClimaLand.Soil.kersten_number"><code>ClimaLand.Soil.kersten_number</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kersten_number(
    θ_i::FT,
    S_r::FT,
    α::FT,
    β::FT,
    ν_ss_om::FT,
    ν_ss_quartz::FT,
    ν_ss_gravel::FT,
    ) where {FT}</code></pre><p>Compute the expression for the Kersten number, using the Balland and Arp model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L215-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.relative_saturation" href="#ClimaLand.Soil.relative_saturation"><code>ClimaLand.Soil.relative_saturation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">relative_saturation(
        θ_l::FT,
        θ_i::FT,
        ν::FT
) where {FT}</code></pre><p>Compute the expression for relative saturation.  This is referred to as θ_sat in Balland and Arp&#39;s paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L201-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.volumetric_internal_energy" href="#ClimaLand.Soil.volumetric_internal_energy"><code>ClimaLand.Soil.volumetric_internal_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volumetric_internal_energy(θ_i::FT, ρc_s::FT, T::FT,
                             earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the volumetric internal energy of the soil, given the volumetric ice content, volumetric heat capacity, and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L122-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.volumetric_internal_energy_liq" href="#ClimaLand.Soil.volumetric_internal_energy_liq"><code>ClimaLand.Soil.volumetric_internal_energy_liq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volumetric_internal_energy_liq(T::FT, earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the volumetric internal energy of the liquid water in the soil, given the temperature T.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L142-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.temperature_from_ρe_int" href="#ClimaLand.Soil.temperature_from_ρe_int"><code>ClimaLand.Soil.temperature_from_ρe_int</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_from_ρe_int(ρe_int::FT, θ_i::FT, ρc_s::FT
                        earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the temperature from the volumetric internal energy, volumetric ice content, and volumetric heat capacity of the soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L100-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.thermal_conductivity" href="#ClimaLand.Soil.thermal_conductivity"><code>ClimaLand.Soil.thermal_conductivity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_conductivity(
    κ_dry::FT,
    K_e::FT,
    κ_sat::FT
) where {FT}</code></pre><p>Compute the expression for thermal conductivity of soil matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L186-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.phase_change_source" href="#ClimaLand.Soil.phase_change_source"><code>ClimaLand.Soil.phase_change_source</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phase_change_source(
    θ_l::FT,
    θ_i::FT,
    T::FT,
    τ::FT,
    ν::FT,
    θ_r::FT,
    hydrology_cm::C,
    earth_param_set::EP,
) where {FT, EP, C}</code></pre><p>Returns the source term (1/s) used for converting liquid water and ice into each other during phase changes. Note that there are unitless prefactors multiplying this term in the  equations.</p><p>Note that these equations match what is in Dall&#39;Amico (for θstar, ψ(T), ψw0). We should double check them in the case where we have ϑ<em>l &gt; θ</em>l, but they should be very close to the form we want regardless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L26-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.thermal_time" href="#ClimaLand.Soil.thermal_time"><code>ClimaLand.Soil.thermal_time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_time(ρc::FT, Δz::FT, κ::FT) where {FT}</code></pre><p>Returns the thermal timescale for temperature differences across a typical thickness Δz to equilibrate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/soil_heat_parameterizations.jl#L16-L21">source</a></section></article><h2 id="Soil-Runoff-Types-and-Methods"><a class="docs-heading-anchor" href="#Soil-Runoff-Types-and-Methods">Soil Runoff Types and Methods</a><a id="Soil-Runoff-Types-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Runoff-Types-and-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.NoRunoff" href="#ClimaLand.Soil.Runoff.NoRunoff"><code>ClimaLand.Soil.Runoff.NoRunoff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoRunoff &lt;: AbstractRunoffModel</code></pre><p>A concrete type of soil runoff model; the  default choice, which does not include any runoff.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L50-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.SurfaceRunoff" href="#ClimaLand.Soil.Runoff.SurfaceRunoff"><code>ClimaLand.Soil.Runoff.SurfaceRunoff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceRunoff &lt;: AbstractRunoffModel</code></pre><p>A simple model for runoff appropriate for single column runs.</p><p>Only surface runoff is computed, using a combination of Dunne  and Hortonian runoff.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L77-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.TOPMODELRunoff" href="#ClimaLand.Soil.Runoff.TOPMODELRunoff"><code>ClimaLand.Soil.Runoff.TOPMODELRunoff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TOPMODELRunoff{FT &lt;: AbstractFloat, F &lt;: ClimaCore.Fields.Field} &lt;: AbstractRunoffModel</code></pre><p>The TOPMODEL surface runoff parameterization, which is affects the surface boundary condition of the soil model.</p><p>The runoff flux is given by Equation 8 of with fsat given by Equation (11), of Niu et al. (2005), &quot;A simple TOPMODEL-based runoff parameterization (SIMTOP) for use in global climate models&quot;.</p><ul><li><p><code>f_over</code>: A calibrated parameter defining how subsurface runoff decays with depth to water table (1/m ; calibrated)</p></li><li><p><code>f_max</code>: The maximum saturated fraction of a grid cell, computed from the topographic index CDF per grid cell.</p></li><li><p><code>subsurface_source</code>: The subsurface source term corresponding to this implementation of TOPMODEL.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L178-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.TOPMODELSubsurfaceRunoff" href="#ClimaLand.Soil.Runoff.TOPMODELSubsurfaceRunoff"><code>ClimaLand.Soil.Runoff.TOPMODELSubsurfaceRunoff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TOPMODELSubsurfaceRunoff{FT} &lt;: AbstractSoilSource{FT}</code></pre><p>The TOPMODEL subsurface runoff parameterization, which is implemented as a sink term in the soil equations.</p><p>The runoff flux is given by Equation 12 of Niu et al. (2005), &quot;A simple TOPMODEL-based runoff parameterization (SIMTOP) for use in global climate models&quot;.</p><ul><li><p><code>R_sb</code>: The subsurface runoff flux (m/s) when the depth to the water table = 1/f_over; calibrated</p></li><li><p><code>f_over</code>: A calibrated parameter defining how subsurface runoff decays with depth to water table (1/m ; calibrated)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L159-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.subsurface_runoff_source" href="#ClimaLand.Soil.Runoff.subsurface_runoff_source"><code>ClimaLand.Soil.Runoff.subsurface_runoff_source</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subsurface_runoff_source(runoff::AbstractRunoffModel)</code></pre><p>A helper function which returns the subsurface source of the runoff model <code>runoff</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.Runoff.update_runoff!" href="#ClimaLand.Soil.Runoff.update_runoff!"><code>ClimaLand.Soil.Runoff.update_runoff!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_runoff!(p, runoff::NoRunoff, input, _...)</code></pre><p>Updates the runoff variables in the cache <code>p.soil</code> in place in the case of NoRunoff: sets infiltration = precipitation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L63-L68">source</a></section><section><div><pre><code class="language-julia hljs">update_runoff!(
    p,
    runoff::SurfaceRunoff,
    input,
    Y,
    t,
    model::AbstractSoilModel,</code></pre><p>)</p><p>The update_runoff! function for the SurfaceRunoff model.</p><p>Updates the runoff model variables in place in <code>p.soil</code> for the SurfaceRunoff  parameterization: p.soil.R<em>s p.soil.is</em>saturated p.soil.infiltration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L111-L128">source</a></section><section><div><pre><code class="language-julia hljs">update_runoff!(p, runoff::TOPMODELRunoff, input, Y,t, model::AbstractSoilModel)</code></pre><p>Updates the runoff model variables in place in <code>p.soil</code> for the TOPMODELRunoff parameterization: p.soil.R<em>s p.soil.R</em>ss p.soil.h∇ p.soil.infiltration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Runoff/Runoff.jl#L207-L216">source</a></section></article><h2 id="Soil-BC-Methods-and-Types"><a class="docs-heading-anchor" href="#Soil-BC-Methods-and-Types">Soil BC Methods and Types</a><a id="Soil-BC-Methods-and-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-BC-Methods-and-Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.MoistureStateBC" href="#ClimaLand.Soil.MoistureStateBC"><code>ClimaLand.Soil.MoistureStateBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>MoistureStateBC &lt;: AbstractWaterBC</p><p>A simple concrete type of boundary condition, which enforces a state boundary condition ϑ_l = f(p,t) at either the top or bottom of the domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.HeatFluxBC" href="#ClimaLand.Soil.HeatFluxBC"><code>ClimaLand.Soil.HeatFluxBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>HeatFluxBC &lt;: AbstractHeatBC</p><p>A simple concrete type of boundary condition, which enforces a normal flux boundary condition f(p,t) at either the top or bottom of the domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L438-L443">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.WaterFluxBC" href="#ClimaLand.Soil.WaterFluxBC"><code>ClimaLand.Soil.WaterFluxBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>WaterFluxBC &lt;: AbstractWaterBC</p><p>A simple concrete type of boundary condition, which enforces a normal flux boundary condition f(p,t) at either the top or bottom of the domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L39-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.TemperatureStateBC" href="#ClimaLand.Soil.TemperatureStateBC"><code>ClimaLand.Soil.TemperatureStateBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>TemperatureStateBC &lt;: AbstractHeatBC</p><p>A simple concrete type of boundary condition, which enforces a state boundary condition T = f(p,t) at either the top or bottom of the domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L428-L433">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.FreeDrainage" href="#ClimaLand.Soil.FreeDrainage"><code>ClimaLand.Soil.FreeDrainage</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FreeDrainage &lt;: AbstractWaterBC</code></pre><p>A concrete type of soil boundary condition, for use at the BottomBoundary only, where the flux is set to be <code>F = -K∇h = -K</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.RichardsAtmosDrivenFluxBC" href="#ClimaLand.Soil.RichardsAtmosDrivenFluxBC"><code>ClimaLand.Soil.RichardsAtmosDrivenFluxBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>RichardsAtmosDrivenFluxBC{F &lt;: PrescribedPrecipitation, R &lt;: AbstractRunoffModel} &lt;: AbstractWaterBC</p><p>A concrete type of boundary condition intended only for use with the RichardsModel, which uses a prescribed precipitation rate (m/s) to compute the infiltration into the soil.</p><p>A runoff model is used to simulate surface and subsurface runoff and this is accounted for when setting boundary conditions. In order to run the simulation <em>without</em> runoff, choose runoff = NoRunoff() - this is also the default.</p><p>If you wish to simulate precipitation and runoff in the full <code>EnergyHydrology</code> model, you must use the <code>AtmosDrivenFluxBC</code> type.</p><ul><li><p><code>precip</code>: The prescribed liquid water precipitation rate f(t) (m/s); Negative by convention.</p></li><li><p><code>runoff</code>: The runoff model. The default is no runoff.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L58-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.AtmosDrivenFluxBC" href="#ClimaLand.Soil.AtmosDrivenFluxBC"><code>ClimaLand.Soil.AtmosDrivenFluxBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AtmosDrivenFluxBC{
    A &lt;: AbstractAtmosphericDrivers,
    B &lt;: AbstractRadiativeDrivers,
    R &lt;: AbstractRunoffModel,
    C::Tuple
} &lt;: AbstractEnergyHydrologyBC</code></pre><p>A concrete type of soil boundary condition for use at the top of the domain. This holds the conditions for the atmosphere <code>AbstractAtmosphericDrivers</code>, for the radiation state <code>AbstractRadiativeDrivers</code>. This is only supported for the <code>EnergyHydrology</code> model.</p><p>This choice indicates the Monin-Obukhov Surface Theory will be used to compute the sensible and latent heat fluxes, as well as evaporation,  and that the net radiation and precipitation will also be computed. The net energy and water fluxes are used as boundary conditions.</p><p>A runoff model is used to simulate surface and subsurface runoff and this is accounted for when setting boundary conditions. The default is to have no runoff accounted for.</p><p>Finally, because this same boundary condition type is used for the soil in integrated land surface models, we also provide a tuple of symbols indicating the prognostic land components present, as these affect how the boundary conditions are computed. The default is a tuple containing only (:soil,), indicating a standalone soil run.</p><p>For more information on the allowed values, please see the <a href="https://clima.github.io/ClimaLand.jl/dev/generated/integrated/handling_soil_fluxes">documentation</a></p><ul><li><p><code>atmos</code>: The atmospheric conditions driving the model</p></li><li><p><code>radiation</code>: The radiative fluxes driving the model</p></li><li><p><code>runoff</code>: The runoff model. The default is no runoff.</p></li><li><p><code>prognostic_land_components</code>: Prognostic land components present</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L569-L604">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.WaterHeatBC" href="#ClimaLand.Soil.WaterHeatBC"><code>ClimaLand.Soil.WaterHeatBC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WaterHeatBC{W &lt;: AbstractWaterBC, H &lt;: AbstractHeatBC} &lt;:
   AbstractEnergyHydrologyBC</code></pre><p>A general struct used to store the boundary conditions for Richards and the soil heat equations separately; useful when the boundary conditions for each component are independent of each other.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L552-L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.soil_boundary_fluxes!" href="#ClimaLand.Soil.soil_boundary_fluxes!"><code>ClimaLand.Soil.soil_boundary_fluxes!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">soil_boundary_fluxes!(bc::WaterHeatBC, boundary::AbstractBoundary, model, Δz, Y, p, t)</code></pre><p>updates the boundary fluxes for ϑ<em>l and ρe</em>int.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L663-L667">source</a></section><section><div><pre><code class="language-julia hljs">soil_boundary_fluxes!(
    bc::AtmosDrivenFluxBC{
        &lt;:PrescribedAtmosphere,
        &lt;:PrescribedRadiativeFluxes,
    },
    boundary::ClimaLand.TopBoundary,
    model::EnergyHydrology,
    Δz,
    Y,
    p,
    t,
)</code></pre><p>Returns the net volumetric water flux (m/s) and net energy flux (W/m^2) for the soil <code>EnergyHydrology</code> model at the top of the soil domain.</p><p>This function calls the <code>turbulent_fluxes</code> and <code>net_radiation</code> functions, which use the soil surface conditions as well as the atmos and radiation conditions in order to compute the surface fluxes using Monin Obukhov Surface Theory. It also accounts for the presence of other components, if run as part of an integrated land model, and their effect on boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L748-L772">source</a></section><section><div><pre><code class="language-julia hljs">soil_boundary_fluxes!(
    bc::AtmosDrivenFluxBC{
        &lt;:PrescribedAtmosphere,
        &lt;:PrescribedRadiativeFluxes,
    },
    prognostic_land_components::Val{(:soil,)},
    model::EnergyHydrology,
    Y,
    p,
    t,
)</code></pre><p>Returns the net volumetric water flux (m/s) and net energy flux (W/m^2) for the soil <code>EnergyHydrology</code> model at the top of the soil domain.</p><p>Here, the soil boundary fluxes are computed as if the soil is run in standalone mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/boundary_conditions.jl#L786-L805">source</a></section><section><div><pre><code class="language-julia hljs">soil_boundary_fluxes!(
    bc::AtmosDrivenFluxBC{&lt;:PrescribedAtmosphere, &lt;:PrescribedRadiativeFluxes},
    prognostic_land_components::Val{(:canopy, :soil,:soilco2,)},
    soil::EnergyHydrology{FT},
    Y,
    p,
    t,
) where {FT}</code></pre><p>A method of <code>ClimaLand.Soil.soil_boundary_fluxes!</code> which is used for integrated land surface models; this computes and returns the net energy and water flux at the surface of the soil for use as boundary conditions when a canopy and Soil CO2  model is also included, though only the presence of the canopy modifies the soil BC.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/integrated/soil_canopy_model.jl#L439-L454">source</a></section><section><div><pre><code class="language-julia hljs">soil_boundary_fluxes!(
    bc::AtmosDrivenFluxBC{&lt;:PrescribedAtmosphere, &lt;:PrescribedRadiativeFluxes},
     prognostic_land_components::Val{(:snow, :soil)},
    soil::EnergyHydrology{FT},
    Y,
    p,
    t,
) where {FT}</code></pre><p>A method of <code>ClimaLand.Soil.soil_boundary_fluxes!</code> which is used for integrated land surface models; this computes and returns the net energy and water flux at the surface of the soil for use as boundary conditions, taking into account the presence of snow on the surface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/integrated/soil_snow_model.jl#L368-L382">source</a></section></article><h2 id="Soil-Source-Types"><a class="docs-heading-anchor" href="#Soil-Source-Types">Soil Source Types</a><a id="Soil-Source-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Source-Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.AbstractSoilSource" href="#ClimaLand.Soil.AbstractSoilSource"><code>ClimaLand.Soil.AbstractSoilSource</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSoilSource{FT} &lt;:  ClimaLand.AbstractSource{FT}</code></pre><p>An abstract type for types of source terms for the soil equations.</p><p>In standalone mode, the only supported source type is freezing and thawing. ClimaLand.jl creates additional sources to include as necessary e.g. root extraction (not available in stand alone mode).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/Soil.jl#L107-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Soil.PhaseChange" href="#ClimaLand.Soil.PhaseChange"><code>ClimaLand.Soil.PhaseChange</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhaseChange{FT} &lt;: AbstractSoilSource{FT}</code></pre><p>PhaseChange source type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/standalone/Soil/energy_hydrology.jl#L579-L583">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ClimaLand.Soil.RootExtraction</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Soil-Jacobian-Structures"><a class="docs-heading-anchor" href="#Soil-Jacobian-Structures">Soil Jacobian Structures</a><a id="Soil-Jacobian-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Jacobian-Structures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.ImplicitEquationJacobian" href="#ClimaLand.ImplicitEquationJacobian"><code>ClimaLand.ImplicitEquationJacobian</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImplicitEquationJacobian{M, S}</code></pre><p>A struct containing the necessary information for constructing a block Jacobian matrix used for implicit timestepping.</p><p><code>matrix</code> is a block matrix containing one block on the diagonal for each     variable in the model. <code>solver</code> is a diagonal solver because our matrix is block diagonal.</p><p>Note that the diagonal, upper diagonal, and lower diagonal entry values are stored in this struct and updated in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/37e345029af40c3bf7bd01494ceeb71c06589611/src/shared_utilities/implicit_timestepping.jl#L73-L85">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../shared_utilities/">« Shared Utilities</a><a class="docs-footer-nextpage" href="../SoilBiogeochemistry/">Soil Biogeochemistry »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 19 October 2024 01:01">Saturday 19 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
