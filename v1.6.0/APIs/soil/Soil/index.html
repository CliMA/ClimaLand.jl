<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Soil Energy and Hydrology · ClimaLand.jl</title><meta name="title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta property="og:title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta property="twitter:title" content="Soil Energy and Hydrology · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../fundamental_concepts/">Fundamental Concepts</a></li><li><a class="tocitem" href="../../../getting_started/">Running your first simulation</a></li><li><a class="tocitem" href="../../../available_models/">Available Models and Parameterizations</a></li><li><a class="tocitem" href="../../../parameters/">Parameters</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-3" type="checkbox"/><label class="tocitem" for="menuitem-6-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Writing and accessing outputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-2" type="checkbox"/><label class="tocitem" for="menuitem-8-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-3" type="checkbox"/><label class="tocitem" for="menuitem-8-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-4" type="checkbox"/><label class="tocitem" for="menuitem-8-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/plant_hydraulics/prognostic/">Prognostic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-5" type="checkbox"/><label class="tocitem" for="menuitem-8-1-5"><span class="docs-label">Solar Induced Fluorescence</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/solar_induced_fluorescence/lee_model/">Lee model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-6" type="checkbox"/><label class="tocitem" for="menuitem-8-1-6"><span class="docs-label">Canopy structure</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/canopy_structure/prescribed_structure/">Prescribed structure</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/canopy_structure/optimal_lai/">Optimal LAI</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-7" type="checkbox"/><label class="tocitem" for="menuitem-8-1-7"><span class="docs-label">Canopy energy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/canopy_energy/canopy_energy/">Physics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-8" type="checkbox"/><label class="tocitem" for="menuitem-8-1-8"><span class="docs-label">Canopy energy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/turbulent_fluxes/turbulent_fluxes/">Physics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-9" type="checkbox"/><label class="tocitem" for="menuitem-8-1-9"><span class="docs-label">Soil moisture stress</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/soil_moisture_stress/piecewise_model/">Piecewise model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/soil_moisture_stress/tuzet_model/">Tuzet model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/soil_moisture_stress/no_moisture_stress/">No moisture stress</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-10" type="checkbox"/><label class="tocitem" for="menuitem-8-1-10"><span class="docs-label">Autotrophic respiration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/autotrophic_respiration/jules_model/">JULES model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-2-1" type="checkbox"/><label class="tocitem" for="menuitem-8-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Calibration and benchmark</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../calibration/">Calibrating model parameters</a></li><li><a class="tocitem" href="../../../leaderboard/leaderboard/">Model Benchmark</a></li></ul></li><li><a class="tocitem" href="../../../architectures/">Running on GPU or with MPI</a></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../repo_structure/">Repository structure</a></li><li><a class="tocitem" href="../../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../itime/">ITime type</a></li><li><a class="tocitem" href="../../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../../physical_units/">Physical units</a></li></ul></li><li><a class="tocitem" href="../../../julia/">Julia background</a></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox" checked/><label class="tocitem" for="menuitem-13"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-13-1" type="checkbox" checked/><label class="tocitem" for="menuitem-13-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Soil Energy and Hydrology</a><ul class="internal"><li><a class="tocitem" href="#Soil-Models-2"><span>Soil Models</span></a></li><li><a class="tocitem" href="#Soil-Parameter-Structs"><span>Soil Parameter Structs</span></a></li><li><a class="tocitem" href="#Soil-Hydrology-Parameterizations"><span>Soil Hydrology Parameterizations</span></a></li><li><a class="tocitem" href="#Soil-Heat-Parameterizations"><span>Soil Heat Parameterizations</span></a></li></ul></li><li><a class="tocitem" href="../SoilSourcesandBCs/">Soil Sources and Boundary Conditions</a></li><li><a class="tocitem" href="../SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-2" type="checkbox"/><label class="tocitem" for="menuitem-13-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../../canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../../canopy/Biomass/">Leaf, stem, root dynamics</a></li><li><a class="tocitem" href="../../canopy/LAI/">Optimal LAI</a></li><li><a class="tocitem" href="../../canopy/Photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../../canopy/RadiativeTransfer/">Radiative Transfer</a></li><li><a class="tocitem" href="../../canopy/CanopyEnergy/">Energy</a></li><li><a class="tocitem" href="../../canopy/StomatalConductance/">Stomatal Conductance</a></li><li><a class="tocitem" href="../../canopy/AutotrophicRespiration/">Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../Snow/">Snow Model</a></li><li><a class="tocitem" href="../../ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-13-7" type="checkbox"/><label class="tocitem" for="menuitem-13-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../../AuxiliaryVariablesCache/">Auxiliary Variables Cache</a></li><li><a class="tocitem" href="../../Callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../Domains/">Domains</a></li><li><a class="tocitem" href="../../Drivers/">Drivers</a></li><li><a class="tocitem" href="../../Simulations/">Simulations</a></li><li><a class="tocitem" href="../../SolverFunctions/">Solver Functions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributor guide</a></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">APIs</a></li><li><a class="is-disabled">Soil</a></li><li class="is-active"><a href>Soil Energy and Hydrology</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Soil Energy and Hydrology</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/APIs/soil/Soil.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Soil-Models"><a class="docs-heading-anchor" href="#Soil-Models">Soil Models</a><a id="Soil-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Models" title="Permalink"></a></h1><h2 id="Soil-Models-2"><a class="docs-heading-anchor" href="#Soil-Models-2">Soil Models</a><a class="docs-heading-anchor-permalink" href="#Soil-Models-2" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.AbstractSoilModel"><a class="docstring-binding" href="#ClimaLand.Soil.AbstractSoilModel"><code>ClimaLand.Soil.AbstractSoilModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractSoilModel{FT} &lt;: ClimaLand.AbstractImExModel{FT}</code></pre><p>The abstract type for all soil models.</p><p>Currently, we only have plans to support a RichardsModel, simulating the flow of liquid water through soil via the Richardson-Richards equation, and a fully integrated soil heat and water model, with phase change.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/Soil.jl#L130-L138">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.RichardsModel"><a class="docstring-binding" href="#ClimaLand.Soil.RichardsModel"><code>ClimaLand.Soil.RichardsModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RichardsModel</code></pre><p>A model for simulating the flow of water in a porous medium by solving the Richardson-Richards Equation.</p><p>A variety of boundary condition types are supported, including <code>FluxBC</code>, <code>RichardsAtmosDrivenFluxBC</code>, <code>MoistureStateBC</code>, and <code>FreeDrainage</code> (only for the bottom of the domain).</p><p>If you wish to simulate soil hydrology under the context of a prescribed precipitation volume flux (m/s) as a function of time, the <code>RichardsAtmosDrivenFluxBC</code> type should be chosen. Please see the documentation for more details.</p><ul><li><p><code>parameters</code>: the parameter set</p></li><li><p><code>domain</code>: the soil domain, using ClimaCore.Domains</p></li><li><p><code>boundary_conditions</code>: the boundary conditions, of type AbstractSoilBoundaryConditions</p></li><li><p><code>sources</code>: A tuple of sources, each of type AbstractSoilSource</p></li><li><p><code>lateral_flow</code>: A boolean flag which, when false, turns off the horizontal flow of water</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/rre.jl#L50-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.RichardsModel-Union{Tuple{}, Tuple{D}, Tuple{FT}} where {FT, D}"><a class="docstring-binding" href="#ClimaLand.Soil.RichardsModel-Union{Tuple{}, Tuple{D}, Tuple{FT}} where {FT, D}"><code>ClimaLand.Soil.RichardsModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">RichardsModel{FT}(;
    parameters::RichardsParameters,
    domain::D,
    boundary_conditions::NamedTuple,
    sources::Tuple,
    lateral_flow::Bool = true
) where {FT, D}</code></pre><p>A constructor for a <code>RichardsModel</code>, which sets the default value of <code>lateral_flow</code> to be true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/rre.jl#L80-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.RichardsModel-Union{Tuple{FT}, Tuple{Any, Any}} where FT"><a class="docstring-binding" href="#ClimaLand.Soil.RichardsModel-Union{Tuple{FT}, Tuple{Any, Any}} where FT"><code>ClimaLand.Soil.RichardsModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">RichardsModel{FT}(domain, forcing;
                     runoff =  ClimaLand.Soil.Runoff.TOPMODELRunoff{FT}(f_over = FT(3.28),
                                                                        R_sb = FT(1.484e-4 / 1000),
                                                                        f_max = topmodel_fmax(domain.space.surface,FT),
                                                                        ),
                     retention_parameters = soil_vangenuchten_parameters(domain.space.subsurface, FT),
                     S_s = ClimaCore.Fields.zeros(domain.space.subsurface) .+ 1e-3,
                     )</code></pre><p>Creates a RichardsModel model with the given float type <code>FT</code>, <code>domain</code> and <code>forcing</code>. Here, <code>forcing</code> should be a <code>NamedTuple</code> containing a field <code>atmos</code> with the atmospheric forcing.</p><p>Default spatially varying parameters (for retention curve parameters and specific storativity) are provided but can be changed with keyword arguments.</p><p>The runoff parameterization is also provided and can be changed via keyword argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/Soil.jl#L320-L337">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.EnergyHydrology"><a class="docstring-binding" href="#ClimaLand.Soil.EnergyHydrology"><code>ClimaLand.Soil.EnergyHydrology</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">EnergyHydrology &lt;: AbstractSoilModel</code></pre><p>A model for simulating the flow of water and heat in a porous medium by solving the Richardson-Richards equation and the heat equation, including terms for phase change.</p><p>A variety of boundary condition types are supported, including <code>FluxBC</code>, <code>MoistureStateBC</code>/<code>TemperatureStateBC</code>, <code>FreeDrainage</code> (only for the bottom of the domain), and an <code>AtmosDrivenFluxBC</code> (under which radiative fluxes and turbulent surface fluxes are computed and used as boundary conditions). Please see the documentation for this boundary condition type for more details.</p><ul><li><p><code>parameters</code>: The parameter sets</p></li><li><p><code>domain</code>: the soil domain, using ClimaCore.Domains</p></li><li><p><code>boundary_conditions</code>: the boundary conditions for RRE and heat, of type AbstractSoilBoundaryConditions</p></li><li><p><code>sources</code>: A tuple of sources, each of type AbstractSoilSource</p></li><li><p><code>lateral_flow</code>: A boolean flag which, when false, turns off the horizontal flow of water and heat</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/energy_hydrology.jl#L201-L217">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.EnergyHydrology-Union{Tuple{}, Tuple{PSE}, Tuple{D}, Tuple{FT}} where {FT, D, PSE}"><a class="docstring-binding" href="#ClimaLand.Soil.EnergyHydrology-Union{Tuple{}, Tuple{PSE}, Tuple{D}, Tuple{FT}} where {FT, D, PSE}"><code>ClimaLand.Soil.EnergyHydrology</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">EnergyHydrology{FT}(;
    parameters::PS
    domain::D,
    boundary_conditions::NamedTuple,
    sources::Tuple,
    lateral_flow::Bool = false,
) where {FT, D, PS}</code></pre><p>A constructor for a <code>EnergyHydrology</code> model, which sets the default value of the <code>lateral_flow</code> flag to false.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/energy_hydrology.jl#L231-L242">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.EnergyHydrology-Union{Tuple{FT}, Tuple{Any, Any, ClimaParams.ParamDict}} where FT&lt;:AbstractFloat"><a class="docstring-binding" href="#ClimaLand.Soil.EnergyHydrology-Union{Tuple{FT}, Tuple{Any, Any, ClimaParams.ParamDict}} where FT&lt;:AbstractFloat"><code>ClimaLand.Soil.EnergyHydrology</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">EnergyHydrology{FT}(domain, forcing, toml_dict::CP.ParamDict;
                     prognostic_land_components = (:soil),
                     albedo = CLMTwoBandSoilAlbedo{FT}(; clm_soil_albedo_parameters(domain.space.surface)...),
                     runoff::Runoff.AbstractRunoffModel = Runoff.TOPMODELRunoff(toml_dict,
                                                            f_max = topmodel_fmax(domain.space.surface, FT),
                                                        ),
                     retention_parameters = soil_vangenuchten_parameters(domain.space.subsurface, FT),
                     composition_parameters = soil_composition_parameters(domain.space.subsurface, FT),
                     S_s = ClimaCore.Fields.zeros(domain.space.subsurface) .+ 1e-3,
                     z_0m = toml_dict[&quot;soil_momentum_roughness_length&quot;],
                     z_0b = toml_dict[&quot;soil_scalar_roughness_length&quot;],
                     emissivity = toml_dict[&quot;emissivity_bare_soil&quot;],
                     additional_sources = (),
                     bottom_bc =
                         WaterHeatBC(; water = WaterFluxBC((p, t) -&gt; 0.0), heat = HeatFluxBC((p, t) -&gt; 0.0)),
                     ) where {FT &lt;: AbstractFloat}</code></pre><p>Creates a EnergyHydrology model with the given float type <code>FT</code>, <code>domain</code>, <code>toml_dict</code>, <code>forcing</code>, and prognostic land components.</p><p>The argument <code>forcing</code> should be a NamedTuple containing two fields: <code>atmos</code> and <code>radiation</code>.</p><p>When running the soil model in standalone mode, <code>prognostic_land_components = (:soil,)</code>, while for running integrated land models, this should be a list of the component models. This value of this argument must be the same across all components in the land model.</p><p>Default spatially varying parameters (for retention curve parameters, composition, and specific storativity) are provided but can be changed with keyword arguments. Note that these parameters must all be of the same type: either <code>FT</code> or ClimaCore Fields. By default they are Fields read in from data, so in practice this means if some values are provided as Floats, all of these parameter defaults must be overwritten as Floats.</p><p><code>retention_parameters</code> should be a NamedTuple with the following fields:</p><ul><li><code>ν</code>: soil porosity</li><li><code>hydrology_cm</code>: the hydrology closure model being used</li><li><code>K_sat</code>: saturated hydraulic conductivity</li><li><code>θ_r</code>: residual water content</li></ul><p><code>composition_parameters</code> should be a NamedTuple with the following fields:</p><ul><li><code>ν_ss_om</code>: soil organic matter volume fraction</li><li><code>ν_ss_quartz</code>: soil quartz volume fraction</li><li><code>ν_ss_gravel</code>: soil gravel volume fraction</li></ul><p>The runoff and albedo parameterizations are also provided and can be changed via keyword argument; additional sources may be required in your model if the soil model will be composed with other component models.</p><p>Roughness lengths and soil emissivity are currently treated as constants; these can be passed in as Floats by kwarg; otherwise the default values are used.</p><p>This sets the bottom boundary conditions to be no flux by default, but these can be changed using the  <code>bottom_bc</code> kwarg.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/Soil.jl#L204-L259">source</a></section></details></article><h2 id="Soil-Parameter-Structs"><a class="docs-heading-anchor" href="#Soil-Parameter-Structs">Soil Parameter Structs</a><a id="Soil-Parameter-Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Parameter-Structs" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.RichardsParameters"><a class="docstring-binding" href="#ClimaLand.Soil.RichardsParameters"><code>ClimaLand.Soil.RichardsParameters</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RichardsParameters{F &lt;: Union{&lt;: AbstractFloat, ClimaCore.Fields.Field}, C &lt;: AbstractSoilHydrologyClosure}</code></pre><p>A struct for storing parameters of the <code>RichardsModel</code>.</p><ul><li><p><code>ν</code>: The porosity of the soil (m^3/m^3)</p></li><li><p><code>hydrology_cm</code>: The hydrology closure model: vanGenuchten or BrooksCorey</p></li><li><p><code>K_sat</code>: The saturated hydraulic conductivity (m/s)</p></li><li><p><code>S_s</code>: The specific storativity (1/m)</p></li><li><p><code>θ_r</code>: The residual water fraction (m^3/m^3)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/rre.jl#L1-L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.RichardsParameters-Tuple{}"><a class="docstring-binding" href="#ClimaLand.Soil.RichardsParameters-Tuple{}"><code>ClimaLand.Soil.RichardsParameters</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">RichardsParameters(;
    hydrology_cm::C,
    ν::F,
    K_sat::F,
    S_s::F,
    θ_r::F,
) where {F &lt;: Union{&lt;:AbstractFloat, ClimaCore.Fields.Field}, C}</code></pre><p>Construct a <code>RichardsParameters</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/rre.jl#L23-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.EnergyHydrologyParameters"><a class="docstring-binding" href="#ClimaLand.Soil.EnergyHydrologyParameters"><code>ClimaLand.Soil.EnergyHydrologyParameters</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">EnergyHydrologyParameters{
        FT &lt;: AbstractFloat,
        F &lt;: Union{&lt;:AbstractFloat, ClimaCore.Fields.Field},
        AP,
        C,
        PSE,
    }</code></pre><p>A parameter structure for the integrated soil water and energy  equation system.</p><ul><li>soil composition and retention model parameters defined in the interior</li><li>an albedo parameterization</li><li>Scalar parameters: emissivity, α, β, γ, γT_ref, Ω,</li></ul><p>roughness lengths z<em>0, d</em>ds ) (FT)</p><ul><li><p><code>κ_dry</code>: The dry soil thermal conductivity, W/m/K</p></li><li><p><code>κ_sat_frozen</code>: The saturated thermal conductivity of frozen soil, W/m/K</p></li><li><p><code>κ_sat_unfrozen</code>: The saturated thermal conductivity of unfrozen soil, W/m/K</p></li><li><p><code>ρc_ds</code>: The volumetric heat capacity of dry soil, J/m^3/K (per volume dry soil, not per volume soil solids)</p></li><li><p><code>ν</code>: The porosity of the soil (m^3/m^3)</p></li><li><p><code>ν_ss_om</code>: The volumetric fraction of the soil solids in organic matter (m^3/m^3)</p></li><li><p><code>ν_ss_quartz</code>: The volumetric fraction of the soil solids in quartz (m^3/m^3)</p></li><li><p><code>ν_ss_gravel</code>: The volumetric fraction of the soil solids in gravel (m^3/m^3)</p></li><li><p><code>α</code>: The parameter α used in computing Kersten number, unitless</p></li><li><p><code>β</code>: The parameter β used in computing Kersten number, unitless</p></li><li><p><code>hydrology_cm</code>: The soil hydrology closure model: van Genuchten or Brooks and Corey</p></li><li><p><code>K_sat</code>: The saturated hydraulic conductivity (m/s)</p></li><li><p><code>S_s</code>: The specific storativity (1/m)</p></li><li><p><code>θ_r</code>: The residual water fraction (m^3/m^3)</p></li><li><p><code>Ω</code>: Ice impedance factor for the hydraulic conductivity</p></li><li><p><code>γ</code>: Coefficient of viscosity factor for the hydraulic conductivity</p></li><li><p><code>γT_ref</code>: Reference temperature for the viscosity factor</p></li><li><p><code>albedo</code>: Soil Albedo Parameterization</p></li><li><p><code>emissivity</code>: Soil Emissivity</p></li><li><p><code>z_0m</code>: Roughness length for momentum</p></li><li><p><code>z_0b</code>: Roughness length for scalars</p></li><li><p><code>d_ds</code>: Maximum dry soil layer thickness under evaporation (m)</p></li><li><p><code>earth_param_set</code>: Physical constants and clima-wide parameters</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/energy_hydrology.jl#L1-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.EnergyHydrologyParameters-Union{Tuple{Type{FT}}, Tuple{FT}} where FT&lt;:AbstractFloat"><a class="docstring-binding" href="#ClimaLand.Soil.EnergyHydrologyParameters-Union{Tuple{Type{FT}}, Tuple{FT}} where FT&lt;:AbstractFloat"><code>ClimaLand.Soil.EnergyHydrologyParameters</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">EnergyHydrologyParameters(
    toml_dict;
    ν,
    ν_ss_om,
    ν_ss_quartz,
    ν_ss_gravel,
    hydrology_cm,
    K_sat,
    S_s,
    θ_r,
    albedo = Soil.ConstantTwoBandSoilAlbedo{FT}(),
    kwargs...,)</code></pre><p>EnergyHydrologyParameters has two constructors: float-type and toml dict based. Additional parameters must be added manually: <code>ν</code>, <code>ν_ss_om</code>, <code>ν_ss_quartz</code>, <code>ν_ss_gravel</code>, <code>hydrology_cm</code><code>,</code>K<em>sat<code>,</code>S</em>s<code>, and</code>θ_r<code>. All parameters can be manually overridden via keyword arguments. Note, however, that certain parameters must have the same type (e.g, if a field is supplied for porosity, it must be supplied for all other parameters defined in the interior of the domain). Some parameters are defined only on the surface of the domain (e.g albedo), while other are defined everywhere (e.g. porosity). These are indicated with types</code>F<code>and</code>SF`. If both dry/wet albedos and general albedos are given as keywords, the dry/wet albedos will override the general albedos.</p><p>Please see the EnergyHydrologyParameters documentation for a complete list.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/energy_hydrology.jl#L79-L105">source</a></section></details></article><h2 id="Soil-Hydrology-Parameterizations"><a class="docs-heading-anchor" href="#Soil-Hydrology-Parameterizations">Soil Hydrology Parameterizations</a><a id="Soil-Hydrology-Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Hydrology-Parameterizations" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.volumetric_liquid_fraction"><a class="docstring-binding" href="#ClimaLand.Soil.volumetric_liquid_fraction"><code>ClimaLand.Soil.volumetric_liquid_fraction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volumetric_liquid_fraction(ϑ_l::FT, ν_eff::FT, θ_r::FT) where {FT}</code></pre><p>A pointwise function returning the volumetric liquid fraction given the augmented liquid fraction and the effective porosity. The output is guaranteed to be in <code>(θ_r, ν_eff]</code>.</p><p>For Richards model, <code>ν_eff = ν</code>; and the clipping below is not required, (and will do nothing; <code>ν_eff_safe = ν_eff</code>), but we leave it in for a simpler interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L11-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.pressure_head"><a class="docstring-binding" href="#ClimaLand.Soil.pressure_head"><code>ClimaLand.Soil.pressure_head</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pressure_head(
    cm::vanGenuchten{FT},
    θ_r::FT,
    ϑ_l::FT,
    ν_eff::FT,
    S_s::FT,
) where {FT}</code></pre><p>A point-wise function returning the pressure head in variably saturated soil, using the van Genuchten matric potential if the soil is not saturated, and an approximation of the positive pressure in the soil if the soil is saturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L94-L108">source</a></section><section><div><pre><code class="language-julia hljs">pressure_head(
    cm::BrooksCorey{FT},
    θ_r::FT,
    ϑ_l::FT,
    ν_eff::FT,
    S_s::FT,
) where {FT}</code></pre><p>A point-wise function returning the pressure head in variably saturated soil, using the Brooks and Corey matric potential if the soil is not saturated, and an approximation of the positive pressure in the soil if the soil is saturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L255-L269">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.hydraulic_conductivity"><a class="docstring-binding" href="#ClimaLand.Soil.hydraulic_conductivity"><code>ClimaLand.Soil.hydraulic_conductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">hydraulic_conductivity(cm::vanGenuchten{FT}, K_sat::FT, S::FT) where {FT}</code></pre><p>A point-wise function returning the hydraulic conductivity, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L155-L160">source</a></section><section><div><pre><code class="language-julia hljs"> hydraulic_conductivity(cm::BrooksCorey{FT}, K_sat::FT, S::FT) where {FT}</code></pre><p>A point-wise function returning the hydraulic conductivity, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L233-L238">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.impedance_factor"><a class="docstring-binding" href="#ClimaLand.Soil.impedance_factor"><code>ClimaLand.Soil.impedance_factor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">impedance_factor(
    f_i::FT,
    Ω::FT
) where {FT}</code></pre><p>Returns the multiplicative factor reducing conductivity when a fraction of ice <code>f_i</code> is present.</p><p>Only for use with the <code>EnergyHydrology</code> model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L292-L301">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.viscosity_factor"><a class="docstring-binding" href="#ClimaLand.Soil.viscosity_factor"><code>ClimaLand.Soil.viscosity_factor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">viscosity_factor(
    T::FT,
    γ::FT,
    γT_ref::FT,
) where {FT}</code></pre><p>Returns the multiplicative factor which accounts for the temperature dependence of the conductivity.</p><p>Only for use with the <code>EnergyHydrology</code> model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L308-L319">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.effective_saturation"><a class="docstring-binding" href="#ClimaLand.Soil.effective_saturation"><code>ClimaLand.Soil.effective_saturation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">effective_saturation(ν_eff::FT, ϑ_l::FT, θr::FT) where {FT}</code></pre><p>A point-wise function computing the effective saturation given the effective porosity, augmented liquid fraction, and residual water fraction as input.</p><p>For Richards model, or any other parameterization where ice is not relevant, ν<em>eff = ν; and the clipping below is not required, (and will do nothing; ν</em>eff<em>safe = ν</em>eff), but we leave it in for a  simpler interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L33-L44">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.matric_potential"><a class="docstring-binding" href="#ClimaLand.Soil.matric_potential"><code>ClimaLand.Soil.matric_potential</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> matric_potential(cm::vanGenuchten{FT}, S::FT) where {FT}</code></pre><p>A point-wise function returning the matric potential, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L53-L58">source</a></section><section><div><pre><code class="language-julia hljs"> matric_potential(cm::BrooksCorey{FT}, S::FT) where {FT}</code></pre><p>A point-wise function returning the matric potential, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L176-L181">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.dψdϑ"><a class="docstring-binding" href="#ClimaLand.Soil.dψdϑ"><code>ClimaLand.Soil.dψdϑ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dψdϑ(cm::vanGenuchten{FT}, ϑ, ν_eff, θ_r, S_s)</code></pre><p>Computes and returns the derivative of the pressure head with respect to <code>ϑ</code> for the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L129-L134">source</a></section><section><div><p>dψdϑ(cm::BrooksCorey{FT}, ϑ, ν<em>eff, θ</em>r, S_s)</p><p>Computes and returns the derivative of the pressure head with respect to ϑ for the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L214-L219">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.inverse_matric_potential"><a class="docstring-binding" href="#ClimaLand.Soil.inverse_matric_potential"><code>ClimaLand.Soil.inverse_matric_potential</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">inverse_matric_potential(cm::vanGenuchten{FT}, ψ::FT) where {FT}</code></pre><p>A point-wise function returning the effective saturation, given the matric potential, using the van Genuchten formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L65-L71">source</a></section><section><div><pre><code class="language-julia hljs">inverse_matric_potential(cm::BrooksCorey{FT}, ψ::FT) where {FT}</code></pre><p>A point-wise function returning the effective saturation, given the matric potential, using the Brooks and Corey formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_hydrology_parameterizations.jl#L188-L194">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.AbstractSoilHydrologyClosure"><a class="docstring-binding" href="#ClimaLand.Soil.AbstractSoilHydrologyClosure"><code>ClimaLand.Soil.AbstractSoilHydrologyClosure</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractSoilHydrologyClosure{FT &lt;: AbstractFloat}</code></pre><p>The abstract type of soil hydrology closure, of which vanGenuchten{FT} and BrooksCorey{FT} are the two supported concrete types.</p><p>To add a new parameterization, methods are required for:</p><ul><li>matric_potential,</li><li>inverse<em>matric</em>potential,</li><li>pressure_head,</li><li>dψdϑ,</li><li>hydraulic_conductivity.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/retention_models.jl#L3-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.vanGenuchten"><a class="docstring-binding" href="#ClimaLand.Soil.vanGenuchten"><code>ClimaLand.Soil.vanGenuchten</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">vanGenuchten{FT} &lt;: AbstractSoilHydrologyClosure{FT}</code></pre><p>The van Genuchten soil hydrology closure, chosen when the hydraulic conductivity and matric potential are modeled using the van Genuchten parameterization (van Genuchten 1980; see also Table 8.2 of G. Bonan 2019).</p><ul><li><p><code>α</code>: The inverse of the air entry potential (1/m)</p></li><li><p><code>n</code>: The van Genuchten pore-size distribution index (unitless)</p></li><li><p><code>m</code>: The van Genuchten parameter m = 1 - 1/n (unitless)</p></li><li><p><code>S_c</code>: A derived parameter: the critical saturation at which capillary flow no longer replenishes the surface</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/retention_models.jl#L20-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.BrooksCorey"><a class="docstring-binding" href="#ClimaLand.Soil.BrooksCorey"><code>ClimaLand.Soil.BrooksCorey</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">BrooksCorey{FT} &lt;: AbstractSoilHydrologyClosure{FT}</code></pre><p>The Brooks and Corey soil hydrology closure, chosen when the hydraulic conductivity and matric potential are modeled using the Brooks and Corey parameterization (Brooks and Corey, 1964, 1966; see also Table 8.2 of G. Bonan 2019).</p><ul><li><p><code>c</code>: The pore-size distribution index (unitless)</p></li><li><p><code>ψb</code>: The air entry matric potential, when S=1 (m)</p></li><li><p><code>S_c</code>: A derived parameter: the critical saturation at which capillary flow no longer replenishes the surface</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/retention_models.jl#L46-L55">source</a></section></details></article><h2 id="Soil-Heat-Parameterizations"><a class="docs-heading-anchor" href="#Soil-Heat-Parameterizations">Soil Heat Parameterizations</a><a id="Soil-Heat-Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Heat-Parameterizations" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.volumetric_heat_capacity"><a class="docstring-binding" href="#ClimaLand.Soil.volumetric_heat_capacity"><code>ClimaLand.Soil.volumetric_heat_capacity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volumetric_heat_capacity(
    θ_l::FT,
    θ_i::FT,
    ρc_ds::FT,
    earth_param_set::EP,
) where {FT,EP}</code></pre><p>Compute the expression for volumetric heat capacity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L147-L156">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.κ_solid"><a class="docstring-binding" href="#ClimaLand.Soil.κ_solid"><code>ClimaLand.Soil.κ_solid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">κ_solid(ν_ss_om::FT,
        ν_ss_quartz::FT,
        κ_om::FT,
        κ_quartz::FT,
        κ_minerals::FT) where {FT}</code></pre><p>Computes the thermal conductivity of the solid material in soil. The <code>_ss_</code> subscript denotes that the volumetric fractions of the soil components are referred to the soil solid components, not including the pore space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L327-L338">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.κ_sat_frozen"><a class="docstring-binding" href="#ClimaLand.Soil.κ_sat_frozen"><code>ClimaLand.Soil.κ_sat_frozen</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">function κ_sat_frozen(
    κ_solid::FT,
    ν::FT,
    κ_ice::FT
) where {FT}</code></pre><p>Computes the thermal conductivity for saturated frozen soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L352-L359">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.κ_sat_unfrozen"><a class="docstring-binding" href="#ClimaLand.Soil.κ_sat_unfrozen"><code>ClimaLand.Soil.κ_sat_unfrozen</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">function κ_sat_unfrozen(
    κ_solid::FT,
    ν::FT,
    κ_l::FT
) where {FT}</code></pre><p>Computes the thermal conductivity for saturated unfrozen soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L364-L371">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.κ_sat"><a class="docstring-binding" href="#ClimaLand.Soil.κ_sat"><code>ClimaLand.Soil.κ_sat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">κ_sat(
    θ_l::FT,
    θ_i::FT,
    κ_sat_unfrozen::FT,
    κ_sat_frozen::FT
) where {FT}</code></pre><p>Compute the expression for saturated thermal conductivity of soil matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L233-L242">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.κ_dry"><a class="docstring-binding" href="#ClimaLand.Soil.κ_dry"><code>ClimaLand.Soil.κ_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">function κ_dry(ρp::FT,
               ν::FT,
               κ_solid::FT,
               κ_air::FT;
               a = FT(0.053)) where {FT}</code></pre><p>Computes the thermal conductivity of dry soil according to the model of Balland and Arp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L377-L386">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.kersten_number"><a class="docstring-binding" href="#ClimaLand.Soil.kersten_number"><code>ClimaLand.Soil.kersten_number</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">kersten_number(
    θ_i::FT,
    S_r::FT,
    α::FT,
    β::FT,
    ν_ss_om::FT,
    ν_ss_quartz::FT,
    ν_ss_gravel::FT,
    ) where {FT}</code></pre><p>Compute the expression for the Kersten number, using the Balland and Arp model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L287-L300">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.relative_saturation"><a class="docstring-binding" href="#ClimaLand.Soil.relative_saturation"><code>ClimaLand.Soil.relative_saturation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_saturation(
        θ_l::FT,
        θ_i::FT,
        ν::FT
) where {FT}</code></pre><p>Compute the expression for relative saturation. This is referred to as θ_sat in Balland and Arp&#39;s paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L273-L282">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.volumetric_internal_energy"><a class="docstring-binding" href="#ClimaLand.Soil.volumetric_internal_energy"><code>ClimaLand.Soil.volumetric_internal_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volumetric_internal_energy(θ_i::FT, ρc_s::FT, T::FT,
                             earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the volumetric internal energy of the soil, given the volumetric ice content, volumetric heat capacity, and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L194-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.volumetric_internal_energy_liq"><a class="docstring-binding" href="#ClimaLand.Soil.volumetric_internal_energy_liq"><code>ClimaLand.Soil.volumetric_internal_energy_liq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">volumetric_internal_energy_liq(T::FT, earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the volumetric internal energy of the liquid water in the soil, given the temperature T.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L214-L220">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.temperature_from_ρe_int"><a class="docstring-binding" href="#ClimaLand.Soil.temperature_from_ρe_int"><code>ClimaLand.Soil.temperature_from_ρe_int</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">temperature_from_ρe_int(ρe_int::FT, θ_i::FT, ρc_s::FT
                        earth_param_set::EP) where {FT, EP}</code></pre><p>A pointwise function for computing the temperature from the volumetric internal energy, volumetric ice content, and volumetric heat capacity of the soil.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L172-L179">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.thermal_conductivity"><a class="docstring-binding" href="#ClimaLand.Soil.thermal_conductivity"><code>ClimaLand.Soil.thermal_conductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">thermal_conductivity(
    κ_dry::FT,
    K_e::FT,
    κ_sat::FT
) where {FT}</code></pre><p>Compute the expression for thermal conductivity of soil matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L258-L266">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.phase_change_source"><a class="docstring-binding" href="#ClimaLand.Soil.phase_change_source"><code>ClimaLand.Soil.phase_change_source</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">phase_change_source(
    θ_l::FT,
    θ_i::FT,
    T::FT,
    τ::FT,
    ν::FT,
    θ_r::FT,
    hydrology_cm::CM,
    _ρ_i::FT,
    _ρ_l::FT,
    _LH_f0::FT,
    _T_freeze::FT,
    _grav::FT
    ) where {FT, CM}</code></pre><p>Returns the source term (1/s) used for converting liquid water and ice into each other during phase changes. Note that there are unitless prefactors multiplying this term in the equations.</p><p>Note that these equations match what is in Dall&#39;Amico (for θstar, ψ(T), ψw0). We should double check them in the case where we have ϑ<em>l &gt; θ</em>l, but they should be very close to the form we want regardless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L64-L88">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ClimaLand.Soil.thermal_time"><a class="docstring-binding" href="#ClimaLand.Soil.thermal_time"><code>ClimaLand.Soil.thermal_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">thermal_time(ρc::FT, Δz::FT, κ::FT) where {FT}</code></pre><p>Returns the thermal timescale for temperature differences across a typical thickness Δz to equilibrate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/fe1f185c1925ff7b9f395c110b91ca63288a2018/src/standalone/Soil/soil_heat_parameterizations.jl#L54-L59">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../julia/">« Julia background</a><a class="docs-footer-nextpage" href="../SoilSourcesandBCs/">Soil Sources and Boundary Conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 28 February 2026 00:58">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
