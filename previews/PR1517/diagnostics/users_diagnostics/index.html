<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>For users · ClimaLand.jl</title><meta name="title" content="For users · ClimaLand.jl"/><meta property="og:title" content="For users · ClimaLand.jl"/><meta property="twitter:title" content="For users · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../fundamental_concepts/">Fundamental Concepts</a></li><li><a class="tocitem" href="../../getting_started/">Running your first simulation</a></li><li><a class="tocitem" href="../../available_models/">Available Models and Parameterizations</a></li><li><a class="tocitem" href="../../parameters/">Parameters</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-3" type="checkbox"/><label class="tocitem" for="menuitem-6-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Writing and accessing outputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>For users</a><ul class="internal"><li><a class="tocitem" href="#Default-Diagnostics"><span>Default Diagnostics</span></a></li><li><a class="tocitem" href="#Example:-diagnostics-for-a-CanopyModel"><span>Example: diagnostics for a <code>CanopyModel</code></span></a></li><li><a class="tocitem" href="#Diagnostics-output-naming-and-format"><span>Diagnostics output naming and format</span></a></li><li><a class="tocitem" href="#Adding-new-diagnostics"><span>Adding new diagnostics</span></a></li><li class="toplevel"><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../available_diagnostics/">Available diagnostics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-2" type="checkbox"/><label class="tocitem" for="menuitem-8-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-3" type="checkbox"/><label class="tocitem" for="menuitem-8-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-4" type="checkbox"/><label class="tocitem" for="menuitem-8-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/plant_hydraulics/prognostic/">Prognostic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-5" type="checkbox"/><label class="tocitem" for="menuitem-8-1-5"><span class="docs-label">Solar Induced Fluorescence</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/solar_induced_fluorescence/lee_model/">Lee model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-6" type="checkbox"/><label class="tocitem" for="menuitem-8-1-6"><span class="docs-label">Canopy structure</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/canopy_structure/prescribed_structure/">Prescribed structure</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-7" type="checkbox"/><label class="tocitem" for="menuitem-8-1-7"><span class="docs-label">Canopy energy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/canopy_energy/canopy_energy/">Physics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-8" type="checkbox"/><label class="tocitem" for="menuitem-8-1-8"><span class="docs-label">Soil moisture stress</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/soil_moisture_stress/piecewise_model/">Piecewise model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/soil_moisture_stress/tuzet_model/">Tuzet model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/soil_moisture_stress/no_moisture_stress/">No moisture stress</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-9" type="checkbox"/><label class="tocitem" for="menuitem-8-1-9"><span class="docs-label">Autotrophic respiration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/autotrophic_respiration/jules_model/">JULES model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-2-1" type="checkbox"/><label class="tocitem" for="menuitem-8-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Calibration and benchmark</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../calibration/">Calibrating model parameters</a></li><li><a class="tocitem" href="../../leaderboard/leaderboard/">Model Benchmark</a></li></ul></li><li><a class="tocitem" href="../../architectures/">Running on GPU or with MPI</a></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../repo_structure/">Repository structure</a></li><li><a class="tocitem" href="../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../itime/">ITime type</a></li><li><a class="tocitem" href="../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../physical_units/">Physical units</a></li></ul></li><li><a class="tocitem" href="../../julia/">Julia background</a></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-13-1" type="checkbox"/><label class="tocitem" for="menuitem-13-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/soil/Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../APIs/soil/SoilSourcesandBCs/">Soil Sources and Boundary Conditions</a></li><li><a class="tocitem" href="../../APIs/soil/SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../../APIs/soil/SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-2" type="checkbox"/><label class="tocitem" for="menuitem-13-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../../APIs/canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../../APIs/canopy/Biomass/">Leaf, stem, root dynamics</a></li><li><a class="tocitem" href="../../APIs/canopy/Photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../../APIs/canopy/RadiativeTransfer/">Radiative Transfer</a></li><li><a class="tocitem" href="../../APIs/canopy/CanopyEnergy/">Energy</a></li><li><a class="tocitem" href="../../APIs/canopy/StomatalConductance/">Stomatal Conductance</a></li><li><a class="tocitem" href="../../APIs/canopy/AutotrophicRespiration/">Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../APIs/SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../APIs/Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../APIs/Snow/">Snow Model</a></li><li><a class="tocitem" href="../../APIs/ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-13-7" type="checkbox"/><label class="tocitem" for="menuitem-13-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../../APIs/AuxiliaryVariablesCache/">Auxiliary Variables Cache</a></li><li><a class="tocitem" href="../../APIs/Callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../APIs/Domains/">Domains</a></li><li><a class="tocitem" href="../../APIs/Drivers/">Drivers</a></li><li><a class="tocitem" href="../../APIs/Simulations/">Simulations</a></li><li><a class="tocitem" href="../../APIs/SolverFunctions/">Solver Functions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributor guide</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Writing and accessing outputs</a></li><li class="is-active"><a href>For users</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>For users</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/diagnostics/users_diagnostics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ClimaLand-Diagnostics-to-save-simulation-output"><a class="docs-heading-anchor" href="#Using-ClimaLand-Diagnostics-to-save-simulation-output">Using ClimaLand Diagnostics to save simulation output</a><a id="Using-ClimaLand-Diagnostics-to-save-simulation-output-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ClimaLand-Diagnostics-to-save-simulation-output" title="Permalink"></a></h1><p>When running a ClimaLand simulations, you have multiple options on how to write the outputs of that simulation. You may want all variables, or just a selected few. You may want instantaneous values, at the highest temporal and spatial resolution, or you may want to get averages at hourly or monthly time scale, and integrate in space (for example soil moisture from 0 to 1 meter depth). You may want to get more specific reductions, such as 10 days maximums, or compute a new variables as a function of others. You may want to get your outputs in memory in a Julia dictionary, or write them in a NetCDF file.</p><p>This is where ClimaLand Diagnostics comes in for users.</p><p>In this documentation page, we first explain how to use default diagnostics and what are the defaults, and then explain how to define your own diagnostics for more advanced users.</p><h2 id="Default-Diagnostics"><a class="docs-heading-anchor" href="#Default-Diagnostics">Default Diagnostics</a><a id="Default-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Default-Diagnostics" title="Permalink"></a></h2><p>Diagnostics refer to output saved during the simulation, which may be prognostic or diagnostic variables. Note that this is different from checkpointing the simulation, which has specific requirements. For information about checkpointing and restarting simulations, please see the page titled <a href="../../restarts/#Restarting-Simulations">Restarting Simulations</a>.</p><p>The main user-facing function in the ClimaLand.Diagnostics module is <code>default_diagnostics</code>. This function defines what diagnostic variables to compute by default for a specific model, and on what schedule (for example, hourly average).</p><p><code>default_diagnostics</code> takes in the following arguments:</p><ul><li><code>model</code>: The ClimaLand model to generate diagnostics for. Currently the following models support diagnostics: <code>CanopyModel</code>, <code>EnergyHydrologyModel</code>, <code>SoilCanopyModel</code>, <code>LandModel</code>, <code>BucketModel</code></li><li><code>start_date</code>: The start date of the simulation.</li><li><code>output_writer</code>: An object of type <code>ClimaDiagnostics.AbstractWriter</code>. Specifically this may be a <code>NetCDFWriter</code>, <code>HDF5Writer</code>, or <code>DictWriter</code>, which save output to a NetCDF file, HDF5 file, or dictionary in Julia memory, respectively. For more details about the diagnostics writers, please see the ClimaDiagnostics.jl documentation.</li><li><code>output_vars</code>: This argument may be <code>:short</code> to output a default list of variables defined for each model, <code>:long</code> to output all</li></ul><p>available variables for the model, or a user-defined list of variable &quot;short names&quot;.</p><ul><li><code>reduction_period</code>: How often to compute and save the provided temporal reduction of the diagnostics.</li><li><code>reduction_type</code>: A temporal reduction to apply to the diagnostics over each provided time period, e.g. <code>:average</code>, <code>:max</code>, <code>:min</code>, <code>:instantaneous</code> (no reduction)</li><li><code>dt</code>: Simulation timestep; only required for instantaneous diagnostics.</li></ul><h2 id="Example:-diagnostics-for-a-CanopyModel"><a class="docs-heading-anchor" href="#Example:-diagnostics-for-a-CanopyModel">Example: diagnostics for a <code>CanopyModel</code></a><a id="Example:-diagnostics-for-a-CanopyModel-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-diagnostics-for-a-CanopyModel" title="Permalink"></a></h2><p>The following code sets up default short diagnostics to be averaged hourly and written in memory as a Julia dictionary:</p><pre><code class="language-julia hljs">diag_writer = ClimaDiagnostics.Writers.DictWriter();
diagnostics = ClimaLand.Diagnostics.default_diagnostics(
    canopy,
    start_date;
    output_vars = :short,
    output_writer = diag_writer,
    reduction_period = :hourly,
    reduction_type = :average,
);</code></pre><p>To instead output a list of specific diagnostics, you can change the value of <code>output_vars</code>. For example, to output gross primary productivity (GPP) and transpiration you would do the following:</p><pre><code class="language-julia hljs">diag_writer = ClimaDiagnostics.Writers.DictWriter();
diagnostics = ClimaLand.Diagnostics.default_diagnostics(
    canopy,
    start_date;
    output_vars = [&quot;gpp&quot;, &quot;trans&quot;],
    output_writer = diag_writer,
    reduction_period = :hourly,
    reduction_type = :average,
);</code></pre><p>A description of available diagnostics and their short names can be found on the <a href="../available_diagnostics/#Available-diagnostic-variables">Available diagnostic variables</a> documentation page.</p><p>To write the diagnostics to a NetCDF file instead of saving it in memory, the <code>diag_writer</code> should be constructed as a <code>NetCDFWriter</code> and then passed to <code>default_diagnostics</code> as before:</p><pre><code class="language-julia hljs">outdir = &quot;my_output_dir&quot;
nc_writer =
    ClimaDiagnostics.Writers.NetCDFWriter(space, outdir; start_date)</code></pre><div class="admonition is-info" id="Note-e6da40a512c81551"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e6da40a512c81551" title="Permalink"></a></header><div class="admonition-body"><p>The <code>NetCDFWriter</code> currently writes to file for each diagnostic output, which can be quite slow when saving variables at every step. On the other hand, the <code>DictWriter</code> saves output to memory which may be too large in global runs, so <code>DictWriter</code> usually should not be used for global runs. In general, we recommend using <code>DictWriter</code> for column simulations, and <code>NetCDFWriter</code> for global simulations.</p></div></div><h2 id="Diagnostics-output-naming-and-format"><a class="docs-heading-anchor" href="#Diagnostics-output-naming-and-format">Diagnostics output naming and format</a><a id="Diagnostics-output-naming-and-format-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics-output-naming-and-format" title="Permalink"></a></h2><p>Diagnostics are typically named using the format <code>$(short_name)_$(period)_$(reduction)</code>. For example, with the NetCDFWriter, hourly-averaged GPP would be saved in an output file titled <code>gpp_1h_average.nc</code>.</p><p>The specific output format depends on which output writer is being used; for more details, please see the <a href="https://clima.github.io/ClimaDiagnostics.jl/stable/writers/">ClimaDiagnostics documentation</a>.</p><h2 id="Adding-new-diagnostics"><a class="docs-heading-anchor" href="#Adding-new-diagnostics">Adding new diagnostics</a><a id="Adding-new-diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-new-diagnostics" title="Permalink"></a></h2><p>To define a new, custom diagnostic, you must follow these steps:</p><ul><li>specify how to compute the diagnostic</li><li>manually define the diagnostic via <code>add_diagnostic_variable!</code></li><li>add the diagnostic to the list of possible diagnostics for the relevant model(s)</li></ul><h3 id="Define-how-to-compute-your-diagnostic-variable-from-your-model-state-and-cache."><a class="docs-heading-anchor" href="#Define-how-to-compute-your-diagnostic-variable-from-your-model-state-and-cache.">Define how to compute your diagnostic variable from your model state and cache.</a><a id="Define-how-to-compute-your-diagnostic-variable-from-your-model-state-and-cache.-1"></a><a class="docs-heading-anchor-permalink" href="#Define-how-to-compute-your-diagnostic-variable-from-your-model-state-and-cache." title="Permalink"></a></h3><p>These functions are defined in <code>src/diagnostics/land_compute_methods.jl</code> and must be named in the format <code>compute_[standard_name]!</code>. Be sure to write method(s) for each model you want this diagnostic to be available for. For example, let&#39;s say you want the bowen ratio (ratio between sensible heat and latent heat) in the Bucket model.</p><pre><code class="language-Julia hljs">function compute_bowen_ratio!(out, Y, p, t, land_model::BucketModel)
    if isnothing(out)
        return copy(p.bucket.turbulent_fluxes.shf / p.bucket.turbulent_fluxes.lhf)
    else
        out .= p.bucket.turbulent_fluxes.shf / p.bucket.turbulent_fluxes.lhf
    end
end</code></pre><p>Or, for convenience, you can use the <code>@diagnostic_compute</code> macro which generates the same function. However, it is better to use that macro only if you are retrieving an existing variable, such as latent heat flux, rather than computing one, like the Bowen ratio above. For example,</p><pre><code class="language-Julia hljs">@diagnostic_compute &quot;latent_heat_flux&quot; BucketModel p.bucket.turbulent_fluxes.lhf</code></pre><h3 id="Add-that-diagnostic(s)-variable-to-your-list-of-variables"><a class="docs-heading-anchor" href="#Add-that-diagnostic(s)-variable-to-your-list-of-variables">Add that diagnostic(s) variable to your list of variables</a><a id="Add-that-diagnostic(s)-variable-to-your-list-of-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Add-that-diagnostic(s)-variable-to-your-list-of-variables" title="Permalink"></a></h3><p>These functions are defined in <code>src/diagnostics/define_diagnostics.jl</code>.</p><pre><code class="language-Julia hljs"> add_diagnostic_variable!(
    short_name = &quot;bor&quot;,
    long_name = &quot;Bowen ratio&quot;,
    standard_name = &quot;bowen_ratio&quot;,
    units = &quot;&quot;,
    comments = &quot;Ratio of sensible to latent heat flux.&quot;,
    compute! = (out, Y, p, t) -&gt; compute_bowen_ratio!(out, Y, p, t, land_model),
)

add_diagnostic_variable!(
    short_name = &quot;lhf&quot;,
    long_name = &quot;Latent Heat Flux&quot;,
    standard_name = &quot;latent_heat_flux&quot;,
    units = &quot;W m^-2&quot;,
    comments = &quot;Exchange of energy at the land-atmosphere interface due to water evaporation or sublimation.&quot;,
    compute! = (out, Y, p, t) -&gt;
    compute_latent_heat_flux!(out, Y, p, t, land_model),
)</code></pre><h3 id="Define-how-often-to-output-your-variables,-and-how-to-combine-them."><a class="docs-heading-anchor" href="#Define-how-often-to-output-your-variables,-and-how-to-combine-them.">Define how often to output your variables, and how to combine them.</a><a id="Define-how-often-to-output-your-variables,-and-how-to-combine-them.-1"></a><a class="docs-heading-anchor-permalink" href="#Define-how-often-to-output-your-variables,-and-how-to-combine-them." title="Permalink"></a></h3><p>We support a range of reduction periods and reduction types, defined in <code>src/diagnostics/default_diagnostics.jl</code>, which should be passed to <code>default_diagnostics</code> as Symbols. Currently, the following periods are supported:</p><ul><li>:every_dt (requires <code>dt</code> to be provided separately)</li><li>:halfhourly</li><li>:hourly</li><li>:daily</li><li>:tendaily</li><li>:monthly</li></ul><p>And the following reduction types are supported:</p><ul><li>:instantaneous</li><li>:average (requires <code>pre_output_hook! = average_pre_output_hook!</code> when creating the <code>ScheduledDiagnostic</code>)</li><li>:max</li><li>:min</li></ul><p>You can also define your own output frequencies and reductions. For example, if you want the seasonal maximum of your variables, where season is defined as 90 days, you could add the following <code>get_period</code> function, and then provide this new reduction period to <code>default_diagnostics</code>.</p><pre><code class="language-Julia hljs">get_period(:seasonal) = Day(90)
default_diagnostics(model, start_date, output_writer; output_vars, reduction_period = :seasonal, reduction_type = :max)</code></pre><h3 id="Analyze-your-simulation-output"><a class="docs-heading-anchor" href="#Analyze-your-simulation-output">Analyze your simulation output</a><a id="Analyze-your-simulation-output-1"></a><a class="docs-heading-anchor-permalink" href="#Analyze-your-simulation-output" title="Permalink"></a></h3><p>Once you&#39;ve run your simulation and created an output folder (e.g., output_dir) with diagnostics, you can use <a href="https://github.com/CliMA/ClimaAnalysis.jl">ClimaAnalysis</a> to access and analyze your data. For in depth documentation about ClimaAnalysis, see its <a href="https://clima.github.io/ClimaAnalysis.jl/stable/">documentation</a>.</p><p>Here is an example of how to plot a variable:</p><pre><code class="language-Julia hljs">import ClimaAnalysis

import ClimaAnalysis.Visualize as viz

import CairoMakie # the plotting package used by ClimaAnalysis

simdir = ClimaAnalysis.SimDir(output_dir) # where output_dir is where you saved your diagnostics.

var = get(simdir; &quot;lhf&quot;) # assuming lhf, latent_heat_flux used as an example above, is one of your diagnostics variables.

fig = CairoMakie.Figure() # creates an empty figure object

viz.plot!(fig, var) # creates an axis inside fig, and plot your var in it.

CairoMakie.save(fig) # saves the figure in current working directory</code></pre><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Diagnostics.default_diagnostics" href="#ClimaLand.Diagnostics.default_diagnostics"><code>ClimaLand.Diagnostics.default_diagnostics</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_diagnostics(model::AbstractModel{FT},
                    start_date;
                    output_writer,
                    output_vars = :short,
                    reduction_period = :monthly,
                    reduction_type = :average,
                    dt = nothing)</code></pre><p>Construct a list of <code>ScheduledDiagnostics</code> that outputs the given variables at the specified average period.</p><p>The input <code>output_vars</code> can have 3 values:</p><ul><li><code>:long</code> - all diagnostics are output</li><li><code>:short</code> - a short list of diagnostics is output</li><li><code>_::Vector{String}</code> - a user-defined list of diagnostics is output</li></ul><p>If a user-defined list is provided for <code>output_vars</code>, it must be a vector of strings that are valid short names of diagnostics for the model. Please see the method <code>get_possible_diagnostics</code> for the list of available diagnostics for each model.</p><p><code>reduction_period</code> specifies the frequency at which to average the diagnostics, and <code>reduction_type</code> specifies the type of reduction to apply. Please see the docstring of <code>get_period</code> for the list of available periods, and the docstring of <code>get_reduction</code> for the list of available reduction types.</p><p>This method can be extended for any model that extends <code>get_possible_diagnostics</code> and <code>get_short_diagnostics</code>. Note that <code>EnergyHydrology</code> has a specialized method that handles conservation diagnostics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/diagnostics/default_diagnostics.jl#L133-L160">source</a></section><section><div><pre><code class="language-julia hljs">default_diagnostics(
    land_model::EnergyHydrology{FT},
    start_date;
    output_writer,
    output_vars = :short,
    reduction_period = :monthly,
    reduction_type = :average,
    conservation = false,
    conservation_period = Day(10),
    dt = nothing,
) where {FT}</code></pre><p>Define a method specific to the EnergyHydrology model so that we can handle conservation diagnostics specially.</p><p>The input <code>output_vars</code> can have 3 values:</p><ul><li><code>:long</code> - all diagnostics are output</li><li><code>:short</code> - a short list of diagnostics is output</li><li><code>_::Vector{String}</code> - a user-defined list of diagnostics is output</li></ul><p>If a user-defined list is provided for <code>output_vars</code>, it must be a vector of strings that are valid short names of diagnostics for the model.</p><p><code>reduction_period</code> specifies the frequency at which to average the diagnostics, and <code>reduction_type</code> specifies the type of reduction to apply. Please see the docstring of <code>get_period</code> for the list of available periods, and the docstring of <code>get_reduction</code> for the list of available reduction types.</p><p>Conservation diagnostics should not be provided as part of the <code>output_vars</code> argument, but rather included by providing <code>conservation = true</code>. Please see the method <code>get_possible_diagnostics</code> for the list of available diagnostics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/diagnostics/default_diagnostics.jl#L201-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Diagnostics.close_output_writers" href="#ClimaLand.Diagnostics.close_output_writers"><code>ClimaLand.Diagnostics.close_output_writers</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">close_output_writers(diagnostics)</code></pre><p>Close the output writers in the <code>diagnostics</code>, an iterable of <code>ClimaDiagnostics.ScheduledDiagnostic</code> or <code>nothing</code>.</p><p>This function should be called at the end of every simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/diagnostics/diagnostic.jl#L174-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.total_energy_per_area!" href="#ClimaLand.total_energy_per_area!"><code>ClimaLand.total_energy_per_area!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::EnergyHydrology,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total energy per unit ground area for the <code>EnergyHydrology</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Soil/energy_hydrology.jl#L1324-L1335">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::SnowModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total energy per unit ground area for the <code>SnowModel</code>.</p><p>This has already accounted for the area fraction of snow in the definition of S.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Snow/Snow.jl#L872-L886">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::BucketModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total energy per unit ground area for the <code>BucketModel</code>.</p><p>The ground of the bucket model has temperature <code>Y.bucket.T</code>, with volumetric specific heat approximated with the parameter <code>ρc_soil</code>. Additional energy is present due to the latent heat of fusion of frozen water, in the form of snow. We also add in this energy (below). We do not model or account for the sensible energy of snow (<code>ρ_snow T_snow</code>), as this is much smaller.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Bucket/Bucket.jl#L665-L684">source</a></section><section><div><pre><code class="language-julia hljs">total_energy_per_area!(cache, model::AbstractModel, Y, p, t)</code></pre><p>A function which updates <code>cache</code> in place with the total energy per unit ground area for the <code>model</code>, computed from <code>Y</code>, <code>p</code>, and <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/shared_utilities/models.jl#L503-L508">source</a></section><section><div><pre><code class="language-julia hljs">total_energy_per_area!(
    surface_field,
    land::AbstractLandModel,
    Y,
    p,
    t,
    sfc_cache,
)</code></pre><p>A function which computes the total energy per unit area and updates <code>surface_field</code> in place, for the land model <code>land</code>, by calling the same function for the component models.</p><p>The <code>sfc_cache</code> field is available as scratch space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/ClimaLand.jl#L231-L246">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::BigLeafEnergyModel,
    Y,
    p,
    t,</code></pre><p>)</p><p>A function which updates <code>surface_field</code> in place with the value of the big leaf model&#39;s energy.</p><p>Note that this assumes that there is at most a single canopy and stem component, and that the area index for them refers to the integrated area index (in height) - not the value per layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Vegetation/canopy_energy.jl#L254-L269">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::AbstractCanopyEnergyModel,
    Y,
    p,
    t,</code></pre><p>)</p><p>A default function which errors for generic energy models for the canopy.</p><p>Note that we only support two models for canopy energy. The <code>BigLeafEnergyModel</code> has a special method for this, and the other has the temperature prescribed and does not conserve energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Vegetation/canopy_energy.jl#L285-L299">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_energy_per_area!(
    surface_field,
    model::CanopyModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total energy per unit ground area for the <code>CanopyModel</code>.</p><p>This acts by calling the method for the energy component of the canopy model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Vegetation/Canopy.jl#L1173-L1187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.total_liq_water_vol_per_area!" href="#ClimaLand.total_liq_water_vol_per_area!"><code>ClimaLand.total_liq_water_vol_per_area!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::RichardsModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total liquid water volume per unit ground area for the <code>RichardsModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Soil/rre.jl#L481-L492">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::EnergyHydrology,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total liquid water volume per unit ground area for the <code>EnergyHydrology</code>.</p><p>The water in all phases is accounted for by converting ice volume to liquid water volume using the ratio of the density of ice to the density of water.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Soil/energy_hydrology.jl#L1292-L1306">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::SnowModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total liquid water volume per unit ground area for the <code>SnowModel</code>.</p><p>This has already accounted for the area fraction of snow in the definition of S; it also accounts for both liquid and frozen water present in the snow, as the snow water equivalent is already the total liquid water volume present in the snow if all the snow melted, per unit ground area.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Snow/Snow.jl#L844-L860">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::BucketModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total liquid water volume per unit ground area for the <code>BucketModel</code>, in [m³ m⁻²].</p><p>The total water contained in the bucket is the sum of the subsurface water storage <code>W</code>, the snow water equivalent <code>σS</code> and surface water content <code>Ws</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Bucket/Bucket.jl#L706-L722">source</a></section><section><div><pre><code class="language-julia hljs">total_liq_water_vol_per_area!(cache, model::AbstractModel, Y, p, t)</code></pre><p>A function which updates <code>cache</code> in place with the total liquid water volume per unit ground area for the <code>model</code>, computed from <code>Y</code>, <code>p</code>, and <code>t</code>.</p><p>While water mass is the fundamentally conserved quantity, soil modelling represents water by an equivalent water volume using the density of water and ice at standard temperature and pressure. Because of that, we report here the total volume of water present in a model (per unit area) that would arise if all the water was in liquid phase. This can be converted to a mass using the density of liquid water.</p><p>This includes the water in multiple phases. For example, if ice is present, the water volume is computed using ratio of the density of ice to the density of liquid water.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/shared_utilities/models.jl#L484-L498">source</a></section><section><div><pre><code class="language-julia hljs">total_liq_water_vol_per_area!(
    surface_field,
    land::AbstractLandModel,
    Y,
    p,
    t,
    sfc_cache,
)</code></pre><p>A function which computes the total liquid water volume per unit area and updates <code>surface_field</code> in place, for the land model <code>land</code>, by calling the same function for the component models.</p><p>The <code>sfc_cache</code> field is available as scratch space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/ClimaLand.jl#L264-L280">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::CanopyModel,
    Y,
    p,
    t,
)</code></pre><p>A function which updates <code>surface_field</code> in place with the value for the total liquid water volume per unit ground area for the <code>CanopyModel</code>.</p><p>This acts by calling the method for the PlantHydraulics component of the canopy model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Vegetation/Canopy.jl#L1198-L1212">source</a></section><section><div><pre><code class="language-julia hljs">ClimaLand.total_liq_water_vol_per_area!(
    surface_field,
    model::PlantHydraulicsModel,
    Y,
    p,
    t,</code></pre><p>)</p><p>A function which updates <code>surface_field</code> in place with the value of the plant hydraulic models total water volume.</p><p>Note that this is general for any number of canopy layers, but it assumes that the LAI and SAI given are per layer. This is distinct from the BigLeaf approach, in which the LAI and SAI refer to the integrated area index with heigh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/12cd6d369835791ce04a9af7b68a9254d01a2268/src/standalone/Vegetation/PlantHydraulics.jl#L645-L660">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../generated/shared_utilities/timestepping/">« Intro to implicit/explicit timestepping</a><a class="docs-footer-nextpage" href="../developers_diagnostics/">For developers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 31 October 2025 17:22">Friday 31 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
