<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Restarting a simulation · ClimaLand.jl</title><meta name="title" content="Restarting a simulation · ClimaLand.jl"/><meta property="og:title" content="Restarting a simulation · ClimaLand.jl"/><meta property="twitter:title" content="Restarting a simulation · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fundamental_concepts/">Fundamental Concepts</a></li><li><a class="tocitem" href="../getting_started/">Running your first simulation</a></li><li><a class="tocitem" href="../available_models/">Available Models and Parameterizations</a></li><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-6-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-3" type="checkbox"/><label class="tocitem" for="menuitem-6-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-1-4" type="checkbox"/><label class="tocitem" for="menuitem-6-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Writing and accessing outputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-2" type="checkbox"/><label class="tocitem" for="menuitem-8-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-3" type="checkbox"/><label class="tocitem" for="menuitem-8-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-4" type="checkbox"/><label class="tocitem" for="menuitem-8-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/plant_hydraulics/prognostic/">Prognostic model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-5" type="checkbox"/><label class="tocitem" for="menuitem-8-1-5"><span class="docs-label">Solar Induced Fluorescence</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/solar_induced_fluorescence/lee_model/">Lee model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-6" type="checkbox"/><label class="tocitem" for="menuitem-8-1-6"><span class="docs-label">Canopy structure</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/canopy_structure/prescribed_structure/">Prescribed structure</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-7" type="checkbox"/><label class="tocitem" for="menuitem-8-1-7"><span class="docs-label">Canopy energy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/canopy_energy/canopy_energy/">Physics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-8" type="checkbox"/><label class="tocitem" for="menuitem-8-1-8"><span class="docs-label">Soil moisture stress</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/soil_moisture_stress/piecewise_model/">Piecewise model</a></li><li><a class="tocitem" href="../standalone/pages/vegetation/soil_moisture_stress/tuzet_model/">Tuzet model</a></li><li><a class="tocitem" href="../standalone/pages/vegetation/soil_moisture_stress/no_moisture_stress/">No moisture stress</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-1-9" type="checkbox"/><label class="tocitem" for="menuitem-8-1-9"><span class="docs-label">Autotrophic respiration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/vegetation/autotrophic_respiration/jules_model/">JULES model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-2-1" type="checkbox"/><label class="tocitem" for="menuitem-8-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Calibration and benchmark</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calibration/">Calibrating model parameters</a></li><li><a class="tocitem" href="../leaderboard/leaderboard/">Model Benchmark</a></li></ul></li><li><a class="tocitem" href="../architectures/">Running on GPU or with MPI</a></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox" checked/><label class="tocitem" for="menuitem-11"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../repo_structure/">Repository structure</a></li><li class="is-active"><a class="tocitem" href>Restarting a simulation</a><ul class="internal"><li><a class="tocitem" href="#Saving-Checkpoints"><span>Saving Checkpoints</span></a></li><li><a class="tocitem" href="#Restarting-from-a-Checkpoint"><span>Restarting from a Checkpoint</span></a></li><li><a class="tocitem" href="#Output-Structure"><span>Output Structure</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../itime/">ITime type</a></li><li><a class="tocitem" href="../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../physical_units/">Physical units</a></li></ul></li><li><a class="tocitem" href="../julia/">Julia background</a></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-13-1" type="checkbox"/><label class="tocitem" for="menuitem-13-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../APIs/soil/Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../APIs/soil/SoilSourcesandBCs/">Soil Sources and Boundary Conditions</a></li><li><a class="tocitem" href="../APIs/soil/SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../APIs/soil/SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-2" type="checkbox"/><label class="tocitem" for="menuitem-13-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../APIs/canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../APIs/canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../APIs/canopy/Biomass/">Leaf, stem, root dynamics</a></li><li><a class="tocitem" href="../APIs/canopy/Photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../APIs/canopy/RadiativeTransfer/">Radiative Transfer</a></li><li><a class="tocitem" href="../APIs/canopy/CanopyEnergy/">Energy</a></li><li><a class="tocitem" href="../APIs/canopy/StomatalConductance/">Stomatal Conductance</a></li><li><a class="tocitem" href="../APIs/canopy/AutotrophicRespiration/">Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../APIs/SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../APIs/Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../APIs/Snow/">Snow Model</a></li><li><a class="tocitem" href="../APIs/ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-13-7" type="checkbox"/><label class="tocitem" for="menuitem-13-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../APIs/AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../APIs/AuxiliaryVariablesCache/">Auxiliary Variables Cache</a></li><li><a class="tocitem" href="../APIs/Callbacks/">Callbacks</a></li><li><a class="tocitem" href="../APIs/Domains/">Domains</a></li><li><a class="tocitem" href="../APIs/Drivers/">Drivers</a></li><li><a class="tocitem" href="../APIs/Simulations/">Simulations</a></li><li><a class="tocitem" href="../APIs/SolverFunctions/">Solver Functions</a></li></ul></li></ul></li><li><a class="tocitem" href="../contributing/">Contributor guide</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Additional resources</a></li><li class="is-active"><a href>Restarting a simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Restarting a simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/restarts.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Restarting-Simulations"><a class="docs-heading-anchor" href="#Restarting-Simulations">Restarting Simulations</a><a id="Restarting-Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Restarting-Simulations" title="Permalink"></a></h1><p><code>ClimaLand</code> provides functionality to save and load simulation checkpoints, allowing you to restart simulations from a previous state. This is particularly useful for long-running simulations or if you want to experiment with different configurations starting from a specific point in the simulation.</p><h2 id="Saving-Checkpoints"><a class="docs-heading-anchor" href="#Saving-Checkpoints">Saving Checkpoints</a><a id="Saving-Checkpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-Checkpoints" title="Permalink"></a></h2><p>To save a simulation checkpoint, you can use the <code>ClimaLand.save_checkpoint</code> function. This function takes the current state <code>Y</code>, the simulation time <code>t</code>, and the output directory as arguments. Optionally you can provide the <code>ClimaLand</code> model object model. This will store the hash of the model in the checkpoint file. You can use this information to ensure that you are restarting the simulation with the same model that was used to generate the checkpoint.</p><pre><code class="language-julia hljs">ClimaLand.save_checkpoint(Y, t, output_dir; model)</code></pre><p>Most typically, this function is not called directly. Instead, it is called as a callback.</p><p>In ClimaLand, you can automate the process of saving checkpoints using the <code>CheckpointCallback</code>. This callback allows you to specify the frequency at which checkpoints are saved and handles the saving process during the simulation.</p><p>To use the <code>CheckpointCallback</code>, you need to create an instance of it and pass it to the solve function along with your other callbacks.</p><p>Example:</p><pre><code class="language-julia hljs">
# ... your ClimaLand simulation setup ...

# Create a CheckpointCallback to save checkpoints every 6 hours
checkpoint_cb = CheckpointCallback(Dates.Hour(6), output_dir, start_date; model, dt)

# Add the callback to the callback set
cb = SciMLBase.CallbackSet(checkpoint_cb, other_callbacks...)

# Run the simulation with the callbacks
sol = SciMLBase.solve(prob, ode_algo; dt = Δt, callback = cb)

# ... your ClimaLand simulation analysis ...</code></pre><p>In this example, the <code>CheckpointCallback</code> will save a checkpoint every 6 hours during the simulation. You can customize the checkpoint_frequency to control how often checkpoints are saved. You can also pass the <code>ClimaLand</code> model object model to store its hash in the checkpoint file. This information can be used later to ensure that you are restarting the simulation with the same model that was used to generate the checkpoint.</p><p>If <code>dt</code> is passed, <code>CheckpointCallback</code> will also check that it is consistent with the checkpoint frequency.</p><h2 id="Restarting-from-a-Checkpoint"><a class="docs-heading-anchor" href="#Restarting-from-a-Checkpoint">Restarting from a Checkpoint</a><a id="Restarting-from-a-Checkpoint-1"></a><a class="docs-heading-anchor-permalink" href="#Restarting-from-a-Checkpoint" title="Permalink"></a></h2><p>To restart a simulation from a checkpoint, you can use the <code>ClimaLand.find_restart</code> function to locate the most recent checkpoint file in the output directory. Then, you can use the <code>ClimaLand.read_checkpoint</code> function to load the state vector and simulation time from the checkpoint file.</p><pre><code class="language-julia hljs">restart_file = ClimaLand.find_restart(output_dir)
Y, t = ClimaLand.read_checkpoint(restart_file; model)</code></pre><h2 id="Output-Structure"><a class="docs-heading-anchor" href="#Output-Structure">Output Structure</a><a id="Output-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Output-Structure" title="Permalink"></a></h2><p><code>ClimaLand</code> utilizes the <code>OutputPathGenerator</code> from <code>ClimaUtilities</code> to manage the output directory structure. By default, it uses the <code>ActiveLinkStyle</code>, which creates a sequence of numbered subfolders within the base output directory.</p><p>For example, if your base output directory is output, the following structure will be created:</p><pre><code class="nohighlight hljs">output/
├── output_0000/
│   └── ... checkpoint files ...
├── output_0001/
│   └── ... checkpoint files ...
├── output_0002/
│   └── ... checkpoint files ...
└── output_active -&gt; output_0002/</code></pre><p>The output_active symbolic link always points to the most recent output subfolder, making it easy to access the latest simulation results.</p><h3 id="Checkpoint-File-Structure"><a class="docs-heading-anchor" href="#Checkpoint-File-Structure">Checkpoint File Structure</a><a id="Checkpoint-File-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Checkpoint-File-Structure" title="Permalink"></a></h3><p>When using the <code>CheckpointCallback</code>, the checkpoints are saved as HDF5 files within the numbered output subfolders. The files are named using the following convention:</p><pre><code class="nohighlight hljs">day&lt;day_number&gt;.&lt;seconds_since_midnight&gt;.hdf5</code></pre><p>For example, a checkpoint saved at day 10, 3600 seconds after midnight would be named <code>day10.3600.hdf5</code>.</p><h3 id="Checkpoints,-drivers,-and-accumulated-diagnostics"><a class="docs-heading-anchor" href="#Checkpoints,-drivers,-and-accumulated-diagnostics">Checkpoints, drivers, and accumulated diagnostics</a><a id="Checkpoints,-drivers,-and-accumulated-diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Checkpoints,-drivers,-and-accumulated-diagnostics" title="Permalink"></a></h3><p>At the moment, <code>ClimaLand</code> does not support working with accumulated diagnostics across restarts. The present limitations are best illustrated with an example.</p><p>Suppose you are saving 30-day averages and stop the simulation at day 45. If you do so, you&#39;ll find output for day 30 and the checkpoint at day 45. Then, if you restart the simulation, you&#39;ll see that the next diagnostic output will be at day 75, and not day 60. In other words, the counter starts from 0 with every restart.</p><div class="admonition is-info" id="Note-d31959f3307acd5d"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d31959f3307acd5d" title="Permalink"></a></header><div class="admonition-body"><p>If you care about accurate accumulated diagnostics, make sure to line up your checkpoint and diagnostic frequencies.</p></div></div><p>Similarly, <code>ClimaLand</code> does not guarantee drivers values will be set consistently across restarts. That is, the values of the forcing variables from the last step of the original run will not coincide with the values of the forcing variables upon the initial step of the restart run, unless the frequencies of checkpointing and updating the drivers are compatible.</p><div class="admonition is-info" id="Note-4392a93f736f5197"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4392a93f736f5197" title="Permalink"></a></header><div class="admonition-body"><p>The reason why <code>ClimaLand</code> does not support these features (at the moment), is that updating drivers and diagnostics are implemented as callbacks. Callbacks have some internal memory that is not saved in the restart files.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../repo_structure/">« Repository structure</a><a class="docs-footer-nextpage" href="../itime/">ITime type »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 17 October 2025 00:50">Friday 17 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
