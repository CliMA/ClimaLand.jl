<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Photosynthesis · ClimaLand.jl</title><meta name="title" content="Photosynthesis · ClimaLand.jl"/><meta property="og:title" content="Photosynthesis · ClimaLand.jl"/><meta property="twitter:title" content="Photosynthesis · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Running your first simulation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-2" type="checkbox"/><label class="tocitem" for="menuitem-4-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-3" type="checkbox"/><label class="tocitem" for="menuitem-4-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/vegetation/plant_hydraulics/van_genuchten_model/">Van Genuchten model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_structure/">Model structure</a></li><li><a class="tocitem" href="../../../repo_structure/">Repository structure</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Analyzing model output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-3-1" type="checkbox"/><label class="tocitem" for="menuitem-5-3-1"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><a class="tocitem" href="../../../leaderboard/leaderboard/">Leaderboard</a></li></ul></li><li><a class="tocitem" href="../../../architectures/">Running on GPU or with MPI</a></li><li><a class="tocitem" href="../../../calibration/">Calibration</a></li><li><a class="tocitem" href="../../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../itime/">ITime type</a></li><li><a class="tocitem" href="../../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../../physical_units/">Physical units</a></li><li><a class="tocitem" href="../../../julia/">Julia background</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../../SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../Biomass/">Leaf, stem, root dynamics</a></li><li class="is-active"><a class="tocitem" href>Photosynthesis</a><ul class="internal"><li><a class="tocitem" href="#Models-and-Parameters"><span>Models and Parameters</span></a></li><li><a class="tocitem" href="#FarquharModel-Methods"><span>FarquharModel Methods</span></a></li><li><a class="tocitem" href="#PModel-Methods"><span>PModel Methods</span></a></li></ul></li><li><a class="tocitem" href="../RadiativeTransfer/">Radiative Transfer</a></li><li><a class="tocitem" href="../CanopyEnergy/">Energy</a></li><li><a class="tocitem" href="../StomatalConductance/">Stomatal Conductance</a></li><li><a class="tocitem" href="../AutotrophicRespiration/">Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../Snow/">Snow Model</a></li><li><a class="tocitem" href="../../ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../../Simulations/">Simulations</a></li><li><a class="tocitem" href="../../Domains/">Domains</a></li><li><a class="tocitem" href="../../Drivers/">Drivers</a></li><li><a class="tocitem" href="../../Callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../../parameters/">Parameters</a></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributor guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">APIs</a></li><li><a class="is-disabled">Canopy</a></li><li class="is-active"><a href>Photosynthesis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Photosynthesis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/APIs/canopy/Photosynthesis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Photosynthesis"><a class="docs-heading-anchor" href="#Photosynthesis">Photosynthesis</a><a id="Photosynthesis-1"></a><a class="docs-heading-anchor-permalink" href="#Photosynthesis" title="Permalink"></a></h1><h2 id="Models-and-Parameters"><a class="docs-heading-anchor" href="#Models-and-Parameters">Models and Parameters</a><a id="Models-and-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Models-and-Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModel" href="#ClimaLand.Canopy.PModel"><code>ClimaLand.Canopy.PModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModel{FT,
       OPFT &lt;: PModelParameters{FT},
       OPCT &lt;: PModelConstants{FT},
       F &lt;: Union{FT, ClimaCore.Fields.Field},
       } &lt;: AbstractPhotosynthesisModel{FT}</code></pre><p>An implementation of the optimality photosynthesis model &quot;P-model v1.0&quot; of Stocker et al. (2020).</p><p>Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T.,     and Prentice, I. C.: P-model v1.0: an optimality-based light use efficiency model for simulating     ecosystem gross primary production, Geosci. Model Dev., 13, 1545–1581,     https://doi.org/10.5194/gmd-13-1545-2020, 2020.</p><p>The P-model computes photosynthesis rates at the canopy level, and ci, Γstar, Ko, Kc are in units of Pa.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L192-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModel-Tuple{Any, ClimaParams.ParamDict}" href="#ClimaLand.Canopy.PModel-Tuple{Any, ClimaParams.ParamDict}"><code>ClimaLand.Canopy.PModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function PModel{FT}(
    domain,
    toml_dict::CP.ParamDict;
    is_c3 = clm_photosynthesis_parameters(domain.space.surface).is_c3,
    cstar = toml_dict[&quot;pmodel_cstar&quot;],
    β = toml_dict[&quot;pmodel_β&quot;],
    temperature_dep_yield = true,
    ϕ0_c3 = toml_dict[&quot;pmodel_ϕ0_c3&quot;],
    ϕ0_c4 = toml_dict[&quot;pmodel_ϕ0_c4&quot;],
    ϕa0_c3 = toml_dict[&quot;pmodel_ϕa0_c3&quot;],
    ϕa1_c3 = toml_dict[&quot;pmodel_ϕa1_c3&quot;],
    ϕa2_c3 = toml_dict[&quot;pmodel_ϕa2_c3&quot;],
    ϕa0_c4 = toml_dict[&quot;pmodel_ϕa0_c4&quot;],
    ϕa1_c4 = toml_dict[&quot;pmodel_ϕa1_c4&quot;],
    ϕa2_c4 = toml_dict[&quot;pmodel_ϕa2_c4&quot;],
    α = toml_dict[&quot;pmodel_α&quot;],
) where {FT &lt;: AbstractFloat}</code></pre><p>Constructs a P-model (an optimality model for photosynthesis) using default parameters.</p><p>The following default parameters (from the TOML file) are used:</p><ul><li>cstar = 0.41 (unitless) - 4 * dA/dJmax, assumed to be a constant marginal cost (Wang 2017, Stocker 2020)</li><li>β = 146 (unitless) - Unit cost ratio of Vcmax to transpiration (Stocker 2020)</li><li>ϕ0_c3 = 0.052 (unitless) - constant intrinsic quantum yield. Skillman (2008)</li><li>ϕ0_c4 = 0.057 (unitless) - constant intrinsic quantum yield. Skillman (2008)</li><li>ϕa0_c3 = 0.352*0.087 (unitless) - constant term in quadratic intrinsic quantum yield (Stocker 2020)</li><li>ϕa1_c3 = 0.022*0.087 (K^-1) - first order term in quadratic intrinsic quantum yield (Stocker 2020)</li><li>ϕa2_c3 = -0.00034*0.087 (K^-2) - second order term in quadratic intrinsic quantum yield (Stocker 2020)</li><li>ϕa0_c4 = 0.352*0.087 (unitless) - constant term in quadratic intrinsic quantum yield (Scott and Smith, 2022)</li><li>ϕa1_c4 = 0.022*0.087 (K^-1) - first order term in quadratic intrinsic quantum yield (Scott and Smith, 2022)</li><li>ϕa2_c4 = -0.00034*0.087 (K^-2) - second order term in quadratic intrinsic quantum yield (Scott and Smith, 2022)</li><li>α = 0.933 (unitless) - 1 - 1/T where T is the timescale of Vcmax, Jmax acclimation. Here T = 15 days. (Mengoli 2022)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/Canopy.jl#L204-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModelParameters" href="#ClimaLand.Canopy.PModelParameters"><code>ClimaLand.Canopy.PModelParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModelParameters{FT&lt;:AbstractFloat}</code></pre><p>The required parameters for P-model (Stocker et al. 2020). Parameters are typically tunable with considerable uncertainty.</p><ul><li><p><code>cstar</code>: Constant describing cost of maintaining electron transport (unitless)</p></li><li><p><code>β</code>: Ratio of unit costs of transpiration and carboxylation (unitless)</p></li><li><p><code>temperature_dep_yield</code>: A boolean flag indicating if the quantum yield is a function of temperature or not</p></li><li><p><code>ϕ0_c3</code>: Temp-independent intrinsic quantum yield. (unitless); C3</p></li><li><p><code>ϕ0_c4</code>: Temp-independent intrinsic quantum yield. (unitless); C4</p></li><li><p><code>ϕa0_c3</code>: Constant term in temp-dependent intrinsic quantum yield (unitless); C3.</p></li><li><p><code>ϕa1_c3</code>: First order term in temp-dependent intrinsic quantum yield (K^-1); C3.</p></li><li><p><code>ϕa2_c3</code>: Second order term in temp-dependent intrinsic quantum yield (K^-2); C3.</p></li><li><p><code>ϕa0_c4</code>: Constant term in temp-dependent intrinsic quantum yield (unitless); C4.</p></li><li><p><code>ϕa1_c4</code>: First order term in temp-dependent intrinsic quantum yield (K^-1); C4.</p></li><li><p><code>ϕa2_c4</code>: Second order term in temp-dependent intrinsic quantum yield (K^-2); C4.</p></li><li><p><code>α</code>: Timescale parameter used in EMA for acclimation of optimal photosynthetic capacities (unitless). Setting this to 0 represents no incorporation of past values. Since we update the EMA equation once per day, α = 1 - 1 day/τ where τ is the acclimation timescale in days.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.PModelConstants" href="#ClimaLand.Canopy.PModelConstants"><code>ClimaLand.Canopy.PModelConstants</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PModelConstants{FT&lt;:AbstractFloat}</code></pre><p>The required constants for P-model (Stocker et al. 2020). These are physical or biochemical constants that are not expected to change with time or space.</p><ul><li><p><code>R</code>: Gas constant (J mol^-1 K^-1)</p></li><li><p><code>Kc25</code>: Michaelis-Menten parameter for carboxylation at 25°C (Pa)</p></li><li><p><code>Ko25</code>: Michaelis-Menten parameter for oxygenation at 25°C (Pa)</p></li><li><p><code>To</code>: Reference temperature equal to 25˚C (K)</p></li><li><p><code>ΔHkc</code>: Energy of activation for Kc (J mol^-1)</p></li><li><p><code>ΔHko</code>: Energy of activation for Ko (J mol^-1)</p></li><li><p><code>Drel</code>: Relative diffusivity of CO2 in the stomatal pores, equal to 1.6.</p></li><li><p><code>ΔHΓstar</code>: Effective energy of activation for Γstar (J mol^-1)</p></li><li><p><code>Γstar25</code>: Γstar at 25 °C (Pa)</p></li><li><p><code>Ha_Vcmax</code>: Effective energy of activation for Vcmax (J mol^-1)</p></li><li><p><code>Hd_Vcmax</code>: Effective energy of deactivation for Vcmax (J mol^-1)</p></li><li><p><code>aS_Vcmax</code>: Intercept term for dS in Vcmax deactivation factor (J K^-1 mol^-1)</p></li><li><p><code>bS_Vcmax</code>: Slope term for dS in Vcmax deactivation factor (J K^-2 mol^-1)</p></li><li><p><code>Ha_Jmax</code>: Effective energy of activation for Jmax (J mol^-1)</p></li><li><p><code>Hd_Jmax</code>: Effective energy of deactivation for Jmax (J mol^-1)</p></li><li><p><code>aS_Jmax</code>: Intercept term for dS in Jmax deactivation factor (J K^-1 mol^-1)</p></li><li><p><code>bS_Jmax</code>: Slope term for dS in Jmax deactivation factor (J K^-2 mol^-1)</p></li><li><p><code>Mc</code>: Molar mass of carbon (kg mol^-1)</p></li><li><p><code>oi</code>: Intercellular O2 mixing ratio (unitless)</p></li><li><p><code>aRd</code>: First order coefficient for temp-dependent Rd (K^-1)</p></li><li><p><code>bRd</code>: Second order coefficient for temp-dependent Rd (K^-2)</p></li><li><p><code>fC3</code>: Constant factor appearing the dark respiration term for C3 plants (unitless)</p></li><li><p><code>planck_h</code>: Planck constant (J s)</p></li><li><p><code>lightspeed</code>: Speed of light (m s^-1)</p></li><li><p><code>N_a</code>: Avogadro constant (mol^-1)</p></li><li><p><code>ρ_water</code>: Density of water (kg m^-3)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L45-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharModel" href="#ClimaLand.Canopy.FarquharModel"><code>ClimaLand.Canopy.FarquharModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FarquharModel{FT, FP &lt;: FarquharParameters{FT}}</code></pre><p>A photosynthesis model taking leaf-level Vcmax25 and multiple other constants and predicting dark respiration at the leaf level, net photosynthesis at the leaf level, and GPP at the canopy level.</p><p>The Farquhar model computes photosynthetic rates using leaf-level properties, and so Vcmax25, Rd, An, etc are per unit area leaf. This version also works with ci, Γstar, Ko, Ki, in units of mol/mol, and not Pa.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L71-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharModel-Union{Tuple{FT}, Tuple{Any, ClimaParams.ParamDict}} where FT&lt;:AbstractFloat" href="#ClimaLand.Canopy.FarquharModel-Union{Tuple{FT}, Tuple{Any, ClimaParams.ParamDict}} where FT&lt;:AbstractFloat"><code>ClimaLand.Canopy.FarquharModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FarquharModel{FT}(
    domain;
    photosynthesis_parameters = clm_photosynthesis_parameters(
        domain.space.surface,
    ),
) where {
    FT &lt;: AbstractFloat,
    MECH &lt;: Union{FT, ClimaCore.Fields.Field},
    VC &lt;: Union{FT, ClimaCore.Fields.Field},
}</code></pre><p>Creates a FarquharModel using default parameters of type FT.</p><p>The <code>photosynthesis_parameters</code> argument is a NamedTuple that contains</p><ul><li><code>is_c3</code>: a Float or Field indicating if plants are C3 (1) or C4 (0) (unitless)</li><li><code>Vcmax25</code>: a Float or Field representing the maximum carboxylation rate at 25C (mol m^-2 s^-1)</li></ul><p>By default, these parameters are set by the <code>clm_photosynthesis_parameters</code> function, which reads in CLM data onto the surface space as ClimaUtilities SpaceVaryingInputs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/Canopy.jl#L171-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharParameters" href="#ClimaLand.Canopy.FarquharParameters"><code>ClimaLand.Canopy.FarquharParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FarquharParameters{
    FT&lt;:AbstractFloat,
    MECH &lt;: Union{FT, ClimaCore.Fields.Field},
    VC &lt;: Union{FT, ClimaCore.Fields.Field},
}</code></pre><p>The required parameters for the Farquhar photosynthesis model.</p><ul><li><p><code>Vcmax25</code>: Vcmax at 25 °C (mol CO2/m^2/s); leaf level</p></li><li><p><code>Γstar25</code>: Γstar at 25 °C (mol/mol)</p></li><li><p><code>Kc25</code>: Michaelis-Menten parameter for CO2 at 25 °C (mol/mol)</p></li><li><p><code>Ko25</code>: Michaelis-Menten parameter for O2 at 25 °C (mol/mol)</p></li><li><p><code>ΔHkc</code>: Energy of activation for CO2 (J/mol)</p></li><li><p><code>ΔHko</code>: Energy of activation for oxygen (J/mol)</p></li><li><p><code>ΔHVcmax</code>: Energy of activation for Vcmax (J/mol)</p></li><li><p><code>ΔHΓstar</code>: Energy of activation for Γstar (J/mol)</p></li><li><p><code>ΔHJmax</code>: Energy of activation for Jmax (J/mol)</p></li><li><p><code>ΔHRd</code>: Energy of activation for Rd (J/mol)</p></li><li><p><code>To</code>: Reference temperature equal to 25 degrees Celsius (K)</p></li><li><p><code>oi</code>: Intercelluar O2 concentration (mol/mol); taken to be constant</p></li><li><p><code>ϕ</code>: Quantum yield of photosystem II (Bernacchi, 2003; unitless)</p></li><li><p><code>θj</code>: Curvature parameter, a fitting constant to compute J, unitless</p></li><li><p><code>fC3</code>: Constant factor appearing the dark respiration term for C3, equal to 0.015.</p></li><li><p><code>fC4</code>: Constant factor appearing the dark respiration term for C4, equal to 0.025.</p></li><li><p><code>Q10</code>: Q10 temperature parameter for Vcmax and Rd for C4 photosynthesis; unitless</p></li><li><p><code>s1</code>: Parameter appearing in temperature dependence of C4 Vcmax; K^{-1}</p></li><li><p><code>s2</code>: Parameter appearing in temperature dependence of C4 Vcmax; K</p></li><li><p><code>s3</code>: Parameter appearing in temperature dependence of C4 Vcmax; K^{-1}</p></li><li><p><code>s4</code>: Parameter appearing in temperature dependence of C4 Vcmax; K</p></li><li><p><code>s5</code>: Parameter appearing in temperature dependence of C4 Rd; K^{-1}</p></li><li><p><code>s6</code>: Parameter appearing in temperature dependence of C4 Rd; K</p></li><li><p><code>E</code>: Quantum yield for C4 photosynthesis; mol/mol</p></li><li><p><code>is_c3</code>: Photosynthesis mechanism: 1.0 indicates C3, 0.0 indicates C4</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.FarquharParameters-Tuple{ClimaParams.ParamDict}" href="#ClimaLand.Canopy.FarquharParameters-Tuple{ClimaParams.ParamDict}"><code>ClimaLand.Canopy.FarquharParameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function FarquharParameters(
    toml_dict::CP.ParamDict;
    is_c3::Union{AbstractFloat, ClimaCore.Fields.Field},
    Vcmax25,
)</code></pre><p>Constructor for the <code>FarquharParameters</code> struct.</p><pre><code class="language-julia hljs">import ClimaParams as CP
toml_dict = CP.create_toml_dict(Float32);
ClimaLand.Canopy.FarquharParameters(toml_dict, 1.0f0; Vcmax25 = 99999999)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L452-L465">source</a></section></article><h2 id="FarquharModel-Methods"><a class="docs-heading-anchor" href="#FarquharModel-Methods">FarquharModel Methods</a><a id="FarquharModel-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#FarquharModel-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.arrhenius_function" href="#ClimaLand.Canopy.arrhenius_function"><code>ClimaLand.Canopy.arrhenius_function</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">arrhenius_function(T::FT, To::FT, R::FT, ΔH::FT)</code></pre><p>Computes the Arrhenius function at temperature <code>T</code> given the reference temperature <code>To=298.15K</code>, the universal gas constant <code>R</code>, and the energy activation <code>ΔH</code>.</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L133-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intercellular_co2_farquhar" href="#ClimaLand.Canopy.intercellular_co2_farquhar"><code>ClimaLand.Canopy.intercellular_co2_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intercellular_co2_farquhar(ca::FT, Γstar::FT, medlyn_factor::FT) where{FT}</code></pre><p>Computes the intercellular CO2 concentration (mol/mol) given the atmospheric concentration (<code>ca</code>, mol/mol), the CO2 compensation (<code>Γstar</code>,  mol/mol), and the Medlyn factor (unitless).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L734-L740">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.co2_compensation_farquhar" href="#ClimaLand.Canopy.co2_compensation_farquhar"><code>ClimaLand.Canopy.co2_compensation_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">co2_compensation_farquhar(Γstar25::FT,
                 ΔHΓstar::FT,
                 T::FT,
                 To::FT,
                 R::FT) where {FT}</code></pre><p>Computes the CO2 compensation point (<code>Γstar</code>), in units of mol/mol, as a function of its value at 25 °C (<code>Γstar25</code>), a constant energy of activation (<code>ΔHΓstar</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L750-L764">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.rubisco_assimilation_farquhar" href="#ClimaLand.Canopy.rubisco_assimilation_farquhar"><code>ClimaLand.Canopy.rubisco_assimilation_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rubisco_assimilation_farquhar(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct rubisco assimilation function based on the <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_rubisco_assimilation_farquhar</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_rubisco_assimilation_farquhar</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L98-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.light_assimilation_farquhar" href="#ClimaLand.Canopy.light_assimilation_farquhar"><code>ClimaLand.Canopy.light_assimilation_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">light_assimilation_farquhar(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct light assimilation function based on the <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_light_assimilation_farquhar</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_light_assimilation_farquhar</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L152-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.max_electron_transport_farquhar" href="#ClimaLand.Canopy.max_electron_transport_farquhar"><code>ClimaLand.Canopy.max_electron_transport_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_electron_transport_farquhar(
    Vcmax25::FT,
    ΔHJmax::FT,
    T::FT,
    To::FT,
    R::FT,
) where {FT}</code></pre><p>Computes the maximum potential rate of electron transport (<code>Jmax</code>), in units of mol/m^2/s, as a function of Vcmax at 25 °C (<code>Vcmax25</code>), a constant (<code>ΔHJmax</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L515-L532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.electron_transport_farquhar" href="#ClimaLand.Canopy.electron_transport_farquhar"><code>ClimaLand.Canopy.electron_transport_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_transport_farquhar(APAR::FT,
                   Jmax::FT,
                   θj::FT,
                   ϕ::FT) where {FT}</code></pre><p>Computes the rate of electron transport (<code>J</code>), in units of mol/m^2/s, as a function of the maximum potential rate of electron transport (<code>Jmax</code>), absorbed photosynthetically active radiation (<code>APAR</code>), an empirical &quot;curvature parameter&quot; (<code>θj</code>; Bonan Eqn 11.21) and the quantum yield of photosystem II (<code>ϕ</code>).</p><p>In this function, all fluxes are per unit leaf area, including APAR.</p><p>See Ch 11, G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L545-L561">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.net_photosynthesis" href="#ClimaLand.Canopy.net_photosynthesis"><code>ClimaLand.Canopy.net_photosynthesis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">net_photosynthesis(A::FT,
                   Rd::FT) where {FT}</code></pre><p>Computes the total net carbon assimilation (<code>An</code>), in units of mol CO2/m^2/s, as a function of the gross assimilation (<code>A</code>) and  dark respiration (<code>Rd</code>).</p><p>Note that if  moisture stress is factored into the model, it must be applied correctly to Rd and A prior to this function.</p><p>Both A and Rd must either be leaf level (standard Farquhar), or  canopy level (p-model), but not mixed. The returned quantity is  similarily either leaf or canopy level.</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L46-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.dark_respiration_farquhar" href="#ClimaLand.Canopy.dark_respiration_farquhar"><code>ClimaLand.Canopy.dark_respiration_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dark_respiration_farquhar(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct dark respiration function based on <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_dark_respiration</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_dark_respiration</code>.</p><p>TODO: Generalize to p-model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L646-L656">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.MM_Kc" href="#ClimaLand.Canopy.MM_Kc"><code>ClimaLand.Canopy.MM_Kc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MM_Kc(Kc25::FT,
      ΔHkc::FT,
      T::FT,
      To::FT,
      R::FT) where {FT}</code></pre><p>Computes the Michaelis-Menten coefficient for CO2 (<code>Kc</code>), in units of mol/mol or Pa (depending on the units of <code>Kc25</code>), as a function of its value at 25 °C (<code>Kc25</code>), a constant (<code>ΔHkc</code>), a standard temperature (<code>To</code>), the unversal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L91-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.MM_Ko" href="#ClimaLand.Canopy.MM_Ko"><code>ClimaLand.Canopy.MM_Ko</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MM_Ko(Ko25::FT,
      ΔHko::FT,
      T::FT,
      To::FT,
      R::FT) where {FT}</code></pre><p>Computes the Michaelis-Menten coefficient for O2 (<code>Ko</code>), in units of mol/mol or Pa (depending on the units of <code>Ko25</code>), as a function of its value at 25 °C (<code>Ko25</code>), a constant (<code>ΔHko</code>), a standard temperature (<code>To</code>), the universal gas constant (<code>R</code>), and the temperature (<code>T</code>).</p><p>See Table 11.5 of G. Bonan&#39;s textbook, Climate Change and Terrestrial Ecosystem Modeling (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L112-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_Vcmax_farquhar" href="#ClimaLand.Canopy.compute_Vcmax_farquhar"><code>ClimaLand.Canopy.compute_Vcmax_farquhar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Vcmax_farquhar(is_c3::AbstractFloat, args...)</code></pre><p>Calls the correct Vcmax function based on <code>is_c3</code>.</p><p>A <code>is_c3</code> value of 1.0 corresponds to C3 photosynthesis and calls <code>c3_compute_Vcmax</code>, while 0.0 corresponds to C4 photsynthesis and calls <code>c4_compute_Vcmax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis_farquhar.jl#L578-L586">source</a></section></article><h2 id="PModel-Methods"><a class="docs-heading-anchor" href="#PModel-Methods">PModel Methods</a><a id="PModel-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#PModel-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_full_pmodel_outputs" href="#ClimaLand.Canopy.compute_full_pmodel_outputs"><code>ClimaLand.Canopy.compute_full_pmodel_outputs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_full_pmodel_outputs(
    parameters::PModelParameters{FT},
    constants::PModelConstants{FT},
    T_canopy::FT,
    P_air::FT,
    VPD::FT,
    ca::FT,
    βm::FT,
    APAR::FT;
    is_c3 = FT(1)
) where {FT}</code></pre><p>Performs the P-model computations as defined in Stocker et al. (2020) and returns a dictionary of full outputs. See https://github.com/geco-bern/rpmodel for a code reference. This should replicate the behavior of the <code>rpmodel</code> package.</p><p>This is for C3 only, since the comparison data for C3.</p><p>Args:</p><ul><li><code>parameters</code>:     PModelParameters object containing the model parameters.</li><li><code>constants</code>:      PModelConstants object containing the model constants.</li><li><code>T_canopy</code>:       Canopy temperature (K).</li><li><code>P_air</code>:          Ambient air pressure (Pa).</li><li><code>VPD</code>:            Vapor pressure deficit (Pa).</li><li><code>ca</code>:             Ambient CO2 concentration (mol/mol).</li><li><code>βm</code>:             Soil moisture stress factor (unitless).</li><li><code>APAR</code>:          Absorbed photosynthetically active radiation (mol photons m^-2 s^-1).</li></ul><p>Returns: named tuple with the following keys and descriptions: Output name         Description (units)</p><ul><li>&quot;gpp&quot;           Gross primary productivity (kg m^-2 s^-1)</li><li>&quot;gammastar&quot;     CO2 compensation point (Pa)</li><li>&quot;kmm&quot;           Effective MM coefficient for Rubisco-limited photosynthesis (Pa)</li><li>&quot;ns_star&quot;       Viscosity of water normalized to 25 deg C (unitless)</li><li>&quot;chi&quot;           Optimal ratio of intercellular to ambient CO2 (unitless)</li><li>&quot;xi&quot;            Sensitivity of χ to VPD (Pa^1/2)</li><li>&quot;mj&quot;            CO2 limitation factor for light-limited photosynthesis (unitless)</li><li>&quot;mc&quot;            CO2 limitation factor for Rubisco-limited photosynthesis (unitless)</li><li>&quot;ci&quot;            Intercellular CO2 concentration (Pa)</li><li>&quot;iwue&quot;          Intrinsic water use efficiency (Pa)</li><li>&quot;gs&quot;            Stomatal conductance (mol m^-2 s^-1 Pa^-1)</li><li>&quot;vcmax&quot;         Maximum rate of carboxlation (mol m^-2 s^-1)</li><li>&quot;vcmax25&quot;       Vcmax normalized to 25°C via modified-Arrhenius type function (mol m^-2 s^-1)</li><li>&quot;jmax&quot;          Maximum rate of electron transport (mol m^-2 s^-1)</li><li>&quot;jmax25&quot;        Jmax normalized to 25°C via modified-Arrhenius type function (mol m^-2 s^-1)</li><li>&quot;Rd&quot;            Dark respiration rate (mol m^-2 s^-1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L278-L325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.set_historical_cache!" href="#ClimaLand.Canopy.set_historical_cache!"><code>ClimaLand.Canopy.set_historical_cache!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function set_historical_cache!(p, Y0, model::PModel, canopy)</code></pre><p>The P-model requires a cache of optimal Vcmax25, Jmax25, and ξ that represent past acclimated values. Before the simulation, we need to have some physically meaningful initial values for these variables, which live in p.canopy.photosynthesis.OptVars.</p><p>This method assumes that the acclimation is to the initial conditions of the simulation. Note that if the initial condition is e.g., nighttime, then initially the optimal Vcmax and Jmax are zero, so it will take ~1 month (two e-folding timescales for α corresponding to 2 week acclimation timescale) for the model to reach a physically meaningful state.</p><p>An alternative to this approach is to initialize the initial optimal values to some reasonable values based on a spun-up simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L612-L626">source</a></section><section><div><pre><code class="language-julia hljs">set_historical_cache!(p, Y0, m::AbstractPhotosynthesisModel, canopy)</code></pre><p>For some canopy components (namely the P-model), we need values at t-1 to compute new values, so this function sets the historical cache values for the photosynthesis model. However, for other photosynthesis models this is not needed, so do nothing by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/Canopy.jl#L1245-L1251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.update_optimal_EMA" href="#ClimaLand.Canopy.update_optimal_EMA"><code>ClimaLand.Canopy.update_optimal_EMA</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_optimal_EMA(is_c3::FT,
    parameters::PModelParameters{FT},
    constants::PModelConstants{FT},
    OptVars::NamedTuple{(:ξ_opt, :Vcmax25_opt, :Jmax25_opt), Tuple{FT, FT, FT}},
    T_canopy::FT,
    P_air::FT,
    VPD::FT,
    ca::FT,
    βm::FT,
    APAR::FT,
    local_noon_mask::FT,
) where {FT}</code></pre><p>This function updates the optimal photosynthetic capacities Vcmax25, Jmax25 and sensitivity of stomatal conductance to dryness (ξ) using an exponential moving average (EMA) that computes new optimal values at local noon, following Mengoli et al. (2022).</p><p>Args:</p><ul><li><code>is_c3</code>:      Photosynthesis mechanism</li><li><code>parameters</code>: PModelParameters object containing the model parameters.</li><li><code>constants</code>: PModelConstants object containing the model constants.</li><li><code>OptVars</code>: NamedTuple containing the current optimal values of ξ, Vcmax25, and Jmax25.</li><li><code>T_canopy</code>: Canopy temperature (K).</li><li><code>P_air</code>: Ambient air pressure (Pa).</li><li><code>VPD</code>: Vapor pressure deficit (Pa).</li><li><code>ca</code>: Ambient CO2 concentration (mol/mol).</li><li><code>βm</code>: Soil moisture stress factor (unitless).</li><li><code>APAR</code>: Absorbed photosynthetically active radiation (mol photons m^-2 s^-1).</li><li><code>local_noon_mask</code>: A mask (0 or 1) indicating whether the current time is within the local noon window.</li></ul><p>Returns:</p><ul><li>NamedTuple with updated optimal values of ξ, Vcmax25, and Jmax25</li></ul><p>Reference: Mengoli, G., Agustí-Panareda, A., Boussetta, S., Harrison, S. P., Trotta, C., &amp; Prentice, I. C. (2022). Ecosystem photosynthesis in land-surface models: A first-principles approach incorporating acclimation. Journal of Advances in Modeling Earth Systems, 14, e2021MS002767. https://doi.org/10.1029/2021MS002767</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L455-L493">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.make_PModel_callback" href="#ClimaLand.Canopy.make_PModel_callback"><code>ClimaLand.Canopy.make_PModel_callback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function make_PModel_callback(
    ::Type{FT},
    t0::ITime,
    dt,
    canopy,
    longitude = nothing
) where {FT &lt;: AbstractFloat}</code></pre><p>This constructs a IntervalBasedCallback for the P-model that updates the optimal photosynthetic capacities using an exponential moving average at local noon.</p><p>We check for local noon using the provided <code>longitude</code> (once passing in lat/lon for point/column domains, this can be automatically extracted from the domain axes) every dt. The time of local noon is expressed in seconds UTC and neglects the effects of obliquity and eccentricity, so it is constant throughout the year. This presents an error of up to ~20 minutes, but it is sufficient for our application here (since meteorological drivers are often updated at coarser time intervals anyway).</p><p>Args</p><ul><li><code>FT</code>: The floating-point type used in the model (e.g., <code>Float32</code>, <code>Float64</code>).</li><li><code>t0</code>: ITime, with epoch in UTC.</li><li><code>dt</code>: timestep</li><li><code>canopy</code>: the canopy object containing the P-model parameters and constants.</li><li><code>longitude</code>: optional longitude in degrees for local noon calculation (default is <code>nothing</code>, which means   that it will be inferred from the canopy domain).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L764-L789">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intrinsic_quantum_yield" href="#ClimaLand.Canopy.intrinsic_quantum_yield"><code>ClimaLand.Canopy.intrinsic_quantum_yield</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intrinsic_quantum_yield(
    is_c3::FT, T::FT, parameters) where {FT}</code></pre><p>Computes the intrinsic quantum yield of photosystem II.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1074-L1078">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_viscosity_ratio" href="#ClimaLand.Canopy.compute_viscosity_ratio"><code>ClimaLand.Canopy.compute_viscosity_ratio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_viscosity_ratio(
    T::FT,
    To::FT,
    ρ_water::FT
) where {FT}</code></pre><p>Computes η*, the ratio of the viscosity of water at temperature T to that at To = 25˚C.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1216-L1224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_Kmm" href="#ClimaLand.Canopy.compute_Kmm"><code>ClimaLand.Canopy.compute_Kmm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_Kmm(
    T::FT,
    p::FT,
    Kc25::FT,
    Ko25::FT,
    ΔHkc::FT,
    ΔHko::FT,
    To::FT,
    R::FT,
    oi::FT
) where {FT}</code></pre><p>Computes the effective Michaelis-Menten coefficient for Rubisco-limited photosynthesis (<code>Kmm</code>), in units Pa, as a function of temperature T (K), atmospheric pressure p (Pa), and constants: Kc25 (Michaelis-Menten coefficient for CO2 at 25 °C), Ko25 (Michaelis-Menten coefficient for O2 at 25 °C), ΔHkc (effective enthalpy of activation for Kc), ΔHko (effective enthalpy of activation for Ko), To (reference temperature, typically 298.15 K), R (universal gas constant), and oi (O2 mixing ratio, typically 0.209).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1037-L1056">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.intercellular_co2_pmodel" href="#ClimaLand.Canopy.intercellular_co2_pmodel"><code>ClimaLand.Canopy.intercellular_co2_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">intercellular_co2_pmodel(ξ::FT, ca_pp::FT, Γstar::FT, VPD::FT) where {FT}</code></pre><p>Computes the intercellular co2 concentration (<code>ci</code>) as a function of the optimal <code>ξ</code> (sensitivity to dryness), <code>ca_pp</code> (ambient CO2 partial pressure), <code>Γstar</code> (CO2 compensation point), and <code>VPD</code> (vapor pressure deficit).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1270-L1276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.gs_co2_pmodel" href="#ClimaLand.Canopy.gs_co2_pmodel"><code>ClimaLand.Canopy.gs_co2_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gs_co2_pmodel(
    χ::FT,
    ca::FT,
    A::FT
) where {FT}</code></pre><p>Computes the stomatal conductance of CO2 (<code>gs_co2</code>), in units of mol CO2/m^2/s via Fick&#39;s law. Parameters are the ratio of intercellular to ambient CO2 concentration (<code>χ</code>), the ambient CO2 concentration (<code>ca</code>, in mol/mol), and the assimilation rate (<code>A</code>, mol m^-2 s^-1). This is related to the conductance of water by a factor Drel (default value = 1.6).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1289-L1301">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.gs_h2o_pmodel" href="#ClimaLand.Canopy.gs_h2o_pmodel"><code>ClimaLand.Canopy.gs_h2o_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gs_h2o_pmodel(
    χ::FT,
    ca::FT,
    A::FT,
    Drel::FT
) where {FT}</code></pre><p>Computes the stomatal conductance of H2O (<code>gs_h2o</code>), in units of mol H2O/m^2/s via Fick&#39;s law. Parameters are the ratio of intercellular to ambient CO2 concentration (<code>χ</code>), the ambient CO2 concentration (<code>ca</code>, in mol/mol), the assimilation rate (<code>A</code>, mol m^-2 s^-1), and the relative conductivity ratio <code>Drel</code> (unitless).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1306-L1318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_mj" href="#ClimaLand.Canopy.compute_mj"><code>ClimaLand.Canopy.compute_mj</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mj(
    is_c3::FT, T::FT, parameters) where {FT}</code></pre><p>Computes the unitless factor <code>mj = (ci - Γstar)/(ci+2Γstar)</code> (for C3 plants) and <code>mj = 1</code> for C4 plants, where the rubisco assimilation rate is Ac = Vcmax*mj.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1475-L1481">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_mc" href="#ClimaLand.Canopy.compute_mc"><code>ClimaLand.Canopy.compute_mc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mc(
    is_c3::FT, T::FT, parameters) where {FT}</code></pre><p>Computes the unitless factor <code>mc = (ci - Γstar)/(ci+Kmm)</code> (for C3 plants) and <code>mj = 1</code> for C4 plants, where the light assimilation rate is Aj = J/4 mj.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1496-L1502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.vcmax_pmodel" href="#ClimaLand.Canopy.vcmax_pmodel"><code>ClimaLand.Canopy.vcmax_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vcmax_pmodel(
    ϕ0::FT,
    APAR::FT,
    mprime::FT,
    mc::FT
    βm::FT
) where {FT}</code></pre><p>Computes the maximum rate of carboxylation assuming optimality and Aj = Ac using the intrinsic quantum yield (<code>ϕ0</code>), absorbed photosynthetically active radiation (<code>APAR</code>), Jmax-adjusted capacity (<code>mprime</code>), a Rubisco-limited capacity (<code>mc</code>), and empirical soil moisture stress factor (<code>βm</code>). See Eqns 16 and 6 in Stocker et al. (2020).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1359-L1372">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_LUE" href="#ClimaLand.Canopy.compute_LUE"><code>ClimaLand.Canopy.compute_LUE</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_LUE(
    ϕ0::FT,
    β::FT,
    mprime::FT,
    Mc::FT
) where {FT}</code></pre><p>Computes light use efficiency (LUE) in kg C/mol from intrinsic quantum yield (<code>ϕ0</code>), moisture stress factor (<code>β</code>), and a Jmax modified capacity (<code>mprime</code>); see Eqn 17 and 19 in Stocker et al. (2020). Mc is the molar mass of carbon (kg/mol) = 0.0120107 kg/mol.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1342-L1353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_mj_with_jmax_limitation" href="#ClimaLand.Canopy.compute_mj_with_jmax_limitation"><code>ClimaLand.Canopy.compute_mj_with_jmax_limitation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mj_with_jmax_limitation(
    mj::FT,
    cstar::FT
) where {FT}</code></pre><p>Computes m&#39; such that Aj = ϕ0 APAR * m&#39; (a LUE model) by assuming that dA/dJmax = c is constant. cstar is defined as 4c, a free parameter. Wang etal (2017) derive cstar = 0.412 at STP and using Vcmax/Jmax = 1.88.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1323-L1332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.electron_transport_pmodel" href="#ClimaLand.Canopy.electron_transport_pmodel"><code>ClimaLand.Canopy.electron_transport_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_transport_pmodel(
    ϕ0::FT,
    APAR::FT,
    Jmax::FT
) where {FT}</code></pre><p>Computes the rate of electron transport (<code>J</code>) in mol electrons/m^2/s for the pmodel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1379-L1387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.co2_compensation_pmodel" href="#ClimaLand.Canopy.co2_compensation_pmodel"><code>ClimaLand.Canopy.co2_compensation_pmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">co2_compensation_pmode(
    T::FT,
    To::FT,
    p::FT,
    R::FT,
    ΔHΓstar::FT
    Γstar25::FT
) where {FT}</code></pre><p>Computes the CO2 compensation point (<code>Γstar</code>), in units Pa, as a function of temperature T (K) and pressure p (Pa). See Equation B5 of Stocker et al. (2020).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/pmodel.jl#L1245-L1257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.quadratic_soil_moisture_stress" href="#ClimaLand.Canopy.quadratic_soil_moisture_stress"><code>ClimaLand.Canopy.quadratic_soil_moisture_stress</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">quadratic_soil_moisture_stress(
    θ::FT,
    meanalpha::FT = FT(1.0),
    a_hat::FT = FT(0.0),
    b_hat::FT = FT(0.685),
    θ0::FT = FT(0.0),
    θ1::FT = FT(0.6)
) where {FT}</code></pre><p>Computes an empirical soil moisture stress factor (<code>β</code>) according to the quadratic functional form of Stocker et al. (2020), Eq 21, using the soil moisture (<code>θ</code>), AET/PET (<code>meanalpha</code>), and parameters <code>a_hat</code>, <code>b_hat</code>, <code>θ0</code>, and <code>θ1</code>. Default values are from the original paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/canopy_parameterizations.jl#L120-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_APAR_canopy_moles" href="#ClimaLand.Canopy.compute_APAR_canopy_moles"><code>ClimaLand.Canopy.compute_APAR_canopy_moles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_APAR_canopy_moles(
    f_abs::FT,
    par_d::FT,
    λ_γ_PAR::FT,
    lightspeed::FT,
    planck_h::FT,
    N_a::FT
) where {FT}</code></pre><p>Computes the absorbed photosynthetically active radiation for the canopy in mol photons m^-2 s^-1, given the fraction of absorbed PAR (<code>f_abs</code>), the PAR downwelling flux (<code>par_d</code>, in W m^-2), and the wavelength of PAR (<code>λ_γ_PAR</code>, in m), and the physical constants necessary to compute the energy per mol PAR photons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L148-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaLand.Canopy.compute_APAR_leaf_moles" href="#ClimaLand.Canopy.compute_APAR_leaf_moles"><code>ClimaLand.Canopy.compute_APAR_leaf_moles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_APAR_leaf_moles(
    f_abs::FT,
    par_d::FT,
    λ_γ_PAR::FT,
    lightspeed::FT,
    planck_h::FT,
    N_a::FT,
    LAI::FT
) where {FT}</code></pre><p>Computes the absorbed photosynthetically active radiation for the leaf in mol photons m^-2 s^-1, given the fraction of absorbed PAR (<code>f_abs</code>), the PAR downwelling flux (<code>par_d</code>, in W m^-2), and the wavelength of PAR (<code>λ_γ_PAR</code>, in m), the leaf area index <code>LAI</code>, and the physical constants necessary to compute the energy per mol PAR photons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaLand.jl/blob/504a2daf821d891879fb0449608e5c7ff0954929/src/standalone/Vegetation/photosynthesis.jl#L175-L190">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Biomass/">« Leaf, stem, root dynamics</a><a class="docs-footer-nextpage" href="../RadiativeTransfer/">Radiative Transfer »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 19 September 2025 01:03">Friday 19 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
