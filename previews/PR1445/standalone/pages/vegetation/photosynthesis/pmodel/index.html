<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>P-model · ClimaLand.jl</title><meta name="title" content="P-model · ClimaLand.jl"/><meta property="og:title" content="P-model · ClimaLand.jl"/><meta property="twitter:title" content="P-model · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../../assets/documenter.js"></script><script src="../../../../../search_index.js"></script><script src="../../../../../siteinfo.js"></script><script src="../../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../../"><img src="../../../../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../../../">Home</a></li><li><a class="tocitem" href="../../../../../getting_started/">Running your first simulation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../../../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../../../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../../../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../../../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../../../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../../../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../../../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../../../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../../../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../../../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../../../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../../../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../../../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-2" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../farquhar_model/">Farquhar model</a></li><li class="is-active"><a class="tocitem" href>P-model</a><ul class="internal"><li><a class="tocitem" href="#Usage-in-ClimaLand"><span>Usage in ClimaLand</span></a></li><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Citations"><span>Citations</span></a></li></ul></li><li><a class="tocitem" href="../optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-3" type="checkbox"/><label class="tocitem" for="menuitem-4-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href>P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../plant_hydraulics/van_genuchten_model/">Van Genuchten model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../../soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../model_structure/">Model structure</a></li><li><a class="tocitem" href="../../../../../repo_structure/">Repository structure</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Analyzing model output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-3-1" type="checkbox"/><label class="tocitem" for="menuitem-5-3-1"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../../../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../../../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li><a class="tocitem" href="../../../../../leaderboard/leaderboard/">Leaderboard</a></li></ul></li><li><a class="tocitem" href="../../../../../architectures/">Running on GPU or with MPI</a></li><li><a class="tocitem" href="../../../../../calibration/">Calibration</a></li><li><a class="tocitem" href="../../../../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../itime/">ITime type</a></li><li><a class="tocitem" href="../../../../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../../../../physical_units/">Physical units</a></li><li><a class="tocitem" href="../../../../../julia/">Julia background</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../../../../APIs/SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../../../../../APIs/SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/Photosynthesis/">Canopy Photosynthesis</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/RadiativeTransfer/">Canopy Radiative Transfer</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/CanopyEnergy/">Canopy Energy</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/StomatalConductance/">Canopy Stomatal Conductance</a></li><li><a class="tocitem" href="../../../../../APIs/canopy/AutotrophicRespiration/">Canopy Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../../../../APIs/SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../../../../APIs/Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../../../../APIs/Snow/">Snow Model</a></li><li><a class="tocitem" href="../../../../../APIs/ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../../../../../APIs/Simulations/">Simulations</a></li><li><a class="tocitem" href="../../../../../APIs/Domains/">Domains</a></li><li><a class="tocitem" href="../../../../../APIs/Drivers/">Drivers</a></li><li><a class="tocitem" href="../../../../../APIs/Callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../../../../../APIs/parameters/">Parameters</a></li></ul></li><li><a class="tocitem" href="../../../../../contributing/">Contributor guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Equations</a></li><li><a class="is-disabled">Vegetation</a></li><li><a class="is-disabled">Photosynthesis</a></li><li class="is-active"><a href>P-model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>P-model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/standalone/pages/vegetation/photosynthesis/pmodel.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>The P-model is model for photosynthesis and stomatal conductance that extends the Farquhar model in two main ways: 1) it assumes that all plants adjust their internal CO2 concentration such that carbon assimilation is maximized relative to the combination of two costs—the cost of supporting RuBisCo-limited photosynthesis and the cost of transpiration through stomata; 2) it assumes that RuBisCo-limited and light-limited assimilation rates are equal, i.e., that <span>$A_c = A_j$</span> (coordination hypothesis). These two additional constraints allow for the prediction of photosynthetic parameters such as <span>$V_{c\max}$</span>, <span>$J_{\max}$</span>, and stomatal conductance <span>$g_{s}$</span>. </p><h2 id="Usage-in-ClimaLand"><a class="docs-heading-anchor" href="#Usage-in-ClimaLand">Usage in ClimaLand</a><a id="Usage-in-ClimaLand-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-in-ClimaLand" title="Permalink"></a></h2><p>The P-model differs from other canopy component models in two main ways: </p><ol><li>The P-model encompasses <em>both</em> a photosynthesis model <em>and</em> a stomatal conductance model. Therefore, <code>PModel</code> must be used for photosynthesis iff <code>PModelConductance</code> is used for stomatal conductance. </li><li>The P-model requires an extra callback <code>PModelCallback</code> which checks if it is local noon every model timestep and updates the optimal parameters according to local noon (see Implementation for scientific background). When you are constructing a simulation via <code>LandSimulation</code>, this callback will be constructed and added to your simulation automatically.</li></ol><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><p>The first assumption, which we&#39;ll call the &quot;cost minimization principle&quot;, can be mathematically written as follows. We define a cost which is dependent on the transpiration <span>$E$</span>, maximum rate of Rubisco limited photosynthesis <span>$V_{c\max}$</span>, normalized to the rate of assimilation <span>$A$</span>:</p><p class="math-container">\[\mathrm{Cost} = a \frac{E}{A} + b \frac{V_{c\max}}{A}\]</p><p>Here, <span>$a$</span> and <span>$b$</span> are dimensionless numbers that represent the relative weight of each cost. Minimization of this cost represents the general principle that plants seek to maximize assimilation while keeping water loss low (<span>$E$</span> term) and not overly investing in synthesizing Rubisco protein. The parameter which is adjusted is <span>$\chi = \dfrac{c_{i}}{c_{a}}$</span>, the ratio of internal to ambient (external) CO2 concentration. Thus, the first constraint is mathematically written as</p><p class="math-container">\[a \frac{\partial (E/A)}{\partial \chi} = -b \frac{\partial (V_{cmax} / A)}{ \partial \chi}\]</p><p>The second assumption, called the &quot;coordination hypothesis&quot; (see Chen et al., 1993), states that <span>$V_{c\max}$</span> varies according to APAR such that it is neither in excess or in deficit of what is required for full utilization of the light. Mathematically, this means that <span>$A_{c} = A_{j}$</span>. These two constraints, when added to the Farquhar model, allows for the computation of <span>$V_{c\max}$</span>, <span>$J_{\max}$</span>, and <span>$\xi$</span> (sensitivity parameter to VPD; see Wang 2017) from environmental conditions: </p><p class="math-container">\[\begin{align*}
\xi^\mathrm{opt} &amp;= \sqrt{ \dfrac{\beta(K + \Gamma^*)}{\eta^* D_{H_{2}O}/D_{CO_{2}}} } \\[0.2in]
J_{\max}^\mathrm{opt} &amp;= \dfrac{4\phi_{0} \cdot  \mathrm{APAR}}{\sqrt{ \left[ \beta_{m}^2\left(1 - \left[ c^* \dfrac{c_{i} + 2\Gamma^*}{c_{i} - \Gamma^*} \right]^{2/3} \right) \right]^{-1} - 1 }} \\[0.2in]
V_{c\max}^{\mathrm{opt}} &amp;= \phi_{0} \beta_{m} \cdot \mathrm{APAR} \cdot \dfrac{c_{i} + K}{c_{i} + 2\Gamma^*} \sqrt{ 1 - \left[ c^*  \dfrac{c_{i}+ 2\Gamma^*}{c_{i} - \Gamma^*}\right]^{2/3} }
\end{align*}\]</p><p>We refer the reader to the Farquhar docs page for definitions of the biochemical parameters referenced above.</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>We follow the scheme of Mengoli et al., (2022) who propose updating optimal parameters <span>$V_{c\max 25}$</span>, <span>$J_{\max25}$</span>, and <span>$\xi$</span> according to conditions at local noon (near maximal APAR). These are then timestepped via the forward Euler discretization of the following ODE: </p><p class="math-container">\[\tau \dfrac{ d\bar{x}}{dt} = \bar{x} - x \implies \bar{x}_{t+1} = \alpha \bar{x}_{t} + (1 - \alpha) x_{t+1}\]</p><p>where <span>$\bar{x}$</span> is the acclimated parameter, <span>$x$</span> is the parameter computed at local noon, <span>$\alpha = 1 - \dfrac{\Delta t}{\tau}$</span> and <span>$\tau$</span> is the timescale of acclimation. Since we update this equation every local noon, <span>$\Delta t$</span> is 1 day and <span>$\tau = 15$</span> days corresponds to <span>$\alpha = \dfrac{14}{15} \approx 0.933$</span> (the default timescale used in Mengoli 2022). The optimal variables <span>$\bar{x}$</span> are stored in the model cache in <code>p.canopy.photosynthesis.OptVars</code>.  </p><p>At every model timestep, the latest acclimated values <span>$V_{c\max 25}^{\mathrm{opt}}$</span>, <span>$J_{\max 25}^{\mathrm{opt}}$</span>, are then adjusted via modified-Arrhenius type functions of form </p><p class="math-container">\[V_{c\max} = V_{c\max 25}^{\mathrm{opt}} \cdot \underbrace{ \exp \left( \dfrac{\Delta H_{a}(T - T_{0})}{T_{0} TR} \right) }_{ \text{activation (Arrhenius)} } \cdot \underbrace{ \dfrac{1 + e^{(T_{0}\Delta S - \Delta H_{d})/RT_{0}}}{1 + e^{(T\Delta S - \Delta H_{d})/RT}}  }_{ \text{deactivation} }\]</p><p>where <span>$\Delta H_{a}$</span>, <span>$\Delta H_{d}$</span> are standard enthalpies of activation and deactivation, <span>$T_{0} = 298.15$</span> K is the reference temperature, and <span>$\Delta S$</span> is the entropy change in deactivation. The acclimated <span>$\xi^\mathrm{opt}$</span> is used to compute the instantaneous intercellular CO2 concentration <span>$c_{i}$</span></p><p class="math-container">\[c_{i} =\dfrac{ \xi^\mathrm{opt} c_{a} + \Gamma^* \sqrt{ \max(D,0) }}{\xi^\mathrm{opt} + \sqrt{ \max(D,0) }}\]</p><p>where <span>$D$</span> is the vapor pressure deficit (VPD). Finally, carboxylation- and light-limited assimilation is computed as</p><p class="math-container">\[\begin{align*}
A_{c} &amp;= V_{c\max} \dfrac{c_{i} - \Gamma^*}{c_{i} + K} \\
A_{j} &amp;= \dfrac{1}{4} \underbrace{ \dfrac{4\phi_{0} I_{abs}}{\sqrt{ 1 + \left(\dfrac{4\phi_{0}I_{abs}}{J_{\max}}\right)^2 }} }_{ J } \cdot \dfrac{c_{i} - \Gamma^*}{c_{i} + 2 \Gamma^*}
\end{align*}\]</p><p>The remaining steps for computing <span>$A_{n}$</span> and upscaling to canopy-level GPP are identical to the Farquhar model.</p><p>The P-model also gives a stomatal conductance model because it predicts <span>$\chi = \dfrac{c_{a}}{c_{i}}$</span>. From Fick&#39;s law, we have that </p><p class="math-container">\[g_{s} = \dfrac{D_{H_{2}O}}{D_{CO_{2}}} \dfrac{A_{n}}{c_{a}- c_{i}}\]</p><p>where <span>$\dfrac{D_{H_{2}O}}{D_{CO_{2}}} \approx 1.6$</span> is treated as a constant (<code>Drel</code>) in our model. </p><h2 id="Citations"><a class="docs-heading-anchor" href="#Citations">Citations</a><a id="Citations-1"></a><a class="docs-heading-anchor-permalink" href="#Citations" title="Permalink"></a></h2><p>Chen, J.-L., Reynolds, J. F., Harley, P. C. &amp; Tenhunen, J. D. Coordination theory of leaf nitrogen distribution in a canopy. Oecologia 93, 63–69 (1993)</p><p>Mengoli, G., Agustí-Panareda, A., Boussetta, S., Harrison, S. P., Trotta, C., &amp; Prentice, I. C. (2022). Ecosystem photosynthesis in land-surface models: A first-principles approach incorporating acclimation. <em>Journal of Advances in Modeling Earth Systems</em>, 14, e2021MS002767. <a href="https://doi.org/10.1029/2021MS002767">https://doi.org/10.1029/2021MS002767</a></p><p>Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T., &amp; Prentice, I. C. (2020). P-model v1.0: An optimality-based light use efficiency model for simulating ecosystem gross primary production. <em>Geoscientific Model Development</em>, <em>13</em>(3), 1545–1581. <a href="https://doi.org/10.5194/gmd-13-1545-2020">https://doi.org/10.5194/gmd-13-1545-2020</a></p><p>Wang, H., Prentice, I. C., Keenan, T. F., Davis, T. W., Wright, I. J., Cornwell, W. K., Evans, B. J., &amp; Peng, C. (2017). Towards a universal model for carbon dioxide uptake by plants. Nature Plants, 3(9), 734–741. https://doi.org/10.1038/s41477-017-0006-8</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../farquhar_model/">« Farquhar model</a><a class="docs-footer-nextpage" href="../optimality_model/">Optimality model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 18 September 2025 18:50">Thursday 18 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
