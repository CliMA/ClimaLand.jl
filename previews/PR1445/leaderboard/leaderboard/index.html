<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Leaderboard · ClimaLand.jl</title><meta name="title" content="Leaderboard · ClimaLand.jl"/><meta property="og:title" content="Leaderboard · ClimaLand.jl"/><meta property="twitter:title" content="Leaderboard · ClimaLand.jl"/><meta name="description" content="Documentation for ClimaLand.jl."/><meta property="og:description" content="Documentation for ClimaLand.jl."/><meta property="twitter:description" content="Documentation for ClimaLand.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="ClimaLand.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClimaLand.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Running your first simulation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Running standalone component simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Bucket/bucket_tutorial/">Bucket</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Soil/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/richards_equation/">Richards Equation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/soil_energy_hydrology/">Energy and Hydrology</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2-4"><span class="docs-label">Phase Changes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Soil/freezing_front/">Modeling a freezing front in unsaturated soil</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/phase_change_analytic/">The Stefan problem</a></li></ul></li><li><a class="tocitem" href="../../generated/standalone/Soil/layered_soil/">Layered Soil</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation/">Coarse Sand Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/evaporation_gilat_loess/">Gilat Loess Evaporation</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/sublimation/">Bare soil site</a></li><li><a class="tocitem" href="../../generated/standalone/Soil/changing_soil_parameterizations/">Changing soil parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Canopy/default_canopy/">Default canopy</a></li><li><a class="tocitem" href="../../generated/standalone/Canopy/canopy_tutorial/">Default canopy fluxtower simulation </a></li><li><a class="tocitem" href="../../generated/standalone/Canopy/changing_canopy_parameterizations/">Changing canopy parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Snow/base_tutorial/">Base tutorial</a></li><li><a class="tocitem" href="../../generated/standalone/Snow/data_tutorial/">Data tutorial</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Running Fluxnet simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/integrated/soil_canopy_fluxnet_tutorial/">Canopy and soil</a></li><li><a class="tocitem" href="../../generated/integrated/snowy_land_fluxnet_tutorial/">Canopy, soil, and snow</a></li><li><a class="tocitem" href="../../generated/integrated/changing_snowy_land_parameterizations/">Changing LandModel parameterizations</a></li><li><a class="tocitem" href="../../generated/integrated/fluxnet_data/">Data processing</a></li><li><a class="tocitem" href="../../generated/integrated/fluxnet_vis/">Visualization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Running global simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/global/bucket/">Bucket</a></li><li><a class="tocitem" href="../../generated/global/snowy_land/">Snow, soil, canopy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Calibrating a ClimaLand model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/calibration/perfect_model_site_level_calibration/">Single site perfect model</a></li><li><a class="tocitem" href="../../generated/calibration/obs_site_level_calibration/">Single site observations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Running coupled simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Bucket/coupled_bucket/">Coupled bucket model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">For model developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Usage/model_tutorial/">Intro to standalone models</a></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">Intro to multi-component models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/standalone/Usage/LSM_single_column_tutorial/">Single column tutorial</a></li><li><a class="tocitem" href="../../generated/integrated/handling_soil_fluxes/">Adjusting boundary conditions for the soil</a></li><li><a class="tocitem" href="../../generated/integrated/handling_snow_fluxes/">Adjusting boundary conditions for the snow</a></li></ul></li><li><a class="tocitem" href="../../generated/standalone/Usage/domain_tutorial/">Intro to ClimaLand Domains</a></li><li><a class="tocitem" href="../../generated/shared_utilities/driver_tutorial/">Intro to forced site-level runs</a></li><li><a class="tocitem" href="../../generated/shared_utilities/timestepping/">Intro to implicit/explicit timestepping</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Vegetation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1-1"><span class="docs-label">Radiative transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/beer_model/">Beer model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/radiative_transfer/twostream_model/">Two-Stream model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-2" type="checkbox"/><label class="tocitem" for="menuitem-4-1-2"><span class="docs-label">Photosynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/farquhar_model/">Farquhar model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/optimality_model/">Optimality model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-3" type="checkbox"/><label class="tocitem" for="menuitem-4-1-3"><span class="docs-label">Stomatal conductance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/stomatal_conductance/medlyn_model/">Medlyn model</a></li><li><a class="tocitem" href="../../standalone/pages/vegetation/photosynthesis/pmodel/">P-model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Plant hydraulics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/vegetation/plant_hydraulics/van_genuchten_model/">Van Genuchten model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-2-1" type="checkbox"/><label class="tocitem" for="menuitem-4-2-1"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/physics/richards_model/">Richards model</a></li><li><a class="tocitem" href="../../standalone/pages/soil/physics/energy_model/">Energy+Hydrology model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Biogeochemistry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/soil/biogeochemistry/DAMM_model/">DAMM model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Snow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standalone/pages/snow/snow_model/">Snow model</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Additional resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_structure/">Model structure</a></li><li><a class="tocitem" href="../../repo_structure/">Repository structure</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox" checked/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Analyzing model output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-3-1" type="checkbox"/><label class="tocitem" for="menuitem-5-3-1"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../diagnostics/users_diagnostics/">For users</a></li><li><a class="tocitem" href="../../diagnostics/developers_diagnostics/">For developers</a></li><li><a class="tocitem" href="../../diagnostics/available_diagnostics/">Available diagnostics</a></li></ul></li><li class="is-active"><a class="tocitem" href>Leaderboard</a><ul class="internal"><li><a class="tocitem" href="#Long-run"><span>Long run</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../architectures/">Running on GPU or with MPI</a></li><li><a class="tocitem" href="../../calibration/">Calibration</a></li><li><a class="tocitem" href="../../restarts/">Restarting a simulation</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Software utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../itime/">ITime type</a></li><li><a class="tocitem" href="../../shared_utilities/">Shared utilities</a></li></ul></li><li><a class="tocitem" href="../../physical_units/">Physical units</a></li><li><a class="tocitem" href="../../julia/">Julia background</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/Soil/">Soil Energy and Hydrology</a></li><li><a class="tocitem" href="../../APIs/SoilBiogeochemistry/">Soil Biogeochemistry</a></li><li><a class="tocitem" href="../../APIs/SoilAlbedo/">Soil Albedo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Canopy</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/canopy/Canopy/">Canopy Models</a></li><li><a class="tocitem" href="../../APIs/canopy/PlantHydraulics/">Plant Hydraulics</a></li><li><a class="tocitem" href="../../APIs/canopy/Photosynthesis/">Canopy Photosynthesis</a></li><li><a class="tocitem" href="../../APIs/canopy/RadiativeTransfer/">Canopy Radiative Transfer</a></li><li><a class="tocitem" href="../../APIs/canopy/CanopyEnergy/">Canopy Energy</a></li><li><a class="tocitem" href="../../APIs/canopy/StomatalConductance/">Canopy Stomatal Conductance</a></li><li><a class="tocitem" href="../../APIs/canopy/AutotrophicRespiration/">Canopy Autotrophic Respiration</a></li></ul></li><li><a class="tocitem" href="../../APIs/SurfaceWater/">Surface Water Models</a></li><li><a class="tocitem" href="../../APIs/Bucket/">Bucket Model</a></li><li><a class="tocitem" href="../../APIs/Snow/">Snow Model</a></li><li><a class="tocitem" href="../../APIs/ClimaLand/">Integrated Models</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Shared Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/AbstractModels/">Abstract Models and Functions</a></li><li><a class="tocitem" href="../../APIs/Simulations/">Simulations</a></li><li><a class="tocitem" href="../../APIs/Domains/">Domains</a></li><li><a class="tocitem" href="../../APIs/Drivers/">Drivers</a></li><li><a class="tocitem" href="../../APIs/Callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../../APIs/parameters/">Parameters</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributor guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Additional resources</a></li><li><a class="is-disabled">Analyzing model output</a></li><li class="is-active"><a href>Leaderboard</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Leaderboard</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaLand.jl/blob/main/docs/src/leaderboard/leaderboard.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Leaderboard"><a class="docs-heading-anchor" href="#Leaderboard">Leaderboard</a><a id="Leaderboard-1"></a><a class="docs-heading-anchor-permalink" href="#Leaderboard" title="Permalink"></a></h1><h2 id="Long-run"><a class="docs-heading-anchor" href="#Long-run">Long run</a><a id="Long-run-1"></a><a class="docs-heading-anchor-permalink" href="#Long-run" title="Permalink"></a></h2><h3 id="Add-a-new-variable-to-compare-against-observations"><a class="docs-heading-anchor" href="#Add-a-new-variable-to-compare-against-observations">Add a new variable to compare against observations</a><a id="Add-a-new-variable-to-compare-against-observations-1"></a><a class="docs-heading-anchor-permalink" href="#Add-a-new-variable-to-compare-against-observations" title="Permalink"></a></h3><p>The infrastructure to compute errors against observations is in the <code>leaderboard</code> folder. This folder contains two files: <code>data_sources.jl</code>, responsible for loading and preprocessing variables of interest, and <code>leaderboard.jl</code>, which computes error and draw plots. To add a new variable to the comparison, you modify the <code>data_sources.jl</code>.</p><h3 id="Computation"><a class="docs-heading-anchor" href="#Computation">Computation</a><a id="Computation-1"></a><a class="docs-heading-anchor-permalink" href="#Computation" title="Permalink"></a></h3><p>As of now, the leaderboard produces bias plots with the global bias and global root mean squared error (RMSE). These quantities are computed for each month with the first year of the simulation not considered as that is the spinup time. The start date of the simulation is 2008 which means that only the year 2009 is used to compare against observational data.</p><h3 id="Add-a-new-variable-to-the-bias-plots"><a class="docs-heading-anchor" href="#Add-a-new-variable-to-the-bias-plots">Add a new variable to the bias plots</a><a id="Add-a-new-variable-to-the-bias-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Add-a-new-variable-to-the-bias-plots" title="Permalink"></a></h3><p>There are four functions that you need to modify to add a new variable which are <code>get_sim_var_dict</code>, <code>get_obs_var_dict</code>, <code>get_mask_dict</code>, and <code>get_compare_vars_biases_plot_extrema</code>. Each function returns a dictionary that must be modified to add a new variable to the leaderboard. The dictionaries are <code>sim_var_dict</code>, <code>obs_var_dict</code>, <code>mask_dict</code>, and <code>compare_vars_biases_plot_extrema</code>.</p><p>To add a variable for the leaderboard, add a key-value pair to the dictionary <code>sim_var_dict</code> whose key is the short name of the variable and the value is a function that returns a <a href="https://clima.github.io/ClimaAnalysis.jl/stable/var/"><code>OutputVar</code></a>. Any preprocessing is done in the function which includes unit conversion and shifting the dates.</p><pre><code class="language-julia hljs">sim_var_dict[&quot;et&quot;] =
        () -&gt; begin
            # Load in variable
            sim_var = get(
                ClimaAnalysis.SimDir(diagnostics_folder_path),
                short_name = &quot;et&quot;,
            )
            # Shift to the first day and subtract one month as preprocessing
            sim_var =
                ClimaAnalysis.shift_to_start_of_previous_month(sim_var)
            return sim_var
        end</code></pre><p>Then, add a key-value pair to the dictionary <code>obs_var_dict</code> whose key is the same short name as before and the value is a function that takes in a start date and returns a <code>OutputVar</code>. Any preprocessing is done in the function.</p><pre><code class="language-julia hljs">obs_var_dict[&quot;et&quot;] =
    (start_date) -&gt; begin
    # We use ClimaArtifacts to use a dataset from ILAMB
        obs_var = ClimaAnalysis.OutputVar(
            ClimaLand.Artifacts.ilamb_dataset_path(;
                context = &quot;evspsbl_MODIS_et_0.5x0.5.nc&quot;,
            ),
            &quot;et&quot;,
            # start_date is used to align the dates in the observational data
            # with the simulation data
            new_start_date = start_date,
            # Shift dates to the first day of the month before aligning the dates
            shift_by = Dates.firstdayofmonth,
        )
        # More preprocessing to match the units with the simulation data
        ClimaAnalysis.units(obs_var) == &quot;kg/m2/s&quot; &amp;&amp;
            (obs_var = ClimaAnalysis.set_units(obs_var, &quot;kg m^-2 s^-1&quot;))
        # ClimaAnalysis cannot handle `missing` values, but does support handling NaNs
        obs_var = ClimaAnalysis.replace(obs_var, missing =&gt; NaN)
        return obs_var
    end</code></pre><div class="admonition is-success" id="Preprocessing-bbf736d789fb2876"><header class="admonition-header">Preprocessing<a class="admonition-anchor" href="#Preprocessing-bbf736d789fb2876" title="Permalink"></a></header><div class="admonition-body"><p>Observational and simulational data should be preprocessed for dates and units. When using ClimaDiagnostics to report monthly averages from a simulation, monthly averages are output on the first day following the month when the average was computed. For instance, the monthly average corresponding to January 2010 is on the date 1 Feb 2010. Preprocessing is done to shift this date to 1 Jan 2010. When preprocessing data, we follow the convention that the first day corresponds to the monthly average for that month. For observational data, you should check the convention being followed and preprocess the dates if necessary.</p><p>For <code>obs_var_dict</code>, the anonymous function must take in a start date. The start date is used in <code>leaderboard.jl</code> to adjust the seconds in the <code>OutputVar</code> to match between start date in the simulation data.</p><p>Units should be the same between the simulation and observational data.</p></div></div><p>Next, add a key-value pair to the dictionary <code>mask_dict</code> whose key is the same short name as before and the value is a function that takes in a <code>OutputVar</code> representing simulation data and a <code>OutputVar</code> representing observational data and returns a masking function or <code>nothing</code> if no masking function is needed. The masking function is used to correctly normalize the global bias and global RMSE. See the example below where a mask is made using the observational data.</p><pre><code class="language-julia hljs">mask_dict[&quot;et&quot;] =
    (sim_var, obs_var) -&gt; begin
        return ClimaAnalysis.make_lonlat_mask(
            # We do this to get a `OutputVar` with only two dimensions:
            # longitude and latitude
            ClimaAnalysis.slice(
                obs_var,
                time = ClimaAnalysis.times(obs_var) |&gt; first,
            );
            # Any values that are NaN should be 0.0
            set_to_val = isnan,
            true_val = 0.0
        )
    end</code></pre><p>Finally, add a key-value pair to the dictionary <code>compare_vars_biases_plot_extrema</code> whose key is the same short name as before and the value is a tuple of floats which determine the range of the bias plots.</p><pre><code class="language-julia hljs">compare_vars_biases_plot_extrema = Dict(
    &quot;et&quot; =&gt; (-0.00001, 0.00001),
    &quot;gpp&quot; =&gt; (-8.0, 8.0),
    &quot;lwu&quot; =&gt; (-40.0, 40.0),
)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../diagnostics/available_diagnostics/">« Available diagnostics</a><a class="docs-footer-nextpage" href="../../architectures/">Running on GPU or with MPI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 18 September 2025 18:50">Thursday 18 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
